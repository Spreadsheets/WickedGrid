var jQuery=window.jQuery||{};var Sheet=(function(d,m,f,a,q,t,v,g,b,r){var l={defaultTheme:0,themeRollerTheme:0,bootstrapTheme:1,customTheme:2,excelSelectModel:0,googleDriveSelectModel:1,openOfficeSelectModel:2,defaultColumnWidth:120,defaultRowHeight:20,calcStack:0};l.Cell=(function(){var w=undefined;function x(y,B,A,z){if(x.cellLoading===null){x.cellLoading=A.msg.cellLoading}if(B!==undefined&&B!==null){this.td=B;B.jSCell=this}else{this.td=null}this.dependencies=[];this.formula="";this.cellType=null;this.value="";this.valueOverride=null;this.calcCount=0;this.sheetIndex=y;this.rowIndex=null;this.columnIndex=null;this.jS=(A!==undefined?A:null);this.state=[];this.needsUpdated=true;this.uneditable=false;this.id=null;this.loader=null;this.loadedFrom=null;this.cellHandler=z;this.waitingCallbacks=[];this.parsedFormula=null;this.defer=null}x.prototype={addDependency:function(y){if(y===undefined||y===null){return}if(y.type!==l.Cell){throw new Exception("Wrong Type")}if(this.dependencies.indexOf(y)<0&&this!==y){this.dependencies.push(y);if(this.loader!==null){this.loader.addDependency(this,y)}}},updateValue:function(C){if(!this.needsUpdated&&this.value.cell!==w&&this.defer===null){var H=(this.valueOverride!==null?this.valueOverride:this.value);this.displayValue();if(C!==w){C.call(this,H)}if(this.waitingCallbacks.length>0){while(this.waitingCallbacks.length>0){this.waitingCallbacks.pop().call(this,H)}}return}if(this.formula.length<1&&this.cellType===null&&this.defer===null){if(this.value!==undefined&&((this.value+"").length<1||!this.hasOperator.test(this.value))){if(this.td!==null){this.td.innerHTML=this.encode(this.value)}this.value=new q(this.value);this.value.cell=this;this.updateDependencies();this.needsUpdated=false;if(C!==w){C.call(this,this.value)}if(this.waitingCallbacks.length>0){while(this.waitingCallbacks.length>0){this.waitingCallbacks.pop().call(this,this.value)}}return}}var O,A=this,I,E,L=this.value,z=this.formula,M=this.cellType,y,B=this.defer,F=this.td,N,J,D,P,K=function(Q){A.parsedFormula=Q;A.resolveFormula(Q,function(R){if(R!==w&&R!==null){if(R.cell!==w&&R.cell!==A){R=R.valueOf()}l.calcStack--;if(M!==null&&(y=l.CellTypeHandlers[M])!==w){R=y(A,R)}G.call(A,R)}else{G.call(A,null)}})},G=function(Q){if(Q===w||Q===null){Q=new q()}if(Q.cell===w){switch(typeof(Q)){case"object":break;case"undefined":Q=new q();break;case"number":Q=new t(Q);break;case"boolean":Q=new v(Q);break;case"string":default:Q=new q(Q);break}Q.cell=A}A.value=Q;I=A.displayValue().valueOf();A.state.shift();if(A.loader!==null){A.loader.setCellAttributes(A.loadedFrom,{cache:(typeof I!=="object"?I:null),formula:A.formula,parsedFormula:A.parsedFormula,value:A.value+"",cellType:A.cellType,uneditable:A.uneditable}).setDependencies(A)}A.needsUpdated=false;P=A.valueOverride!==null?A.valueOverride:A.value;if(C!==w){C.call(A,P)}if(A.waitingCallbacks.length>0){while(A.waitingCallbacks.length>0){A.waitingCallbacks.pop().call(A,P)}}A.updateDependencies()};if(this.state.length>0){if(C!==w){this.waitingCallbacks.push(C)}return}if(B!==null){B.updateValue(function(Q){Q=Q.valueOf();switch(typeof(Q)){case"object":break;case"undefined":Q=new q();break;case"number":Q=new t(Q);break;case"boolean":Q=new v(Q);break;case"string":default:Q=new q(Q);break}Q.cell=this;this.updateDependencies();this.needsUpdated=false;if(C!==w){C.call(A,Q)}if(A.waitingCallbacks.length>0){while(A.waitingCallbacks.length>0){A.waitingCallbacks.pop().call(A,Q)}}});return}this.oldValue=L;this.state.unshift("updating");this.fnCount=0;this.valueOverride=null;this.calcCount++;if(z.length>0){if(z.charAt(0)==="="){A.formula=z=z.substring(1)}if(A.td!==null){A.td.innerHTML=x.cellLoading}l.calcStack++;if(this.parsedFormula!==null){K(this.parsedFormula)}else{A.parseFormula({formula:z,callback:K})}}else{if(L!==w&&L!==null&&M!==null&&(y=l.CellTypeHandlers[M])!==w){L=y(A,L);G(L)}else{switch(typeof L.valueOf()){case"string":O=A.startOperators[L.charAt(0)];if(O!==w){A.valueOverride=O.call(A,L)}else{O=A.endOperators[L.charAt(L.length-1)];if(O!==w){A.valueOverride=O.call(A,L)}}break;case"undefined":L="";break}G(L)}}},updateDependencies:function(){var A,y,z;A=this.dependencies;this.dependencies=[];z=A.length-1;if(z>-1){this.state.unshift("updatingDependencies");do{y=A[z];y.updateValue()}while(z-->0);this.state.shift()}if(this.dependencies.length===0){this.dependencies=A}},displayValue:function(){var z=this.value,B=this.td,A=typeof z,y=z.html;if(y===w){if(A==="string"||(z!==null&&A==="object"&&z.toUpperCase!==w)&&z.length>0){y=this.encode(z)}else{y=z}}if(B===w||B===null){return y}switch(typeof y){case"object":if(y===null){B.innerHTML=""}else{if(y.appendChild!==w){if(y.parentNode===null){B.innerHTML="";B.appendChild(y)}return""}}case"string":default:B.innerHTML=y}return B.innerHTML},resolveFormula:function(J,H){if(typeof J==="string"){H(J)}var G=this,C=[],A=0,D=J.length,B,I=this.cellHandler,F=[],E=function(L,N){var O=[],K,M=N.length-1;if(M<0){return}do{K=N[M];switch(typeof K){case"number":O[M]=F[K];break;case"string":O[M]=K;break;case"object":if(K instanceof Array){O[M]=z(K);break}default:O[M]=K}}while(M-->0);O.unshift(L);return O},z=function(M){var N=[],L=M.length-1,K;if(L<0){return}do{K=M[L];switch(typeof K){case"number":N[L]=F[K];break;case"string":N[L]=K;break;case"object":if(K.hasOwnProperty("args")){N[L]=K;N[L].a=z(K.a);break}else{if(K instanceof Array){N[L]=z(K);break}}default:N[L]=K}}while(L-->0);return N},y;if(G.jS.s.useStack){y=function(N){var M=x.thawIndex,O=x.thaws,L,K=(typeof O[M]==="undefined");if(K){L=x.thaws[M]=new Thaw([])}else{L=O[M]}x.thawIndex++;if(x.thawIndex>x.thawLimit){x.thawIndex=0}L.add(function(){if(C.length>0){C.shift()()}else{H(G.value=(N!==w?N:null))}})}}else{y=function(K){if(C.length>0){C.shift()()}else{H(G.value=(K!==w?K:null))}}}for(;A<D;A++){B=J[A];switch(B.t){case"m":(function(K,L){C.push(function(){y(F[L]=I[K.m].apply(I,E(G,K.a)))})})(B,A);break;case"l":(function(K,L){C.push(function(){var M=E(G,K.a);M.push(function(N){y(F[L]=N)});I[K.m].apply(I,M)})})(B,A);break;case"v":(function(K,L){C.push(function(){y(F[L]=K.v)})})(B,A);break;case"cell":(function(K,L){C.push(function(){F[L]=K;y()})})(B,A);break;case w:F[A]=B;break;default:F[A]=null;throw new r("Not implemented:"+B.t);break}}y()},recurseDependencies:function(B,D){if(D>x.maxRecursion){this.recurseDependenciesFlat(B);return this}var A=0,C=this.dependencies,z,y=C.length;if(D===undefined){D=0}for(;A<y;A++){z=C[A];B.call(z);z.recurseDependencies(B,D)}return this},recurseDependenciesFlat:function(C){var D=this.dependencies,A=D.length-1,z,y,B=[];if(A<0){return}do{B.push(D[A])}while(A-->0);do{z=B[B.length-1];B.length--;C.call(z);y=z.dependencies;A=y.length-1;if(A>-1){do{B.push(y[A])}while(A-->0)}}while(B.length>0)},getAllDependencies:function(){var y=[];this.recurseDependencies(function(){y.push(this)});return y},setNeedsUpdated:function(y){if(y!==w){this.needsUpdated=y}else{this.needsUpdated=true}this.recurseDependencies(function(){this.needsUpdated=true})},encode:function(y){switch(typeof y){case"object":if(y.getMonth!==w){return globalize.format(y,"d")}return y}if(!y){return y||""}if(!y.replace){return y||""}return y.replace(/&/gi,"&amp;").replace(/>/gi,"&gt;").replace(/</gi,"&lt;").replace(/\t/g,"&nbsp;&nbsp;&nbsp ").replace(/  /g,"&nbsp; ")},addClass:function(y){var C=this.td,A,z,B=this.loadedFrom;if(C!==w){if(C.classList){C.classList.add(y)}else{C.className+=" "+y}}if(B!==w){A=(this.loader.getCellAttribute(B,"class")||"");z=A.split(" ").indexOf(y);if(z<0){A+=" "+y;this.loader.setCellAttribute(B,"class",A)}}return this},removeClass:function(y){var C=this.td,A,z,B=this.loadedFrom;if(C!==w){if(C.classList){C.classList.remove(y)}else{A=(C.className+"").split(" ");z=A.indexOf(y);if(z>-1){A.splice(z,1);C.className=A.join(" ")}}}if(B!==w){A=(this.loader.getCellAttribute(B,"class")||"").split(" ");z=A.indexOf(y);if(z>-1){A.splice(z,1);this.loader.setCellAttribute(B,"class",A.join(" "))}}return this},hasOperator:/(^[$£])|([%]$)/,startOperators:{"$":function(z,y){return this.cellHandler.fn.DOLLAR.call(this,z.substring(1).replace(Globalize.culture().numberFormat[","],""),2,y||"$")},"£":function(y){return this.startOperators["$"].call(this,y,"£")}},endOperators:{"%":function(y){return y.substring(0,this.value.length-1)/100}},type:x,typeName:"Sheet.Cell",parseFormula:function(C){if(!this.jS.s.useMultiThreads){C.callback(this.cellHandler.formulaParser(l.calcStack).parse(C.formula));return}var A=x.threadIndex,B=x.threads,y,z=(typeof B[A]==="undefined");if(z){y=x.threads[A]=operative(function(D){if(typeof D==="string"){return parser.Formula().parse(D)}return null},[x.formulaParserUrl]);y.busy=false;y.stash=[]}else{y=B[A]}x.threadIndex++;if(x.threadIndex>x.threadLimit){x.threadIndex=0}if(y.busy){y.stash.push(function(){y.busy=true;y(C.formula,function(D){y.busy=false;C.callback(D);if(y.stash.length>0){y.stash.shift()()}})})}else{y.busy=true;y(C.formula,function(D){y.busy=false;C.callback(D);if(y.stash.length>0){y.stash.shift()()}})}}};x.threads=[];x.threadLimit=10;x.threadIndex=0;x.thaws=[];x.thawLimit=500;x.thawIndex=0;x.cellLoading=null;x.formulaParserUrl="../parser/formula/formula.js";x.maxRecursion=10;return x})();l.CellHandler=(function(x){function A(B){return !isNaN(B)}var w=undefined,y=NaN;function z(D,B,C){this.jS=D;this.jSE=B;this.fn=C;this.spareFormulaParsers={}}z.prototype={variable:function(H,F){if(arguments.length){var E=F[0],C=F[1],G=this.jS.s.formulaVariables,D,B;switch(E.toLowerCase()){case"true":B=new v(true);B.html="TRUE";B.cell=H;return B;case"false":B=new v(false);B.html="FALSE";B.cell=H;return B}if(D=G[E]&&!C){return D}else{if(D&&C){return D[C]}else{return""}}}},time:function(B,D,C){return j.fromString(D,C)},number:function(C,B){if(isNaN(B)||B===null){B=0}switch(typeof B){case"number":return B;case"string":if(A(B)){return B*1}case"object":if(B.getMonth){return e.toCentury(B)}}return B},invertNumber:function(E,D){if(isNaN(D)){D=0}var C=this.number(E,D),B=new t(C.valueOf()*-1);if(C.html){B.html=C.html}return B},performMath:function(B,I,H,G){if(H===w||H===null){H=0}if(G===w||G===null){G=0}var F,E,J=true,C=true,L=[],K,D=function(M){return M};if(H.hasOwnProperty("cell")){H.cell.addDependency(B)}if(G.hasOwnProperty("cell")){G.cell.addDependency(B)}switch(F=(typeof H.valueOf())){case"number":break;case"string":if(A(H)){H*=1}else{J=false}break;case"object":if(H.getMonth){H=e.toCentury(H);D=e.get}else{J=false}break;default:J=false}switch(E=(typeof G.valueOf())){case"number":break;case"string":if(A(G)){G*=1}else{C=false}break;case"object":if(G.getMonth){G=e.toCentury(G)}else{C=false}break;default:C=false}if(!J&&I!=="+"){L.push("not a number: "+H);H=0}if(!C){L.push("not a number: "+G);G=0}if(L.length){}switch(I){case"+":K=H+G;break;case"-":K=H-G;break;case"/":K=H/G;if(K==Infinity||K==y){K=0}break;case"*":K=H*G;break;case"^":K=x.pow(H,G);break}return D(K)},not:function(E,D,C){var B;if(D.valueOf()!=C.valueOf()){B=new v(true);B.html="TRUE";B.cell=E}else{B=new v(false);B.html="FALSE";B.cell=E}return B},concatenate:function(D,C,B){if(C===null){C=""}if(B===null){B=""}return C.toString()+B.toString()},cellValue:function(D,C,H){var F=this.jS,G=h.parseLocation(C.c,C.r),B,E;B=F.getCell(D.sheetIndex,G.row,G.col);if(B!==null){B.addDependency(D);B.updateValue(H)}else{if(H!==w){H.call(D,0)}}return this},cellRangeValue:function(C,E,B,D){return this.remoteCellRangeValue(C,C.sheetIndex,E,B,D)},remoteCellValue:function(B,G,D,I){var C=this.jSE,E=this.jS,F=C.parseLocation(D.c,D.r),J=C.parseSheetLocation(G),H;if(J<0){J=E.getSpreadsheetIndexByTitle(G)}H=E.getCell(J,F.row,F.col);if(H!==null){H.addDependency(B);H.updateValue(I)}else{if(I!==w){I.call(B,0)}}return this},remoteCellRangeValue:function(Z,F,G,C,H){var I=(typeof F==="string"?h.parseSheetLocation(F):F),aa=h.parseLocation(G.c,G.r),O=h.parseLocation(C.c,C.r),Q=x.max(aa.row,O.row),E=x.min(aa.row,O.row),Y=x.max(aa.col,O.col),D=x.min(aa.col,O.col),M=this.jS,R=[],T,B,L,K=[],ab=I+"!"+G.c+G.r+":"+C.c+C.r,N=z.cellRangeCache[ab],X,W,V,P=this,S=((D-1)-Y)*((E-1)-Q),U=S+0,J=0;if(I<0){I=M.getSpreadsheetIndexByTitle(F)}if(I<0){R=new q("");R.html="#NAME?";H.call(Z,R);return this}if(F===w){M.spreadsheets[I]=F={}}if(Q>=E||Y>=D){R.rowCount=(E-Q)+1;R.columnCount=(D-Y)+1;do{T=Y;L=(F[Q]!==w?F[Q]:null);do{if(L===null||(B=L[T])===w){B=M.getCell(I,Q,T)}else{B.sheetIndex=I;B.rowIndex=Q;B.columnIndex=T}if(B!==null){B.addDependency(Z);B.updateValue(function(ac){R.unshift(ac);S--;if(S<1){z.cellRangeCache[ab]=R;H.call(Z,R)}});J++}}while(T-->D)}while(Q-->E)}return this},callFunction:function(E,D,C){D=D.toUpperCase();C=C||[];var F=this.fn[D],B;if(F!==w){E.fnCount++;B=F.apply(E,C)}else{B=new q();B.html="Function "+D+" Not Found"}return B},formulaParser:function(C){var B;if(C>-1){B=this.spareFormulaParsers[C];if(B===w){B=this.spareFormulaParsers[C]=Formula(this)}}else{B=this.jS.formulaParser}return B}};z.cellRangeCache={};return z})(g);l.CellTypeHandlers=(function(){var x=isNaN,w={percent:function(z,B){if(B!==B){return 0}var A=(x(B)?Globalize.parseFloat(B):B*1),y;if(!x(A)){y=new t(A);y.html=Globalize.format(A,"p");return y}return B},date:function(y,A){if(A!==A){return 0}var z=Globalize.parseDate(A);if(z===null){return A}else{y.valueOverride=z;y.html=Globalize.format(z,"d");return A}},time:function(y,A){if(A!==A){return 0}var z=Globalize.parseDate(A);if(z===null){return A}else{z.html=Globalize.format(z,"t");return z}},currency:function(z,B){if(B!==B){return 0}var A=(x(B)?Globalize.parseFloat(B):B*1),y;if(!x(A)){y=new t(A);y.html=Globalize.format(A,"c");return y}return B},number:function(z,B){if(B!==B){return 0}var A,y;if(!w.endOfNumber){A=Globalize.culture().numberFormat["."];w.endOfNumber=new b("(["+(A=="."?".":A)+"])([0-9]*?[1-9]+)?(0)*$")}if(!x(B)){y=new t(B);y.html=Globalize.format(B+"","n10").replace(w.endOfNumber,function(E,D,C){return(C?D:"")+(C||"")});return y}return B}};return w})();l.CellRange=(function(){function w(x){this.cells=x||[]}w.prototype={clone:function(){var B=[],z=this.cells,y=z.length,x,C;for(var A=0;A<y;A++){x=z[A];C={value:x.value,formula:x.formula,td:x.td,dependencies:x.dependencies,needsUpdated:x.needsUpdated,calcCount:x.calcCount,sheetIndex:x.sheetIndex,rowIndex:x.rowIndex,columnIndex:x.columnIndex,html:x.html,state:x.state,jS:x.jS,style:x.style,cl:x.cl,id:x.id,cellType:x.cellType,type:x.type,uneditable:x.uneditable};B.push(C)}return new w(B)},type:w,typeName:"Sheet.CellRange"};return w})();l.ActionUI=(function(w,z,x,y,A){var B=function(G,N,L,M,J){this.enclosure=G;this.pane=w.createElement("div");this.table=N;this.max=J;this.xIndex=0;this.yIndex=0;this.scrollAxisX={};this.scrollAxisY={};this.scrollSize={};this.hiddenColumns=[];if(!(this.frozenAt=M)){this.frozenAt={row:0,col:0}}this.frozenAt.row=x.max(this.frozenAt.row,0);this.frozenAt.col=x.max(this.frozenAt.col,0);this.scrolledArea={row:x.max(this.frozenAt.row,1),col:x.max(this.frozenAt.col,1)};this.foldArea={row:0,col:0};var H=this,D=this.pane,K=this.tBody=N.tBody,I="#"+N.getAttribute("id"),E=this.scrollUI=D.scrollOuter=w.createElement("div"),F=D.scrollInner=w.createElement("div"),C=this.scrollAxisX.scrollStyle=D.scrollStyleX=this.scrollStyleX=new l.StyleUpdater(function(P,Q){if(H.xIndex===P){return false}if(P===undefined||P===null){P=H.xIndex}var S=P+H.maximumVisibleColumns,T=c.ofSet(H.hiddenColumns,P),R=c.ofSet(H.hiddenColumns,S);if(T!==null){P=T.end+(P-T.start)}if(R!==null){S=R.end+(S-R.start)}H.xIndex=P;if(Q===undefined){var O=H.frozenAt.col;Q=I+" tr > *:nth-child(-n+"+P+") {display: none;}"+I+" col:nth-child(-n+"+P+") {display: none;}"+I+" tr > *:nth-child(-n+"+(O+1)+") {display: table-cell;}"+I+" col:nth-child(-n+"+(O+1)+") {display: table-column;}"+I+" tr > *:nth-child("+(S)+") ~ * {display: none;}"+I+" col:nth-child("+(S)+") ~ col {display: none;}"}this.setStyle(Q);H.scrolledArea.col=x.max(P||1,1);H.foldArea.col=S;return true},J);this.yDetacher=new l.Detacher(K);E.setAttribute("class",L);E.appendChild(F);A(E).disableSelectionSpecial();E.addEventListener("scroll",function(){var O=E.scrollTop+E.clientHeight;if(O>=(F.clientHeight-(E.clientHeight/2))){F.style.height=(F.clientHeight+(E.clientHeight*2))+"px"}O=E.scrollLeft+E.clientWidth;if(O>=(F.clientWidth-(E.clientWidth/2))){F.style.width=(F.clientWidth+(E.clientWidth*2))+"px"}});D.appendChild(C.styleElement);new MouseWheel(D,E)};B.prototype={putTdInView:function(H){var D=0,C=0,G=0,F,E;this.xIndex=0;this.yIndex=0;while((F=this.directionToSeeTd(H))!==null){E=this.scrolledArea;if(F.left){C--;this.scrollTo("x",0,E.col-1)}else{if(F.right){C++;this.scrollTo("x",0,E.col+1)}}if(F.up){G--;this.scrollTo("y",0,E.row-1)}else{if(F.down){G++;this.scrollTo("y",0,E.row+1)}}D++;if(D<25){break}}},directionToSeeTd:function(D){var C=this.pane,M={top:0,bottom:C.clientHeight,left:0,right:C.clientWidth},I=D.clientWidth,G=D.clientHeight,K={top:D.offsetTop,bottom:D.offsetTop+G,left:D.offsetLeft,right:D.offsetLeft+I},E=D.parentNode,J=this.scrolledArea;if(!D.col){return null}var L=D.barTop.cellIndex<J.col,F=E.rowIndex<J.row,H={up:F,down:K.bottom>M.bottom&&G<=C.clientHeight,left:L,right:K.right>M.right&&I<=C.clientWidth};if(H.up||H.down||H.left||H.right){return H}return null},redraw:function(){var C=this.pane.style;C.opacity=0.9999;setTimeout(function(){C.opacity=1},0)},hide:function(E,D){var G="#"+this.table.getAttribute("id"),F=this.pane,C=this;if(this.toggleHideStyleX===null){this.toggleHideStyleX=new l.StyleUpdater(function(){var H=this.nthCss("col",G,C.hiddenColumns,0)+this.nthCss("> td",G+" tr",C.hiddenColumns,0)+this.nthCss("> th",G+" tr",C.hiddenColumns,0);this.setStyle(H)})}F.appendChild(this.toggleHideStyleX.styleElement);this.hiddenColumns=(D!==null?D:[]);if(E!==null&&E.length>0){E.sort();this.toggleHideRowRange(E[0],E[E.length-1],true)}if(this.hiddenColumns.length>0){this.hiddenColumns.sort();this.toggleHideStyleX.update()}},toggleHideRow:function(J){var D,K=this.tBody,I=this.yDetacher,E=I.hidden,L=I.hidden[J],F=I.detachedAbove,G=I.detachedBelow,C=F.length,H=C+K.length;if(L===undefined){if(J<C){E[J]=F[J]}else{if(J>H){E[J]=G[J-H]}else{D=J-C;if(D>=K.children.length){E[J]=null}else{K.removeChild(E[J]=K.children[D])}}}}else{delete E[J]}},toggleHideRowRange:function(O,I,J){return;if(!O){return}if(!I){I=O}var D,N=this.tBody,M=O,L=this.yDetacher,E=L.hidden,F=L.detachedAbove,H=L.detachedBelow,G=((J===true)||(E[O]===u)),C=F.length-1,K=C+N.length;for(;M<I;M++){if(G){if(M<C){E[M]=F[M]}else{if(M>K){E[M]=H[M-K]}else{D=M-C;if(D>=N.children.length){E[M]=null}else{N.removeChild(E[M]=N.children[D])}}}}}},rowShowAll:function(){this.toggleHideStyleY.setStyle("");this.hiddenRows={}},toggleHideColumn:function(C){var D;if((D=this.hiddenColumns.indexOf(C))>-1){this.hiddenColumns.splice(D,1)}else{this.hiddenColumns.push(C)}this.hiddenColumns.sort();this.toggleHideStyleX.update()},toggleHideColumnRange:function(J,I){if(!J){return}if(!I){I=J}var H=this.hiddenColumns,F=[],E=H.length,D,G=0,C=null;for(;G<E;G++){D=H[G];if(D>=J&&D<=I){if(C===null){C=true}}else{F.push(D)}}if(C===null){for(G=J;G<=I;G++){F.push(G)}}F.sort();this.hiddenColumns=F;this.toggleHideStyleX.update()},columnShowAll:function(){this.toggleHideStyleX.setStyle("");this.hiddenColumns=[]},remove:function(){},scrollToPixelX:function(D){var F=this.scrollAxisX,C,E,G=(D/this.pixelScrollDensity)>>1,H=c.indexOfNearestLessThan(this.hiddenColumns,G)+1;if(H>0){G+=H}C=F.max;F.value=G;E=G>C?C:G;return F.scrollStyle.update(E)},scrollToPixelY:function(D,F){var E=(D/this.pixelScrollDensity)>>1,C=this.yDetacher;this.yIndex=E;this.scrolledArea.row=x.max(E||1,1);if(F===true){C.attachAboveAfter(E).detachBelowAfter(E+this.maximumVisibleRows+1)}else{C.detachAboveBefore(E).attachBelowBefore(E+this.maximumVisibleRows+1)}return C.aboveChanged||C.belowChanged},scrollToCell:function(C,D){throw new r("Not yet implemented")},toggleHideStyleX:null,toggleHideStyleY:null,pixelScrollDensity:30,maximumVisibleRows:65,maximumVisibleColumns:20};return B})(m,f,g,t,d);l.SpreadsheetUI=(function(){var w=[];function x(z,B,A,y){y=y||{};this.i=z;this.ui=B;this.table=A;this.isLast=y.lastIndex===z;this.enclosure=null;this.pane=null;this.spreadsheet=null;this.sizeCheck=y.sizeCheck||function(){};this.initChildren=y.initChildren||function(){};this.done=y.done||function(){};this.sizeCheck(this)}x.prototype={load:function(){var y=this.table;this.initChildren(this.ui,y,this.i);y.pane.ui=this.ui;this.enclosure=y.enclosure;this.pane=y.pane;this.spreadsheet=y.spreadsheet;w.push(this.i);if(this.isLast){this.loaded()}},loaded:function(){this.done(w,this)}};return x})();l.Theme=(function(w){function x(y){y=y||l.defaultTheme;switch(y){case l.customTheme:this.cl=x.customClasses;break;case l.bootstrapTheme:this.cl=x.bootstrapClasses;break;default:case l.themeRollerTheme:this.cl=x.themeRollerClasses;break}w.extend(this,this.cl)}x.themeRollerClasses={autoFiller:"ui-state-active",bar:"ui-widget-header",barHighlight:"ui-state-active",barHandleFreezeLeft:"ui-state-default",barHandleFreezeTop:"ui-state-default",barMenuTop:"ui-state-default",tdActive:"ui-state-active",tdHighlighted:"ui-state-highlight",control:"ui-widget-header ui-corner-top",controlTextBox:"ui-widget-content",fullScreen:"ui-widget-content ui-corner-all",inPlaceEdit:"ui-state-highlight",menu:"ui-widget-header",menuFixed:"",menuUl:"ui-widget-header",menuLi:"ui-widget-header",menuHover:"ui-state-highlight",pane:"ui-widget-content",parent:"ui-widget-content ui-corner-all",table:"ui-widget-content",tab:"ui-widget-header",tabActive:"ui-state-highlight",barResizer:"ui-state-highlight",barFreezer:"ui-state-highlight",barFreezeIndicator:"ui-state-highlight"};x.bootstrapClasses={autoFiller:"btn-info",bar:"bg-primary",barHighlight:"label-info",barHandleFreezeLeft:"bg-warning",barHandleFreezeTop:"bg-warning",barMenuTop:"bg-warning",tdActive:"active",tdHighlighted:"bg-info",control:"bg-primary",controlTextBox:"form-control",fullScreen:"",inPlaceEdit:"form-control",menu:"panel panel-default",menuFixed:"nav navbar-nav",menuUl:"panel-info",menuLi:"active",menuHover:"bg-primary active",pane:"well",parent:"panel panel-default",table:"table table-bordered table-condensed",tab:"btn-default btn-xs",tabActive:"active",barResizer:"bg-info",barFreezer:"bg-warning",barFreezeIndicator:"bg-warning"};x.customClasses={autoFiller:"",bar:"",barHighlight:"",barHandleFreezeLeft:"",barHandleFreezeTop:"",barMenuTop:"",tdActive:"",tdHighlighted:"",control:"",controlTextBox:"",fullScreen:"",inPlaceEdit:"",menu:"",menuFixed:"",menuUl:"",menuLi:"",menuHover:"",pane:"",parent:"",table:"",tab:"",tabActive:"",barResizer:"",barFreezer:"",barFreezeIndicator:""};return x})(jQuery);l.Highlighter=(function(w,x,y){var z=function(B,D,A,C){this.cssClass=B;this.cssClassBars=D;this.cssClassTabs=A;this.callBack=C||function(){};this.last=y([]);this.lastTop=y([]);this.lastLeft=y([]);this.lastTab=y([]);this.start={row:0,col:0};this.end={row:0,col:0}};z.prototype={set:function(C){if(C.parentNode!==undefined){C=[C]}var A,B=this.last;if(B&&B.length>0){A=B.length-1;do{B[A].isHighlighted=false}while(A-->0)}if(C.length>0){A=C.length-1;do{if(!C[A].isHighlighted){C[A].isHighlighted=true;if(!C[A].className.match(this.cssClass)){C[A].className+=" "+this.cssClass}}}while(A-->0)}this.clear(B);this.last=C;this.callBack();return this},is:function(){return this.last.length>0},clear:function(B){if(this.is()){B=B||this.last;if(B&&B.length){var A=B.length-1;do{if(!B[A].isHighlighted){B[A].className=B[A].className.replace(this.cssClass,"");B[A].isHighlighted=false}}while(A-->0)}}this.last=y([]);return this},setBar:function(A,B){switch(A){case"top":this.lastTop.removeClass(this.cssClassBars);this.lastTop=y(B).addClass(this.cssClassBars);break;case"left":this.lastLeft.removeClass(this.cssClassBars);this.lastLeft=y(B).addClass(this.cssClassBars);break}return this},clearBar:function(){this.lastTop.removeClass(this.cssClassBars);this.lastTop=y([]);this.lastLeft.removeClass(this.cssClassBars);this.lastLeft=y([]);return this},setTab:function(A){this.clearTab();this.lastTab=A.addClass(this.cssClassTabs);return this},clearTab:function(){this.lastTab.removeClass(this.cssClassTabs);return this},setStart:function(A){this.start=A;return this},setEnd:function(A){this.end=A;return this}};return z})(m,f,jQuery);l.ColumnAdder=(function(){function w(){this.qty=-1;this.addedFinishedFn=null;this.createBarFn=null;this.createCellFn=null}w.prototype={setQty:function(z,y){var x=d.sheet.max;if(x){if(x>y.cols&&x<=y.cols+z){this.qty=x-y.cols}else{if(x&&x<=y.cols+z){return false}}}else{this.qty=z}return true},setAddedFinishedFn:function(x){this.addedFinishedFn=x},setCreateBarFn:function(x){this.createBarFn=x},setCreateCellFn:function(x){this.createCellFn=x},createCells:function(C,F,B){var A=(B?0:1),x=F.rows||1,z=C+this.qty,E,y=C,D;for(;y<z;y++){D=this.createBarFn(y+A);for(E=1;E<=x;E++){this.createCellFn(E,y+A,D)}}if(this.addedFinishedFn!==null){this.addedFinishedFn({row:0,col:this.qty})}}};return w})();l.RowAdder=(function(){function w(){this.qty=-1;this.addedFinishedFn=null;this.createBar=null;this.createCell=null;this.hidden=null}w.prototype={setQty:function(A,y,z){var x=d.sheet.max;if(x){if(x>y.rows&&x<=y.rows+A){this.qty=x-y.rows}else{if(x&&x<=y.rows+A){return false}}}else{this.qty=A}return true},setAddedFinishedFn:function(x){this.addedFinishedFn=x},setCreateBarFn:function(x){this.createBar=x},setCreateCellFn:function(x){this.createCell=x},setHidden:function(x){this.hidden=x||[]},createCells:function(D,G,C){var B=(C?0:1),x=D+this.qty,A=G.cols||1,E,y,F=D,z;for(;F<x;F++){y=this.hidden.indexOf(F+B)>-1;E=this.createBar(F+B,y);for(z=1;z<=A;z++){this.createCell(F+B,z,E,y)}}if(this.addedFinishedFn!==null){this.addedFinishedFn({row:this.qty,col:0})}}};return w})();(function(z){var y=undefined;function x(B,A){this.parent=B;this.maximumVisible=A;this.detachedAbove=[];this.detachedBelow=[];this.aboveChanged=false;this.belowChanged=false;this.hasInitialDetach=false}function w(F,C){var D=F.parent,B=D.children,E=F.detachedAbove.length,A;if(C<E){return}while((A=(E+(B.length-1)))>C){F.detachedBelow.unshift(D.lastChild);D.removeChild(D.lastChild)}}x.prototype={detachAboveBefore:function(D){var C,E=this.parent,B=E.children,A=this.detachedAbove;this.aboveChanged=false;while(A.length-1<D){C=B[1];if(C===y){break}A.push(C);E.removeChild(C);this.aboveChanged=true}return this},detachBelowAfter:function(C){if(!this.hasInitialDetach){this.hasInitialDetach=true;w(this,C)}var B,E=this.parent,A=this.detachedAbove.length,D=E.children;this.belowChanged=false;while(A+D.length>C){this.detachedBelow.unshift(B=E.lastChild);E.removeChild(B);this.belowChanged=true}return this},attachAboveAfter:function(B){var E=this.parent,F=m.createDocumentFragment(),D,A=this.detachedAbove,C;this.aboveChanged=false;while((C=A.length-1)>=B){D=A.pop();F.insertBefore(D,F.firstChild);this.aboveChanged=true}if(this.aboveChanged){E.insertBefore(F,E.children[1])}return this},attachBelowBefore:function(C){if(!this.hasInitialDetach){this.hasInitialDetach=true;w(this,C)}var E,D=this.parent,A=this.detachedBelow,H=m.createDocumentFragment(),G=H.children,F=this.detachedAbove.length+D.children.length,B;this.belowChanged=false;while((B=F+(G.length-1))<C&&this.detachedBelow.length>0){if(A.length<1){break}E=A.shift();H.appendChild(E);this.belowChanged=true}if(this.belowChanged){D.appendChild(H)}return this},isAboveActive:function(){return this.detachedAbove.length>0},isBelowActive:function(){return this.detachedBelow.length>0}};z.Detacher=x})(l);l.StyleUpdater=(function(w){function x(y){var z=this.styleElement=w.createElement("style");z.styleUpdater=this;this._update=y}x.prototype={setStyle:null,getStyle:null,nthCss:function(y,E,A,C,B){var D=[],z=A.length;B=B||"{display: none;}";do{if(A[z]>C){D.unshift(E+" "+y+":nth-child("+(A[z]+1)+")")}}while(z--);if(D.length){return D.join(",")+B}return""},repeat:function(A,z){var y="";while(z>0){if(z&1){y+=A}z>>=1;A+=A}return y},update:function(){return this._update.apply(this,arguments)}};if(w.createElement("style").styleSheet){x.prototype.setStyle=function(z){var A=this.styleElement,y=A.styleSheet;y.disabled=false;if(!y.disabled){y.cssText=z}};x.prototype.getStyle=function(){var z=this.styleElement,y=z.styleSheet;y.disabled=false;if(!y.disabled){return y.cssText}return""}}else{x.prototype.setStyle=function(y){this.styleElement.innerHTML=y};x.prototype.getStyle=function(){return this.styleElement.innerHTML}}return x})(m);l.JSONLoader=(function(y,w,x){function z(A){if(A!==undefined){this.json=A;this.count=A.length}else{this.json=[];this.count=0}this.cellIds={};this.jS=null;this.handler=null}z.prototype={bindJS:function(A){this.jS=A;return this},bindHandler:function(A){this.handler=A;return this},size:function(D){var C={cols:0,rows:0},B=this.json,F,E,G,A;if((F=B[D])===undefined){return C}if((E=F.rows)===undefined){return C}if((G=E[0])===undefined){return C}if((A=G.columns)===undefined){return C}return{rows:E.length,cols:A.length}},getWidth:function(A,E){var C=this.json,G=C[A]||{},B=G.metadata||{},F=B.widths||[],D=F[E]||l.defaultColumnWidth;return D},getHeight:function(B,G){var C=this.json,E=C[B]||{},D=E.rows||[],F=D[G]||{},A=F.height||l.defaultRowHeight;return A},isHidden:function(A){var C=this.json,D=C[A]||{},B=D.metadata||{};return B.hidden===true},setMetadata:function(A,D){var C=this.json,F=C[A]||{},E=F.metadata||(F.metadata={});var B;for(B in D){if(D.hasOwnProperty(B)){E[B]=D[B]}}return this},setupCell:function(B,G,D){var F=w.createElement("td"),A=this.jitCell(B,G,D),E,C;if(A===null){return A}E=A.loadedFrom;if(E===null){return null}if(A.hasOwnProperty("formula")){F.setAttribute("data-formula",A.formula||"");if(E.hasOwnProperty("cache")){if(E.cache!==null&&E.cache!==""){F.innerHTML=E.cache}}}else{if(E.cellType!==undefined){F.setAttribute("data-celltype",E.cellType);A.cellType=E.cellType;if(E.hasOwnProperty("cache")){F.innerHTML=E.cache}}else{F.innerHTML=A.value}}if(E["class"]!==undefined){F.className=E["class"]}if(E.style!==undefined){F.setAttribute("style",E.style)}if(E.rowspan!==undefined){F.setAttribute("rowspan",E.rowspan)}if(E.colspan!==undefined){F.setAttribute("colspan",E.colspan)}if(E.uneditable!==undefined){F.setAttribute("data-uneditable",E.uneditable)}if(E.id!==undefined){F.setAttribute("id",E.id);A.id=E.id}F.jSCell=A;A.td=F;A.sheetIndex=B;A.rowIndex=G;A.columnIndex=D;return A},getCell:function(B,H,D){var C=this.json,F,E,G,A;if((F=C[B])===undefined){return null}if((E=F.rows)===undefined){return null}if((G=E[H-1])===undefined){return null}if((A=G.columns[D-1])===undefined){return null}return A},jitCell:function(H,K,W){var I=this.getCell(H,K,W);if(I===null){return null}if(I.getCell!==undefined){return I.getCell()}var V,U,O,T,Q,M,A,C,R,Y,P,L,G,X,E,D,F,N,S,B,J;O=I.id;Q=I.value;M=I.cache;A=I.formula;C=I.parsedFormula;R=I.cellType;Y=I.uneditable;L=I.dependencies;X=(O!==undefined&&O!==null);E=(Q!==undefined&&Q!==null);D=(M!==undefined&&M!==null&&(M+"").length>0);F=(A!==undefined&&A!==null&&A!=="");N=(C!==undefined&&C!==null);S=(R!==undefined&&R!==null);B=(Y!==undefined&&Y!==null);J=(L!==undefined&&L!==null);V=new l.Cell(H,null,this.jS,this.handler);V.rowIndex=K;V.columnIndex=W;V.loadedFrom=I;V.loader=this;if(X){V.id=O}if(F){V.formula=A}if(N){V.parsedFormula=C}if(S){V.cellType=R}if(B){V.uneditable=Y}if(E){V.value=new x(Q)}else{V.value=new x()}if(D){V.value.html=M;V.needsUpdated=false}else{V.needsUpdated=(F||S||V.hasOperator.test(Q))}if(J){T=L.length;for(U=0;U<T;U++){G=L[U];P=this.jitCell(G.s,G.r,G.c);if(P!==null){V.dependencies.push(P)}}}V.value.cell=V;I.getCell=function(){return V};return V},jitCellById:function(A){if(this.cellIds[A]!==undefined){return this.cellIds[A].requestCell()}var G=this,I=this.json,H=I.length-1,E,F,K,J,D,C,B;if(H<0){return null}do{E=I[H];K=E.rows;F=K.length-1;do{J=K[F];C=J.columns;D=C.length-1;do{B=C[D];if(typeof B.id=="string"){this.cellIds[A]={cell:B,sheetIndex:H,rowIndex:F,columnIndex:D,requestCell:function(){return G.jitCell(this.sheetIndex,this.rowIndex,this.columnIndex)}}}}while(D-->0)}while(F-->0)}while(H-->0);if(this.cellIds[A]!==undefined){return this.cellIds[A].requestCell()}return this.cellIds[A]=null},title:function(A){var B=this.json,C;if((C=B[A])===undefined){return""}return C.title||""},hiddenRows:function(D){var F=this.json[D].metadata||{},C=F.hiddenRows||[],B=C.length,A=[],E=0;for(;E<B;E++){A.push(C[E])}return A},hiddenColumns:function(C){var E=this.json[C].metadata||{},F=E.hiddenColumns||[],B=F.length,A=[],D=0;for(;D<B;D++){A.push(F[D])}return A},hasSpreadsheetAtIndex:function(A){return(this.json[A]!==undefined)},getSpreadsheetIndexByTitle:function(E){var C=this.json,A=this.count,B=0,D;E=E.toLowerCase();for(;B<A;B++){if(C[B]!==undefined){D=C[B].title;if(D!==undefined&&D!==null&&D.toLowerCase()==E){return B}}}return -1},addSpreadsheet:function(B,A){if(A===undefined){this.json.push(B)}else{this.json.splice(A,0,B)}this.count=this.json.length},getCellAttribute:function(A,B){return A[B]},setCellAttribute:function(A,B,C){A[B]=C},setCellAttributes:function(A,B){var C;for(C in B){if(B.hasOwnProperty(C)){A[C]=B[C]}}return this},setDependencies:function(B){if(B.dependencies.length>z.maxStoredDependencies){delete B.loadedFrom.dependencies;return this}var E=0,G=B.loadedFrom,F=B.dependencies,D,A=F.length,C=G.dependencies=[];for(;E<A;E++){D=F[E];C.push({s:D.sheetIndex,r:D.rowIndex,c:D.columnIndex})}return this},addDependency:function(A,B){var C=A.loadedFrom;if(C.dependencies===undefined){C.dependencies=[]}C.dependencies.push({s:B.sheetIndex,r:B.rowIndex,c:B.columnIndex});return this},cycleCells:function(G,F){var H=this.json,D,J,B,A,I,E,C;if((D=H[G])===undefined){return}if((E=(J=D.rows).length)<1){return}if(J[0].columns.length<1){return}E--;do{I=J[E];B=I.columns;C=B.length-1;do{A=B[C];F.call(A,G,E+1,C+1)}while(C-->0)}while(E-->0);return this},cycleCellsAll:function(C){var B=this.json,A=B.length-1;if(A<0){return}do{this.cycleCells(A,C)}while(A-->0);return this},toTables:function(){var U=this.json,T=this.count,J=y([]),F,L,G,C,D,N,M,P,A,W,I,O,V,K,E,B,H,S=0,R,Q;for(;S<T;S++){F=U[S];V=y(w.createElement("table"));if(F.title){V.attr("title",F.title||"")}J=J.add(V);L=F.rows;for(R=0;R<L.length;R++){G=L[R];if(O=(G.height+"").replace("px","")){B=y(w.createElement("tr")).attr("height",O).css("height",O+"px").appendTo(V)}C=G.columns;for(Q=0;Q<C.length;Q++){D=C[Q];H=y(w.createElement("td")).appendTo(B);if(D["class"]){H.attr("class",D["class"]||"")}if(D.style){H.attr("style",D.style||"")}if(D.formula){H.attr("data-formula",(D.formula?"="+D.formula:""))}if(D.cellType){H.attr("data-celltype",D.cellType||"")}if(D.value){H.html(D.value||"")}if(D.uneditable){H.html(D.uneditable||"")}if(D.rowspan){H.attr("rowspan",D.rowspan||"")}if(D.colspan){H.attr("colspan",D.colspan||"")}if(D.id){H.attr("id",D.id||"")}if(D.cache){H.html(D.cache)}}}if(N=F.metadata){if(M=N.widths){K=y(w.createElement("colgroup")).prependTo(V);for(Q=0;Q<M.length;Q++){P=(M[Q]+"").replace("px","");E=y(w.createElement("col")).attr("width",P).css("width",P+"px").appendTo(K)}}if(A=N.frozenAt){if(A.row){V.attr("data-frozenatrow",A.row)}if(A.col){V.attr("data-frozenatcol",A.col)}}if(W=N.hiddenRows){V.attr("data-hiddenrows",W.join(","))}if(I=N.hiddenColumns){V.attr("data-hiddencolumns",I.join(","))}}}return J},fromSheet:function(E){E=(E==undefined?false:E);var M=[],J=this.jS,S=1*J.i,O,F=J.spreadsheets.length-1,T,H,I,D,K,R,C,A,P,L,N,Q,G,B;if(F<0){return M}do{Q=false;J.i=F;J.evt.cellEditDone();O=J.obj.pane();T={title:(J.obj.table().attr("title")||""),rows:[],metadata:{widths:[],frozenAt:{row:O.actionUI.frozenAt.row,col:O.actionUI.frozenAt.col}}};M.unshift(T);H=J.spreadsheets[F];I=H.length-1;do{G=H[I][1].td[0].parentNode;B=G.style.height;R={columns:[],height:(B?B.replace("px",""):J.s.colMargin)};D=H[I].length-1;do{A=H[I][D];C={};P=A.td[0].attributes;if(E||Q||P["class"]||A.formula||A.value||P.style){Q=true;L=(P["class"]?y.trim((P["class"].value||"").replace(J.cl.uiCellActive,"").replace(J.cl.uiCellHighlighted,"")):"");N=A.td[0].parentNode;R.columns.unshift(C);if(!R.height){R.height=(N.style.height?N.style.height.replace("px",""):J.s.colMargin)}if(A.formula){C.formula=A.formula}if(A.cellType){C.cellType=A.cellType}if(A.value){C.value=A.value}if(A.uneditable){C.uneditable=A.uneditable}if(A.cache){C.cache=A.cache}if(A.id){C.id=A.id}if(P.style&&P.style.value){C.style=P.style.value}if(L.length){C["class"]=L}if(P.rowspan){C.rowspan=P.rowspan.value}if(P.colspan){C.colspan=P.colspan.value}if(I*1==1){T.metadata.widths.unshift(y(J.col(null,D)).css("width").replace("px",""))}}}while(D-->1);if(Q){T.rows.unshift(R)}}while(I-->1)}while(F--);J.i=S;return this.json=M},type:z,typeName:"Sheet.JSONLoader",clearCaching:function(){var J=this.json,C,K,L,D,E,I=0,H,G,F=J.length,A,B;for(;I<F;I++){C=J[I];L=C.rows;A=L.length;for(H=0;H<A;H++){K=L[H];E=K.columns;B=E.length;for(G=0;G<B;G++){D=E[G];delete D.cache;delete D.dependencies;delete D.parsedFormula}}}return this},download:function(H){H=H||500;var N=f.open(),G,M,O=this.json,E=0,L=O.length-1,B;if(N!==undefined){G=N.document;G.write('<html>	<head id="head"></head>	<body>		<div id="entry">		</div>	</body></html>');M=y(G.getElementById("entry"));while(E<=L){B=O[E];if(B.rows.length>H){var K={title:B.title,metadata:B.metadata,rows:[]},F=[],J=0,Q,P=B.rows,I=P.length,D=1,A=0,C=function(S,R){M.append(w.createElement("br"));M.append(y(w.createElement("a")).attr("download",B.title+"-part"+R+".json").attr("href",URL.createObjectURL(new Blob([JSON.stringify(S)],{type:"application/json"}))).text(B.title+" - part "+R))};C(K,D);while(J<I){if(A===H){A=0;D++;C(F,D);F=[]}F.push(P[J]);A++;J++}if(F.length>0){D++;C(F,D)}}else{M.append(w.createElement("br")).append(y(w.createElement("a")).attr("download",B.title+".json").attr("href",URL.createObjectURL(new Blob([JSON.stringify(B)],{type:"application/json"}))).text(B.title))}E++}G.close();N.focus()}}};z.maxStoredDependencies=100;return z})(jQuery,m,q);l.XMLLoader=(function(x,w){function y(z){if(z!==undefined){this.xml=x.parseXML(z);this.spreadsheets=this.xml.getElementsByTagName("spreadsheets")[0].getElementsByTagName("spreadsheet");this.count=this.xml.length}else{this.xml=null;this.spreadsheets=null;this.count=0}}y.prototype={size:function(B){var z=this.xml[B],C=z.rows,D=C[0],A=D.columns;return{rows:C.length,cols:A.length}},setWidth:function(H,E,C){var D=this.spreadsheets,G=D[H],F=G.getElementsByTagName("metadata")[0]||{},A=F.getElementsByTagName("width")||[],B=A[E],z=(B.textContent||B.text);C.style.width=z+"px"},setRowHeight:function(A,G,E){var C=this.spreadsheets,B,D,F,z;if((B=C[A])===undefined){return}if((D=B.getElementsByTagName("rows")[0].getElementsByTagName("row"))===undefined){return}if((F=D[G])===undefined){return}if((z=F.attributes.height.nodeValue)===undefined){return}E.style.height=z+"px"},setupCell:function(H,C,B,z,D){var A=this.spreadsheets,G,I,E,F;if((G=A[H])===undefined){return false}if((I=G.getElementsByTagName("rows")[0].getElementsByTagName("row")[C-1])===undefined){return false}if((E=I.getElementsByTagName("columns")[0].getElementsByTagName("column")[B-1])===undefined){return false}z.cellType=E.attributes.cellType.nodeValue||"";if((F=E.jitCell)!==undefined){z.html=F.html;z.state=F.state;z.cellType=F.cellType;z.value=F.value;z.uneditable=F.uneditable;z.sheet=F.sheet;z.dependencies=F.dependencies}if(E.attributes.formula){z.formula=E.attributes.formula.nodeValue||"";D.setAttribute("data-formula",E.attributes.formula.nodeValue||"")}else{D.innerHTML=z.value=E.attributes.value.nodeValue||""}D.className=E.attributes["class"].nodeValue||"";D.setAttribute("style",E.attributes.style.nodeValue||"");if(E.attributes.rowspan){D.setAttribute("rowspan",E.attributes.rowspan.nodeValue||"")}if(E.attributes.colspan){D.setAttribute("colspan",E.attributes.colspan.nodeValue||"")}return true},getCell:function(z,B,A){return null},jitCell:function(A,F,D){var C=this.spreadsheets,B,E,z;if((B=C[A])===undefined){return false}if((E=B.getElementsByTagName("rows")[0].getElementsByTagName("row")[F-1])===undefined){return false}if((z=E.getElementsByTagName("columns")[0].getElementsByTagName("column")[D-1])===undefined){return false}return{td:{cellIndex:D,parentNode:{rowIndex:F},html:function(){}},html:[],state:[],cellType:z.attributes.cellType.nodeValue||"",formula:z.attributes.formula.nodeValue||"",value:z.attributes.value.nodeValue||"",type:"cell",sheet:A,id:null}},title:function(A){var B=this.spreadsheets,z;if((z=B[A])===undefined){return""}return(z.attributes.title?z.attributes.title.nodeValue:"")},getSpreadsheetIndexByTitle:function(z){},addSpreadsheet:function(z,A){if(A===undefined){this.spreadsheets.append.push(jsonSpreadsheet)}else{this.json.splice(A,0,jsonSpreadsheet)}this.count=this.json.length},setCellAttribute:function(z,A,B){},toTables:function(){var G=this.xml,K=x([]),E=G.getElementsByTagName("spreadsheets")[0].getElementsByTagName("spreadsheet"),H,O,I,C,F,X,R,ad,Q,N,P,U,S;for(var aa=0;aa<E.length;aa++){H=E[aa];var ac=x(w.createElement("table")).attr("title",(H.attributes.title?H.attributes.title.nodeValue:"")),M=x(w.createElement("colgroup")).appendTo(ac),A=x(w.createElement("tbody")).appendTo(ac);K=K.add(ac);O=H.getElementsByTagName("rows")[0].getElementsByTagName("row");R=H.getElementsByTagName("metadata")[0];for(var Y=0;Y<O.length;Y++){I=O[Y];var B=x(w.createElement("tr")).appendTo(A);if(S=I.attributes.height){S=(S.nodeValue||"").replace("px","");B.css("height",S).attr("height",S+"px")}C=I.getElementsByTagName("columns")[0].getElementsByTagName("column");for(var W=0;W<C.length;W++){F=C[W];var J=x(w.createElement("td")).appendTo(B),z=F.getElementsByTagName("formula")[0],Z=F.getElementsByTagName("cellType")[0],V=F.getElementsByTagName("value")[0],ab=F.getElementsByTagName("style")[0],L=F.getElementsByTagName("class")[0],ae=F.getElementsByTagName("rowspan")[0],D=F.getElementsByTagName("colspan")[0],T=F.getElementsByTagName("id")[0];if(z){J.attr("data-formula","="+(z.textContent||z.text))}if(Z){J.attr("data-celltype",Z.textContent||Z.text)}if(V){J.html(V.textContent||V.text)}if(ab){J.attr("style",ab.textContent||ab.text)}if(L){J.attr("class",L.textContent||L.text)}if(ae){J.attr("rowspan",ae.textContent||ae.text)}if(D){J.attr("colspan",D.textContent||D.text)}if(T){J.attr("id",T.textContent||T.text)}}}P=R.getElementsByTagName("width");for(var Y=0;Y<P.length;Y++){U=(P[Y].textContent||P[Y].text).replace("px","");x(w.createElement("col")).attr("width",U).css("width",U+"px").appendTo(M)}ad=R.getElementsByTagName("frozenAt")[0];if(ad){N=ad.getElementsByTagName("col")[0];Q=ad.getElementsByTagName("row")[0];if(N){ac.attr("data-frozenatcol",(N.textContent||N.text)*1)}if(Q){ac.attr("data-frozenatrow",(Q.textContent||Q.text)*1)}}}return K},fromSheet:function(L,F,G){F=(F==undefined?false:F);var O="",V=1*L.i,H=L.spreadsheets.length-1,A,J,K,E,M,T,U,C,B,R,N,P,z,S,Q,I,D;if(H<0){return O}do{S=false;L.i=H;L.evt.cellEditDone();z=x.extend({},L.obj.pane().actionUI.frozenAt);Q=[];J=L.spreadsheets[H];K=J.length-1;T="";do{C="";E=J[K].length-1;do{U="";B=J[K][E];R=B.td[0].attributes;N=(R["class"]?x.trim((R["class"].value||"").replace(L.cl.uiCellActive,"").replace(L.cl.uiCellHighlighted,"")):"");if(F||S||N||B.formula||B.value||R.style){S=true;U+="<column>";if(B.formula){U+="<formula>"+B.formula+"</formula>"}if(B.cellType){U+="<cellType>"+B.cellType+"</cellType>"}if(B.value){U+="<value>"+B.value+"</value>"}if(R.style){U+="<style>"+R.style.value+"</style>"}if(N){U+="<class>"+N+"</class>"}if(R.rowspan){U+="<rowspan>"+R.rowspan.value+"</rowspan>"}if(R.colspan){U+="<colspan>"+R.colspan.value+"</colspan>"}if(R.id){U+="<id>"+R.id.value+"</id>"}U+="</column>";C=U+C;if(K*1==1){Q[E]="<width>"+x(L.col(null,E)).css("width").replace("px","")+"</width>"}}}while(E-->1);if(C){I=J[K][1].td[0].parentNode;D=I.style.height;T='<row height="'+(D?D.replace("px",""):L.s.colMargin)+'"><columns>'+C+"</columns></row>"+T}}while(K-->1);A='<spreadsheet title="'+(L.obj.table().attr("title")||"")+'"><rows>'+T+"</rows><metadata>"+(z.row||z.col?"<frozenAt>"+(z.row?"<row>"+z.row+"</row>":"")+(z.col?"<col>"+z.col+"</col>":"")+"</frozenAt>":"")+"<widths>"+Q.join("")+"</widths></metadata></spreadsheet>";O=A+O}while(H--);L.i=V;O='<?xml version="1.0" encoding="UTF-8"?><spreadsheets xmlns="http://www.w3.org/1999/xhtml">'+O+"</spreadsheets>";if(G!==true){this.xml=x.parseXML(O)}return O},type:y,typeName:"Sheet.XMLLoader"};return y})(jQuery,m);d.fn.extend({sheet:function(x){var y=isNaN,w=d.sheet.events;d(this).each(function(){var C=d(this),E=d.extend({},d.sheet.defaults,x||{}),D=this.jS;E.useStack=(f.thaw===undefined?false:E.useStack);E.useMultiThreads=(f.operative===undefined?false:E.useMultiThreads);if(D){var A=C.children().detach();D.kill();C.html(A);for(var B in w){if(w.hasOwnProperty(B)){C.unbind(w[B])}}}E.parent=C;if((this.className||"").match(/\bnot-editable\b/i)!=null){E.editable=false}for(var z in w){if(w.hasOwnProperty(z)){C.bind(w[z],E[w[z]])}}if(!d.sheet.instance.length){d.sheet.instance=[]}this.jS=D=d.sheet.createInstance(E,d.sheet.instance.length);d.sheet.instance.push(D)});return this},disableSelectionSpecial:function(){this.each(function(){this.onselectstart=function(){return false};this.unselectable="on";this.style["-moz-user-select"]="none"});return this},getSheet:function(){var w=this[0],x=(w.jS||{});return x},getCellValue:function(x,C,y,B){var z=this[0],A=(z.jS||{}),w;if(A.getCell){w=A.getCell(x,C,y);if(w!==null){w.updateValue(B)}}return this},setCellValue:function(A,z,B,E,D){var y=this[0],w=(y.jS||{}),C;E=(E||0);if(w.getCell&&(C=w.getCell(E,z,B))){try{if((A+"").charAt(0)=="="){C.valueOverride=C.value="";C.formula=A.substring(1)}else{C.value=A;C.valueOverride=C.formula=""}C.updateValue(D)}catch(x){}}return this},setCellFormula:function(y,A,B,E,D){var z=this[0],w=(z.jS||{}),C;E=(E||0);if(w.getCell){try{C=w.getCell(E,A,B);if(C!==null){C.formula=y;C.valueOverride=C.value="";C.updateValue(D)}}catch(x){}}return this},isSheetFullScreen:function(){var w=this[0],x=(w.jS||{});if(x.obj){return x.obj.fullScreen().is(":visible")}return false},serializeCellInputs:function(x){var y=this[0],z=(y.jS||{}),w=z.obj.tables().find(":input");if(x){return w.serializeArray()}else{return w.serialize()}},viewSource:function(w){var x="";d(this).each(function(){if(w){x+=d(this).toPrettySource()}else{x+=d(this).toCompactSource()}});d.printSource(x);return x},toCompactSource:function(){var A=this[0];var x="";if(A.nodeType==1){x+="<"+A.tagName.toLowerCase();var C=A.attributes.length;for(var z=0;z<C;z++){var y=A.attributes[z].name,B=A.getAttribute(y);if(B){if(y=="contentEditable"&&B=="inherit"){continue}if(typeof(B)=="string"){x+=" "+y+'="'+B.replace(/"/g,"'")+'"'}else{if(y=="style"&&B.cssText){x+=' style="'+B.cssText+'"'}}}}if(A.tagName=="COL"){x+="/>"}else{x+=">";var w="";d(A.childNodes).each(function(){w+=d(this).toCompactSource()});x+=w;x+="</"+A.tagName.toLowerCase()+">"}}else{if(A.nodeType==3){x+=A.data.replace(/^\s*(.*)\s*$/g,"$1")}}return x},toPrettySource:function(B){var A=this[0],D,z;B=B||"";var x="";if(A.nodeType==1){x+="\n"+B+"<"+A.tagName.toLowerCase();D=A.attributes.length;for(z=0;z<D;z++){var y=A.attributes[z].name,C=A.getAttribute(y);if(C){if(y=="contentEditable"&&C=="inherit"){continue}if(typeof(C)=="string"){x+=" "+y+'="'+d.trim(C.replace(/"/g,"'"))+'"'}else{if(y=="style"&&C.cssText){x+=' style="'+d.trim(C.cssText)+'"'}}}}if(A.childNodes.length<=0){if(A.tagName=="COL"){x+="/>"}else{x+="></"+A.tagName.toLowerCase()+">"}}else{x+=">";var w="";D=A.childNodes.length;for(z=0;z<D;z++){w+=d(A.childNodes[z]).toPrettySource(B+"  ")}x+=w;if(w.indexOf("\n")>=0){x+="\n"+B}x+="</"+A.tagName.toLowerCase()+">"}}else{if(A.nodeType==3){x+=A.data.replace(/^\s*(.*)\s*$/g,"$1")}}return x}});d.sheet={defaults:{editable:true,editableNames:true,barMenus:true,freezableCells:true,allowToggleState:true,menuLeft:null,menuRight:null,newColumnWidth:120,title:null,calcOff:false,lockFormulas:false,parent:null,colMargin:20,boxModelCorrection:2,formulaFunctions:{},formulaVariables:{},cellSelectModel:l.excelSelectModel,autoAddCells:true,resizableCells:true,resizableSheet:true,autoFiller:true,minSize:{rows:1,cols:1},error:function(w){return w.error},endOfNumber:false,frozenAt:[],contextmenuTop:{"Insert column after":function(w){w.controlFactory.addColumn(w.colLast);return false},"Insert column before":function(w){w.controlFactory.addColumn(w.colLast,true);return false},"Add column to end":function(w){w.controlFactory.addColumn();return false},"Delete this column":function(w){w.deleteColumn();return false},"Hide column":function(w){w.toggleHideColumn();return false},"Show all columns":function(w){w.columnShowAll()},"Toggle freeze columns to here":function(y){var w=y.getTdLocation(y.obj.tdActive()).col,x=y.obj.pane().actionUI;x.frozenAt.col=(x.frozenAt.col==w?0:w)}},contextmenuLeft:{"Insert row after":function(w){w.controlFactory.addRow(w.rowLast);return false},"Insert row before":function(w){w.controlFactory.addRow(w.rowLast,true);return false},"Add row to end":function(w){w.controlFactory.addRow();return false},"Delete this row":function(w){w.deleteRow();return false},"Hide row":function(w){w.toggleHideRow();return false},"Show all rows":function(w){w.rowShowAll()},"Toggle freeze rows to here":function(x){var y=x.getTdLocation(x.obj.tdActive()).row,w=x.obj.pane().actionUI;w.frozenAt.row=(w.frozenAt.row==y?0:y)}},contextmenuCell:{"Insert row after":function(w){w.controlFactory.addRow(w.rowLast);return false},"Insert row before":function(w){w.controlFactory.addRow(w.rowLast,true);return false},"Add row to end":function(w){w.controlFactory.addRow();return false},"Delete this row":function(w){w.deleteRow();return false},line2:"line","Insert column after":function(w){w.controlFactory.addColumn(w.colLast);return false},"Insert column before":function(w){w.controlFactory.addColumn(w.colLast,true);return false},"Add column to end":function(w){w.controlFactory.addColumn();return false},"Delete this column":function(w){w.deleteColumn();return false},line3:"line","Add spreadsheet":function(w){w.addSheet()},"Delete spreadsheet":function(w){w.deleteSheet()}},hiddenRows:[],hiddenColumns:[],alert:function(w){alert(w)},prompt:function(x,y,w){y(prompt(x,w))},confirm:function(y,w,x){if(confirm(y)){w()}else{if(x){x()}}},initCalcRows:1,initCalcCols:10,initScrollRows:0,initScrollCols:0,loader:null,useStack:true,useMultiThreads:true},instance:[],dependencies:{coreCss:{css:"jquery.sheet.css"},jQueryUI:{script:"jquery-ui/jquery-ui.min.js",thirdParty:true},jQueryUIThemeRoller:{css:"jquery-ui/themes/smoothness/jquery-ui.min.css",thirdParty:true},globalize:{script:"globalize/lib/globalize.js",thirdParty:true},nearest:{script:"jquery-nearest/src/jquery.nearest.min.js",thirdParty:true},mousewheel:{script:"MouseWheel/MouseWheel.js",thirdParty:true},operative:{script:"operative/dist/operative.js",thirdParty:true}},optional:{advancedFn:{script:"plugins/jquery.sheet.advancedfn.js"},financeFn:{script:"plugins/jquery.sheet.financefn.js"},colorPicker:{css:"really-simple-color-picker/colorPicker.css",script:"really-simple-color-picker/jquery.colorPicker.min.js",thirdParty:true},elastic:{script:"jquery-elastic/jquery.elastic.source.js",thirdParty:true},globalizeCultures:{script:"globalize/lib/cultures/globalize.cultures.js",thirdParty:true},raphael:{script:"raphael/raphael-min.js",thirdParty:true,async:false},gRaphael:{script:"graphael/g.raphael.js",thirdParty:true,async:false},gRaphaelBar:{script:"graphael/g.bar.js",thirdParty:true,async:false},gRaphaelDot:{script:"graphael/g.dot.js",thirdParty:true,async:false},gRaphaelLine:{script:"graphael/g.line.js",thirdParty:true,async:false},gRaphaelPie:{script:"graphael/g.pie.js",thirdParty:true,async:false},thaw:{script:"thaw.js/thaw.js",thirdParty:true},undoManager:{script:"Javascript-Undo-Manager/js/undomanager.js",thirdParty:true},zeroClipboard:{script:"zeroclipboard/dist/ZeroClipboard.min.js",thirdParty:true}},events:["sheetAddRow","sheetAddColumn","sheetSwitch","sheetRename","sheetTabSortStart","sheetTabSortUpdate","sheetCellEdit","sheetCellEdited","sheetCalculation","sheetAdd","sheetDelete","sheetDeleteRow","sheetDeleteColumn","sheetOpen","sheetAllOpened","sheetSave","sheetFullScreen","sheetFormulaKeydown"],preLoad:function(B,z){B=B||"";z=d.extend({skip:["globalizeCultures"],thirdPartyDirectory:"bower_components/"},z);var A=m.getElementsByTagName("script")[0],y=A.parentNode,x=function(){var C;if(this.script!==undefined){C=m.createElement("script");C.async=this.hasOwnProperty("async")?this.async:true;C.src=B+(this.thirdParty?z.thirdPartyDirectory:"")+this.script;y.insertBefore(C,A)}if(this.css!==undefined){C=m.createElement("link");C.rel="stylesheet";C.type="text/css";C.href=B+(this.thirdParty?z.thirdPartyDirectory:"")+this.css;y.insertBefore(C,A)}};for(var w in z.skip){if(this.dependencies[z.skip[w]]){delete this.dependencies[z.skip[w]]}if(this.optional[z.skip[w]]){delete this.optional[z.skip[w]]}}d.each(this.dependencies,function(){x.call(this)});d.each(this.optional,function(){x.call(this)})},createInstance:function(H,E){var K=this,N=function(Q,I){var P=I.parentNode;if(P.lastchild==I){P.appendChild(Q)}else{P.insertBefore(Q,I.nextSibling)}},J=d(f),O=d(m),F=m.body,M=d(F),C=function(){},G=undefined,x=g,L=isNaN,B=NaN,z=f.thaw,y=(H.loader!==null),D={version:"4.x",i:0,I:E,sheetCount:0,spreadsheets:[],controls:{autoFiller:[],bar:{helper:[],corner:[],x:{controls:[],handleFreeze:[],menu:[],menuParent:[],parent:[],th:[],ths:function(){var P=[],R=0,Q=this.th[D.i],I=Q.length;for(;R<I;R++){P.push(Q[R])}return P}},y:{controls:[],handleFreeze:[],menu:[],parent:[],th:[],ths:function(){var P=[],R=0,Q=this.th[D.i],I=Q.length;for(;R<I;R++){P.push(Q[R])}return P}}},barMenuLeft:[],barMenuTop:[],barLeft:[],barTop:[],barTopParent:[],chart:[],tdMenu:[],cellsEdited:[],enclosure:[],enclosures:null,formula:null,fullScreen:null,header:null,inPlaceEdit:[],inputs:[],label:null,menuLeft:[],menuRight:[],menus:[],pane:[],panes:null,scrolls:null,sheetAdder:null,table:[],tables:null,tab:[],tabContainer:null,tabs:null,title:null,toggleHide:{x:[],y:[]},ui:null},obj:{autoFiller:function(){return D.controls.autoFiller[D.i]||d([])},barCorner:function(){return D.controls.bar.corner[D.i]||d([])},barHelper:function(){return D.controls.bar.helper[D.i]||(D.controls.bar.helper[D.i]=d([]))},barLeft:function(I){return(D.controls.bar.y.th[D.i]&&D.controls.bar.y.th[D.i][I]?D.controls.bar.y.th[D.i][I]:[])},barLeftControls:function(){return D.controls.bar.y.controls[D.i]||d([])},barLefts:function(){return D.controls.bar.y.ths()},barHandleFreezeLeft:function(){return D.controls.bar.y.handleFreeze[D.i]||d([])},barMenuLeft:function(){return D.controls.bar.y.menu[D.i]||d([])},barTop:function(I){return(D.controls.bar.x.th[D.i]&&D.controls.bar.x.th[D.i][I]?D.controls.bar.x.th[D.i][I]:[])},barTopControls:function(){return D.controls.bar.x.controls[D.i]||d([])},barTops:function(){return D.controls.bar.x.ths()},barTopParent:function(){return D.controls.bar.x.parent[D.i]||d([])},barHandleFreezeTop:function(){return D.controls.bar.x.handleFreeze[D.i]||d([])},barMenuParentTop:function(){return D.controls.bar.x.menuParent[D.i]||d([])},barMenuTop:function(){return D.controls.bar.x.menu[D.i]||d([])},tdActive:function(){return D.cellLast.td||null},tdMenu:function(){return D.controls.tdMenu[D.i]||d([])},cellsEdited:function(){return(D.controls.cellsEdited!==G?D.controls.cellsEdited:D.controls.cellsEdited=[])},chart:function(){return D.controls.chart[D.i]||d([])},enclosure:function(){return D.controls.enclosure[D.i]||d([])},enclosures:function(){return D.controls.enclosures||d([])},formula:function(){return D.controls.formula||d([])},fullScreen:function(){return D.controls.fullScreen||d([])},header:function(){return D.controls.header||d([])},highlighted:function(){return D.highlighter.last||d([])},menuRight:function(){return D.controls.menuRight[D.i]||d([])},inPlaceEdit:function(){return D.controls.inPlaceEdit[D.i]||d([])},inputs:function(){return D.controls.inputs[D.i]||d([])},label:function(){return D.controls.label||d([])},menus:function(){return D.controls.menus[D.i]||d([])},menuLeft:function(){return D.controls.menuLeft[D.i]||d([])},pane:function(){return D.controls.pane[D.i]||{}},panes:function(){return D.controls.panes||d([])},parent:function(){return H.parent},scrolls:function(){return D.controls.scrolls||d([])},sheetAdder:function(){return D.controls.sheetAdder||d([])},table:function(){return D.controls.table[D.i]||d([])},tables:function(){return D.controls.tables||d([])},tab:function(){return D.controls.tab[D.i]||d([])},tabs:function(){return D.controls.tabs||d([])},tabContainer:function(){return D.controls.tabContainer||d([])},title:function(){return D.controls.title||d([])}},id:"jS_"+E+"_",cl:{autoFiller:"jSAutoFiller",autoFillerHandle:"jSAutoFillerHandle",autoFillerCover:"jSAutoFillerCover",barCorner:"jSBarCorner",barController:"jSBarController",barControllerChild:"jSBarControllerChild",barHelper:"jSBarHelper",barLeft:"jSBarLeft",barHandleFreezeLeft:"jSBarHandleFreezeLeft",barTop:"jSBarTop",barTopMenuButton:"jSBarTopMenuButton",barHandleFreezeTop:"jSBarHandleFreezeTop",barTopParent:"jSBarTopParent",chart:"jSChart",formula:"jSFormula",formulaParent:"jSFormulaParent",header:"jSHeader",fullScreen:"jSFullScreen",inPlaceEdit:"jSInPlaceEdit",menu:"jSMenu",menuFixed:"jSMenuFixed",parent:"jSParent",scroll:"jSScroll",sheetAdder:"jSSheetAdder",table:"jS",label:"jSLoc",pane:"jSEditPane",tab:"jSTab",tabContainer:"jSTabContainer",tabContainerScrollable:"jSTabContainerScrollable",tdMenu:"jSTdMenu",title:"jSTitle",enclosure:"jSEnclosure",ui:"jSUI"},msg:{addRowMulti:"How many rows would you like to add?",addColumnMulti:"How many columns would you like to add?",cellFind:"What are you looking for in this spreadsheet?",cellNoFind:"No results found.",dragToFreezeCol:"Drag to freeze column",dragToFreezeRow:"Drag to freeze row",addSheet:"Add a spreadsheet",openSheet:"Are you sure you want to open a different sheet?  All unsaved changes will be lost.",toggleHideRow:"No row selected.",toggleHideColumn:"No column selected.",loopDetected:"Loop Detected",newSheetTitle:"What would you like the sheet's title to be?",notFoundColumn:"Column not found",notFoundRow:"Row not found",notFoundSheet:"Sheet not found",setCellRef:"Enter the name you would like to reference the cell by.",sheetTitleDefault:"Spreadsheet {index}",maxRowsBrowserLimitation:"You've reached the maximum amount of rows this browser supports. Try using Chrome, FireFox, or Internet Explorer 9+",maxColsBrowserLimitation:"You've reached the maximum amount of columns this browser supports. Try using Chrome, FireFox, or Internet Explorer 9+",maxSizeBrowserLimitationOnOpen:"The spreadsheet you are loading is larger than the maximum size of cells this browser supports. Try using Chrome, Firefox, or Internet Explorer 9+. You can an proceed, but the spreadsheet may not work as intended.",cellLoading:"Loading..."},kill:function(){if(!D){return false}d(m).unbind("keydown");this.obj.fullScreen().remove();(this.obj.inPlaceEdit().destroy||C)();H.parent.trigger("sheetKill").removeClass(D.theme.parent).html("");delete H.parent[0].jS;this.obj.menus().remove();var I=d.sheet.events.length;for(var P=0;P<I;P++){H.parent.unbind(d.sheet.events[P])}d.sheet.instance.splice(E,1);return true},trigger:function(I,P){P=P||[];return H.parent.triggerHandler(I,[D].concat(P))},spreadsheetsToArray:function(I){if(I||D.spreadsheets.length==0){D.cycleCellsAll(function(Q,R,P){D.createCell(Q,R,P)})}return D.spreadsheets},spreadsheetToArray:function(P,I){I=(I?I:D.i);if(!D.spreadsheets[I]){D.cycleCells(function(R,S,Q){D.createCell(R,S,Q)})}return D.spreadsheets[I]},createCell:function(T,W,Y,ad){var Q,U,X,ab,af,aa,R,S,P,V,ah,ag,I,ac,ae,ai,Z;if((Q=D.spreadsheets[T])===G){Q=D.spreadsheets[T]=[]}if((U=Q[W])===G){U=Q[W]=[]}if((af=D.controls.tables[T])===G){return null}if((S=af.tBody)===G){return null}if((P=S.children[W])===G){return null}if((V=P.children[Y])===G){return null}X=U[Y]=V.jSCell=new l.Cell(T,V,D,D.cellHandler);I=V.getAttribute("data-formula");ac=V.getAttribute("data-celltype");ai=V.getAttribute("data-uneditable");Z=V.getAttribute("id");if(I!==null){X.formula=I}if(ac!==null){X.cellType=ac;ae=true}if(ai!==null){X.uneditable=ai}if(Z!==null){X.id=Z}ab=V.textContent||V.innerText;switch(typeof(ab)){case"object":break;case"undefined":ab=new q();break;case"number":X.value=new t(ab);break;case"boolean":X.value=new v(ab);break;case"string":default:X.value=new q(ab);break}X.value.cell=X;X.calcCount=ad||0;X.needsUpdated=X.formula.length>0||ae;if(X.formula.length>0&&X.formula.charAt(0)=="="){X.formula=X.formula.substring(1)}aa=af.colGroup;if((R=aa.children[Y])===G){R=m.createElement("col");R.setAttribute("style","width:"+D.s.newColumnWidth+"px;");aa.appendChild(R)}if((ag=D.controls.bar.y.th[T])===G){ag=D.controls.bar.y.th[T]=[]}if(ag[W]===G){ag[W]=P.children[0]}if((ah=D.controls.bar.x.th[T])===G){ah=D.controls.bar.x.th[T]=[]}if(ah[Y]!==G){ah[Y]=S.children[0].children[Y]}return X},getCell:function(Q,T,R){var P,S,I;if((P=D.spreadsheets[Q])===G||(S=P[T])===G||(I=S[R])===G){if(H.loader!==null){I=H.loader.jitCell(Q,T,R)}}if(I===G||I===null){return null}I.sheetIndex=Q;I.rowIndex=T;I.columnIndex=R;return I},getCellById:function(S,P,T){var R=H.loader!==null,I,Q;if(typeof P==="function"){Q=-1;T=P}else{Q=P;if(typeof Q==="sting"){Q=H.loader.getSpreadsheetIndexByTitle(Q)}}if(R){I=H.loader.jitCellById(S,Q);if(T!==G&&I!==null){T.call(I);return this}return I}return null},getCells:function(I,U){var Q=0,R=I.length,P=R-1,S,W,T,V=[];for(;Q<R;Q++){S=I[Q];if(typeof S==="string"){T=D.getCellById(S)}else{W=S;T=D.getCell(W.sheet,W.rowIndex,W.columnIndex)}if(T!==null){V.push(T)}}return V},updateCells:function(I,V){var Q=0,R=I.length,P=R-1,S,W,U,T=[];for(;Q<R;Q++){S=I[Q];if(typeof S==="string"){U=D.getCellById(S)}else{W=S;U=D.getCell(W.sheet,W.rowIndex,W.columnIndex)}if(U!==null){if(V!==G){(function(X,Y){X.updateValue(function(Z){P--;T[Y]=Z;if(P<0){V.apply(D,T)}})})(U,Q)}}else{P--}}},nav:false,setNav:function(Q){var I=d.sheet.instance;for(var P=0;P<I.length;P++){(I[P]||{}).nav=false}D.nav=Q},controlFactory:{addRowMulti:function(R,U,Q,I,T){var P=(T?"row-init":"row");function S(V){if(V){if(!L(V)){D.controlFactory.addCells(R,Q,parseInt(V),P,I);D.trigger("sheetAddRow",[R,Q,V])}}}if(!U){H.prompt(D.msg.addRowMulti,S)}else{S(U)}},addColumnMulti:function(R,U,Q,I,T){var P=(T?"col-init":"col");function S(V){if(V){if(!L(V)){D.controlFactory.addCells(R,Q,parseInt(V),P,I);D.trigger("sheetAddColumn",[R,Q,V])}}}if(!U){H.prompt(D.msg.addColumnMulti,S)}else{S(U)}},rowAdder:new l.RowAdder(),columnAdder:new l.ColumnAdder(),addCells:function(an,au,ac,T,af){if(ac<1){return false}D.autoFillerHide();D.setDirty(true);D.setChanged(true);D.obj.barHelper().remove();var U,al=D.obj.pane(),ar=al.table,aa=al.actionUI,X=ar.tBody,ao=ar.colGroup,ae=false,ak=D.obj.tdActive(),Z=D.spreadsheets[D.i]||(D.spreadsheets[D.i]=[]),am,Y,ai=D.cl.barLeft+" "+D.theme.bar,at=D.cl.barTop+" "+D.theme.bar,ab,ad=(H.loader!==null?H.loader:null),R=(ad!==null?function(aw,av){return ad.getWidth(aw,av)}:function(){return H.newColumnWidth}),ah=(ad!==null?function(av,aw){return ad.getHeight(av,aw)}:function(){return H.colMargin}),W=function(aw,az,ax,av){var ay=m.createElement("td");return new l.Cell(D.i,ay,D,D.cellHandler)},aj=(ad!==null?ad.setupCell:W),S=D.controls.bar.x.th[D.i]||(D.controls.bar.x.th[D.i]=[]),Q=D.controls.bar.y.th[D.i]||(D.controls.bar.y.th[D.i]=[]),ag=al.size(),aq=ar.size(),I=m.createDocumentFragment(),P,V=aa.yDetacher,ap=false;ac=ac||1;T=T||"col";switch(T){case"row-init":case"row":P=aa.maximumVisibleRows;if(an===G||an===null){an=Z.length-1;ae=true}if(T==="row-init"&&((an===0&&Z.length===0)||an===Z.length-1)){ae=true}if(an>ag.rows){an=ag.rows;ae=true}U=an;if(U>aq.rows){U=aq.rows}else{if(an===0){au=false}}if(ae){ap=V.isBelowActive();if(ap){an+=V.detachedBelow.length-1}}ab={row:an,col:0};am=this.rowAdder;if(am.setQty(ac,aq)===false){if(!D.isBusy()){H.alert(D.msg.maxRowsBrowserLimitation)}return}am.setCreateBarFn(function(ay,aw){var av=m.createElement("tr"),ax=m.createElement("th");ax.className=ai;ax.entity="left";ax.type="bar";ax.style.height=ah(D.i,ay)+"px";ax.innerHTML=ax.label=ay;av.appendChild(ax);if(!aw){if(ap){V.detachedBelow.push(av)}else{if(X.children.length+I.children.length<aa.maximumVisibleRows){I.appendChild(av);if(I.children.length===P){ap=true}}else{V.detachedBelow.push(av)}}}if(Z.length===0){Q[ay]=ax;Z[ay]=[]}else{Q.splice(ay,0,ax);Z.splice(ay,0,[])}return av});am.setCreateCellFn(function(aB,az,aw,ax){var av=aj.call(ad,D.i,aB,az,D),aA,ay=Z[aB];if(av===null){av=W(D.i,aB,az,D)}aA=av.td;aA.jSCell=av;if(ay===G){console.log(D)}if(ay.length===0){ay[az]=av}else{ay.splice(az,0,av)}if(!ax){av.updateValue()}aw.insertBefore(aA,aw.children[az])});am.setHidden(H.hiddenRows[D.i]);am.setAddedFinishedFn(function(av){X.insertBefore(I,au?X.children[U]:X.children[U].nextSibling);if(!ae){D.refreshRowLabels(i)}Y=av});break;case"col":case"col-init":if(an===G||an===null){an=aq.cols;ae=true}if(T==="col-init"&&((an===0&&Z[1].length===0)||an===Z.length-1)){ae=true}if(an>ag.cols){an=ag.cols;ae=true}U=an;if(U>aq.cols){U=aq.cols}else{if(an===0){au=false}}ab={row:0,col:an};am=this.columnAdder;if(am.setQty(ac,aq)===false){if(!D.isBusy()){H.alert(D.msg.maxColsBrowserLimitation)}return}am.setCreateBarFn(function(az){var ax=X.children[0],ay=m.createElement("col"),aA=m.createElement("th"),aw,av=X.children[1];ay.style.width=R(D.i,az)+"px";aA.entity="top";aA.type="bar";aA.innerHTML=aA.label=h.columnLabelString(az-1);aA.className=at;if(av===G){aw=m.createElement("th");aw.setAttribute("class",ai);aw.entity="left";aw.type="bar";av=m.createElement("tr");av.style.height=ah(D.i,az)+"px";av.appendChild(aw);X.appendChild(av);aw.innerHTML=av.rowIndex;Q.splice(0,0,aw)}ao.insertBefore(ay,ao.children[az]);ax.insertBefore(aA,ax.children[az]);if(S.length===0){S[az]=aA}else{S.splice(az,0,aA)}return{bar:aA,col:ay,barParent:ax}});am.setCreateCellFn(function(aB,az,ax){var aw=aj.call(ad,D.i,aB,az,D),aA,av,ay=Z[aB];if(aw===null){aw=W(D.i,aB,az,D)}aA=aw.td;if(ay===G){Z[aB]=ay=[];av=X.children[aB]}else{av=ay[1].td.parentNode}if(ay.length===0){ay[az]=aw}else{ay.splice(az,0,aw)}aw.updateValue();av.insertBefore(aA,av.children[az])});am.setAddedFinishedFn(function(av){if(!ae){D.refreshColumnLabels(an)}Y=av});break}am.createCells(an,aq,au);if(!af&&ae!=true){D.offsetFormulas(ab,Y,au)}if(al.inPlaceEdit){al.inPlaceEdit.goToTd()}if(ak&&ak[0]&&ak[0].cellIndex&&ak[0].parentNode){D.colLast=ak[0].cellIndex;D.rowLast=ak[0].parentNode.rowIndex}return true},addRow:function(P,I){D.controlFactory.addCells(P,I,1,"row");D.trigger("sheetAddRow",[P,I,1])},addColumn:function(P,I){D.controlFactory.addCells(P,I,1,"col");D.trigger("sheetAddColumn",[P,I,1])},barLeft:function(R){var S=R.tBody.children,Q,P=S.length-1,I=D.controls.bar.y.th[D.i]=[];if(P>0){do{Q=m.createElement("th");I[P]=Q;S[P].insertBefore(Q,S[P].children[0])}while(P-->1)}},barTop:function(Y){var P=Y.colGroup,X=P.children,S,Q=Y.tBody.children[0],U=m.createElement("col"),V=m.createElement("th"),T=m.createElement("tr"),R=0,W=D.controls.bar.x.th[D.i]=[];if(Q===G){P.innerHTML=""}else{R=Q.children.length;while(X.length>R){P.removeChild(X[X.length-1])}}U.style.width=U.style.minWidth=H.colMargin+"px";P.insertBefore(U,P.children[0]);T.appendChild(V);T.className=D.cl.barTopParent;Y.tBody.insertBefore(T,Y.tBody.children[0]);Y.barTopParent=T;Y.corner=V;V.col=U;D.controls.barTopParent[D.i]=d(T);S=g.min(R,H.initCalcCols);if(S>0){do{var I=m.createElement("th");W[S]=I;if(!X[S]){X[S]=m.createElement("col");P.insertBefore(X[S],U.nextSibling)}X[S].bar=I;I.col=X[S];T.insertBefore(I,V.nextSibling)}while(S-->1)}Y.barTop=D.controls.barTopParent[D.i].children();return T},barHandleFreeze:{top:function(Q){if(D.isBusy()){return false}var I=D.obj.pane().actionUI,aa=I.frozenAt,W=I.scrolledArea;if(!(W.col<=(aa.col+1))){return false}D.obj.barHelper().remove();var ab=Q.table,Z=ab.tBody,R=Z.children[0],T=R.children,V=d(T[aa.col+1]),Y=V.position(),X,S=d(Q).offset(),U=m.createElement("div"),P=Q.freezeHandleTop=d(U).appendTo(Q).addClass(D.theme.barHandleFreezeTop+" "+D.cl.barHelper+" "+D.cl.barHandleFreezeTop).height(V.height()).css("left",(Y.left-U.clientWidth)+"px").attr("title",D.msg.dragToFreezeCol);D.controls.bar.helper[D.i]=D.obj.barHelper().add(U);D.controls.bar.x.handleFreeze[D.i]=P;D.draggable(P,{axis:"x",start:function(){D.setBusy(true);X=d(m.createElement("div")).appendTo(Q).css("position","absolute").addClass(D.theme.barFreezeIndicator+" "+D.cl.barHelper).height(Q.table.corner.clientHeight).fadeTo(0,0.33)},drag:function(){var ac=D.nearest(P,T).prev();if(ac.length&&ac.position){X.width(ac.position().left+ac.width())}},stop:function(ae,ac){X.remove();D.setBusy(false);D.setDirty(true);var ad=D.nearest(P,T);D.obj.barHelper().remove();W.col=I.frozenAt.col=D.getTdLocation(ad[0]).col-1;D.autoFillerHide()},containment:[S.left,S.top,x.min(S.left+Q.table.clientWidth,S.left+Q.clientWidth-f.scrollBarSize.width),S.top]});return true},left:function(Q){if(D.isBusy()){return false}var Q=D.obj.pane(),I=Q.actionUI,Z=I.frozenAt,V=I.scrolledArea;if(!(V.row<=(Z.row+1))){return false}D.obj.barHelper().remove();var aa=Q.table,Y=aa.tBody,U=d(Y.children[Z.row+1].children[0]),X=U.position(),W,R=d(Q).offset(),T=m.createElement("div"),S=Y.children,P=Q.freezeHandleLeft=d(T).appendTo(Q).addClass(D.theme.barHandleFreezeLeft+" "+D.cl.barHelper+" "+D.cl.barHandleFreezeLeft).width(U.width()).css("top",(X.top-T.clientHeight+1)+"px").attr("title",D.msg.dragToFreezeRow);D.controls.bar.helper[D.i]=D.obj.barHelper().add(T);D.controls.bar.y.handleFreeze[D.i]=P;D.draggable(P,{axis:"y",start:function(){D.setBusy(true);W=d(m.createElement("div")).appendTo(Q).css("position","absolute").addClass(D.theme.barFreezeIndicator+" "+D.cl.barHelper).width(T.clientWidth).fadeTo(0,0.33)},drag:function(){var ab=D.nearest(P,S).prev();if(ab.length&&ab.position){W.height(ab.position().top+ab.height())}},stop:function(ad,ab){W.remove();D.setBusy(false);D.setDirty(true);var ac=D.nearest(P,S);D.obj.barHelper().remove();V.row=I.frozenAt.row=x.max(D.getTdLocation(ac.children(0)[0]).row-1,0);D.autoFillerHide()},containment:[R.left,R.top,R.left,x.min(R.top+Q.table.clientHeight,R.top+Q.clientHeight-f.scrollBarSize.height)]});return true},corner:function(){}},menu:function(Q,I){var T,P=d([]),S=D.theme.menuHover;switch(Q){case"top":T=d(m.createElement("div")).addClass(D.theme.menu+" "+D.cl.tdMenu);D.controls.bar.x.menu[D.i]=T;break;case"left":T=d(m.createElement("div")).addClass(D.theme.menu+" "+D.cl.tdMenu);D.controls.bar.y.menu[D.i]=T;break;case"cell":T=d(m.createElement("div")).addClass(D.theme.menu+" "+D.cl.tdMenu);D.controls.tdMenu[D.i]=T;break}D.controls.menus[D.i]=D.obj.menus().add(T);T.mouseleave(function(){T.hide()}).bind("contextmenu",function(){return false}).appendTo(M).hide().disableSelectionSpecial();for(var R in I){if(I[R]){if(d.isFunction(I[R])){P.pushStack(d(m.createElement("div")).text(R).data("msg",R).click(function(){I[d(this).data("msg")].call(this,D);T.hide();return false}).appendTo(T).hover(function(){P.removeClass(S);d(this).addClass(S)},function(){d(this).removeClass(S)}))}else{if(I[R]=="line"){d(m.createElement("hr")).appendTo(T)}}}}return T},barMenu:{top:function(Q,I,P){if(D.isBusy()){return false}var S=D.obj.barMenuTop().hide();if(!S.length){S=D.controlFactory.menu("top",H.contextmenuTop)}D.obj.menus().hide();if(!P){S.css("left",(Q.pageX-5)+"px").css("top",(Q.pageY-5)+"px").show();return S}var R=D.obj.barMenuParentTop().hide();if(!R.length){R=d(m.createElement("div")).addClass(D.theme.barMenuTop+" "+D.cl.barHelper+" "+D.cl.barTopMenuButton).append(d(m.createElement("span")).addClass("ui-icon ui-icon-triangle-1-s")).mousedown(function(T){R.parent().mousedown().mouseup();var U=R.offset();S.css("left",(T.pageX-5)+"px").css("top",(T.pageY-5)+"px").show()}).blur(function(){if(S){S.hide()}});R.get(0).destroy=function(){R.remove();D.controls.bar.x.menuParent[D.i]=null};D.controls.bar.x.menuParent[D.i]=R}R.prependTo(P).show()},left:function(P,I){if(D.isBusy()){return false}D.obj.barMenuLeft().hide();if(I){D.obj.barHandleFreezeLeft().remove()}var Q;Q=D.obj.barMenuLeft();if(!Q.length){Q=D.controlFactory.menu("left",H.contextmenuLeft)}D.obj.menus().hide();Q.css("left",(P.pageX-5)+"px").css("top",(P.pageY-5)+"px").show();return true},corner:function(){}},tdMenu:function(I){if(D.isBusy()){return false}D.obj.tdMenu().hide();var P=D.obj.tdMenu();if(!P.length){P=D.controlFactory.menu("cell",H.contextmenuCell)}D.obj.menus().hide();P.css("left",(I.pageX-5)+"px").css("top",(I.pageY-5)+"px").show();return true},header:function(){D.obj.header().remove();D.obj.sheetAdder().remove();D.obj.tabContainer().remove();var W=m.createElement("div"),Q=m.createElement("table"),T=m.createElement("tr"),Z,R,aa=m.createElement("td"),ab,S,P,X,I;W.appendChild(Q);Q.appendChild(T);W.className=D.cl.header+" "+D.theme.control;D.controls.header=d(W);if(H.title){if(d.isFunction(H.title)){H.title=D.title(D,E)}aa.className=D.cl.title;D.controls.title=d(aa).html(H.title)}else{d(aa).hide()}T.appendChild(aa);function Y(ad){if(d.isFunction(ad)){ad=d(ad.call(D))}else{ad=d(ad)}if(ad.is("ul")){ad.find("ul").hide().addClass(D.theme.menuUl);ad.find("li").addClass(D.theme.menuLi).hover(function(){d(this).find("ul:first").hide().show()},function(){d(this).find("ul:first").hide()})}return ad}if(D.isSheetEditable()){if(H.menuLeft){S=m.createElement("td");S.className=D.cl.menu+" "+D.cl.menuFixed+" "+D.theme.menuFixed;T.insertBefore(S,aa);D.controls.menuLeft[D.i]=d(S).append(Y(H.menuLeft)).children().addClass(D.theme.menuFixed);D.controls.menuLeft[D.i].find("img").load(function(){D.sheetSyncSize()})}if(H.menuRight){P=m.createElement("td");P.className=D.cl.menu+" "+D.cl.menuFixed;T.appendChild(P);D.controls.menuRight[D.i]=d(P).append(Y(H.menuRight)).children().addClass(D.theme.menuFixed);D.controls.menuRight[D.i].find("img").load(function(){D.sheetSyncSize()})}ab=m.createElement("td");ab.className=D.cl.label+" "+D.theme.control;D.controls.label=d(ab);X=m.createElement("textarea");X.className=D.cl.formula+" "+D.theme.controlTextBox;X.onkeydown=D.evt.formula.keydown;X.onkeyup=function(){D.obj.inPlaceEdit().value=this.value};X.onchange=function(){D.obj.inPlaceEdit().value=this.value};X.onpaste=D.evt.pasteOverCells;X.onfocus=function(){D.setNav(false)};X.onfocusout=function(){D.setNav(true)};X.onblur=function(){D.setNav(true)};D.controls.formula=d(X);var V=m.createElement("span");V.appendChild(X);Z=m.createElement("table");R=m.createElement("tr");Z.appendChild(R);W.appendChild(Z);I=m.createElement("td");I.className=D.cl.formulaParent;I.appendChild(V);R.appendChild(ab);R.appendChild(I);R.appendChild(m.createElement("td"));D.resizableSheet(d(V),{minHeight:D.controls.formula.height(),maxHeight:78,handles:"s",resize:function(ae,ad){D.controls.formula.height(ad.size.height)},stop:function(){D.sheetSyncSize()}});var ac=d.sheet.instance;for(var U=0;U<ac.length;U++){(ac||{}).nav=false}D.setNav(true);d(m).keydown(D.evt.document.keydown)}return W},ui:function(){var I=m.createElement("div");I.setAttribute("class",D.cl.ui);D.obj.ui=I;return I},sheetAdder:function(){var I=m.createElement("span");if(D.isSheetEditable()){I.setAttribute("class",D.cl.sheetAdder+" "+D.cl.tab+" "+D.theme.tab);I.setAttribute("title",D.msg.addSheet);I.innerHTML="+";I.onmousedown=function(){D.addSheet();return false};I.i=-1}return D.controls.sheetAdder=d(I)},tabContainer:function(){var I=m.createElement("span"),P;I.setAttribute("class",D.cl.tabContainer);I.onmousedown=function(R){R=R||f.event;var Q=(R.target||R.srcElement).i;if(Q>=0){D.trigger("sheetSwitch",[Q])}return false};I.ondblclick=function(R){R=R||f.event;var Q=(R.target||R.srcElement).i;if(Q>=0){D.trigger("sheetRename",[Q])}return false};if(D.isSheetEditable()&&d.fn.sortable){return D.controls.tabContainer=d(I).sortable({placeholder:"ui-state-highlight",axis:"x",forceHelperSize:true,forcePlaceholderSize:true,opacity:0.6,start:function(R,Q){P=Q.item.index();D.trigger("sheetTabSortStart",[R,Q])},update:function(R,Q){D.trigger("sheetTabSortUpdate",[R,Q,P])}})}return D.controls.tabContainer=d(I)},sheetUI:function(Y,Z,S){D.i=S;D.tuneTableForSheetUse(Z);D.readOnly[S]=(Z.className||"").match(/\breadonly\b/i)!=null;var U=Z.tBody.children.length>0,T=D.controlFactory.enclosure(Z),R=D.s,P=R.hiddenRows[S],X=R.hiddenColumns[S],Q=T.pane,I=d(Q),V=function(ad){ad=ad||f.event;if(D.isBusy()){return false}if(D.isBar(ad.target)){var ab=ad.target.entity,ac=D.getBarIndex[ab](ad.target);if(ac<0){return false}if(D.evt.barInteraction.first==D.evt.barInteraction.last){D.controlFactory.barMenu[ab](ad,ac)}}else{D.controlFactory.tdMenu(ad)}return false};Y.appendChild(T);D.controlFactory.barTop(Z);D.controlFactory.barLeft(Z);Q.appendChild(Z);if(D.isSheetEditable()){D.controlFactory.autoFiller(Q)}if(D.isSheetEditable()){var W=D.obj.formula(),aa="";I.mousedown(function(ab){D.setNav(true);if(D.isBusy()){return false}if(D.isCell(ab.target)){if(ab.button==2){V.call(this,ab);D.evt.cellOnMouseDown(ab);return true}D.evt.cellOnMouseDown(ab);return false}if(D.isBar(ab.target)){if(ab.button==2){V.call(this,ab)}aa=ab.target.entity;D.evt.barInteraction.select(ab.target);return false}return true});Q.onmouseup=function(){aa=""};Q.onmouseover=function(af){af=af||f.event;var ae=af.target||af.srcElement;if(D.isBusy()){return false}if(!D.isBar(ae)){return false}var ad=d(ae),ab=ae.entity,ac=D.getBarIndex[ab](ae);if(ac<0){return false}if(D.evt.barInteraction.selecting&&ab==aa){D.evt.barInteraction.last=ac;D.cellSetActiveBar(ab,D.evt.barInteraction.first,D.evt.barInteraction.last)}else{D.resizeBar[ab](ad,ac,Q,Z);if(D.isSheetEditable()){D.controlFactory.barHandleFreeze[ab](Q);if(ab=="top"){D.controlFactory.barMenu[ab](af,ac,ad)}}}return true};Q.ondblclick=D.evt.cellOnDblClick;I.bind("contextmenu",V).disableSelectionSpecial().bind("cellEdit",D.evt.cellEdit)}D.createSpreadsheet(Z,S);if(R.loader!==null){P=R.loader.hiddenRows(S);X=R.loader.hiddenColumns(S)}else{if(P===G||P.length<1){P=Z.getAttribute("data-hiddenrows");if(P!==null){P=c.toNumbers(P.split(","))}}if(X===G||X.length<1){X=Z.getAttribute("data-hiddencolumns");if(X!==null){X=c.toNumbers(X.split(","))}}}if(R.hiddenRows[S]===G){R.hiddenRows[S]=[]}if(R.hiddenColumns[S]===G){R.hiddenColumns[S]=[]}T.actionUI.hide(P,X);R.hiddenRows[S]=P;R.hiddenColumns[S]=X;D.checkMinSize(Z);D.controlFactory.tab();D.setChanged(true)},enclosure:function(ac){var X=m.createElement("div"),T=d(X),I=new l.ActionUI(X,ac,D.cl.scroll,D.s.frozenAt[D.i],d.sheet.max),ab=I.scrollUI,Q=I.pane,aa=ac.tBody,ad=aa.children,S=ac.colGroup.children,W,V=0,Y=0,R,P,Z,U;ac.size=function(){return D.tableSize(ac)};Q.size=function(){return D.sheetSize(ac)};Q.scrollToX=function(){if(U){return}Z=false;R=ab.scrollLeft;if(V!==R){V=R;Z=I.scrollToPixelX(R)}};Q.scrollToY=function(){U=false;P=ab.scrollTop;if(Y!==P){U=I.scrollToPixelY(P,Y>P);Y=P}};Q.updateX=function(){if(U){return}if(Z){D.calcVisibleCol(I)}};Q.updateY=function(){if(U){D.calcVisibleRow(I);D.updateYBarWidthToCorner(I)}};Q.finishScroll=function(){if(Z||U){D.obj.barHelper().remove();D.autoFillerGoToTd();if(Q.inPlaceEdit){Q.inPlaceEdit.goToTd()}}};W=[Q.updateY,Q.scrollToY,Q.updateX,Q.scrollToX,Q.finishScroll];ab.onscroll=function(){this.scrollTop=0;this.scrollLeft=0;ab.onscroll=function(){if(D.isBusy()){return}z(W)}};ab.onmousedown=function(){D.obj.barHelper().remove()};X.actionUI=Q.actionUI=I;X.scrollUI=Q.scrollUI=ab;X.appendChild(ab);ab.scrollTop=0;ab.scrollLeft=0;Q.setAttribute("class",D.cl.pane+" "+D.theme.pane);X.appendChild(Q);X.setAttribute("class",D.cl.enclosure);X.pane=Q;X.table=ac;Q.table=ac;Q.enclosure=X;Q.$enclosure=T;ac.pane=Q;ac.enclosure=X;ac.$enclosure=T;D.controls.pane[D.i]=Q;D.controls.panes=D.obj.panes().add(Q);D.controls.enclosure[D.i]=T;D.controls.enclosures=D.obj.enclosures().add(X);return X},tab:function(){var I=m.createElement("span"),P=D.controls.tab[D.i]=d(I).appendTo(D.obj.tabContainer());I.setAttribute("class",D.cl.tab+" "+D.theme.tab);D.sheetTab(true,function(Q){I.innerHTML=Q});I.i=D.i;D.controls.tabs=D.obj.tabs().add(P);return I},customTab:function(Q){var I=m.createElement("span"),P=d(I).appendTo(D.obj.tabContainer());I.setAttribute("class",D.cl.tab+" "+D.theme.tab);I.innerHTML=Q;return P},inPlaceEdit:function(U,P){U=U||D.obj.tdActive();if(U===null){U=D.rowTds(null,1)[1];D.cellEdit(U)}if(U===null){return}(D.obj.inPlaceEdit().destroy||C)();var T=D.obj.formula(),Q=T.val(),I,S,R=D.obj.pane();if(!U.isHighlighted){return}I=m.createElement("textarea");S=d(I);R.inPlaceEdit=I;I.i=D.i;I.className=D.cl.inPlaceEdit+" "+D.theme.inPlaceEdit;I.td=U;I.goToTd=function(){this.offset=d(U).position();if(!this.offset.left&&!this.offset.right){d(I).hide()}else{this.setAttribute("style","left:"+(this.offset.left-1)+"px;top:"+(this.offset.top-1)+"px;width:"+this.td.clientWidth+"px;height:"+this.td.clientHeight+"px;min-width:"+this.td.clientWidth+"px;min-height:"+this.td.clientHeight+"px;")}};I.goToTd();I.onkeydown=D.evt.inPlaceEdit.keydown;I.onchange=I.onkeyup=function(){T[0].value=I.value};I.onfocus=function(){D.setNav(false)};I.onblur=I.onfocusout=function(){D.setNav(true)};I.onpaste=D.evt.pasteOverCells;I.destroy=function(){R.inPlaceEdit=null;D.cellLast.isEdit=(I.value!=Q);I.parentNode.removeChild(I);D.controls.inPlaceEdit[I.i]=false};R.appendChild(I);I.onfocus();D.controls.inPlaceEdit[D.i]=I;S.focus().val("").val(T[0].value);if(P){S.select()}if(d.fn.elastic){d(I).elastic()}},autoFiller:function(R){if(!H.autoFiller){return false}var P=m.createElement("div"),I=m.createElement("div"),Q=m.createElement("div");P.i=D.i;P.className=D.cl.autoFiller+" "+D.theme.autoFiller;I.className=D.cl.autoFillerHandle;Q.className=D.cl.autoFillerCover;P.onmousedown=function(){var T=D.obj.tdActive();if(T){var S=D.getTdLocation(T);D.cellSetActive(T,S,true,D.autoFillerNotGroup,function(){var V=D.highlighted(),U=D.getTdLocation(V.last());D.fillUpOrDown(U.row<S.row||U.col<S.col);D.autoFillerGoToTd(T);D.autoFillerNotGroup=false})}return false};R.autoFiller=D.controls.autoFiller[D.i]=d(P);R.appendChild(P);return true}},autoFillerNotGroup:true,tsv:new TSV(),updateCellsAfterPasteToFormula:function(X){var W=0,V=D.obj.formula(),Z=new a();X=X||V.val();var U={row:D.cellLast.row,col:D.cellLast.col},P=V.val(),R=P;if((U.row==0&&U.col==0)||P.length===0){return false}var aa=D.tsv.parse(P);if(!d.isArray(aa)){V.val(aa);D.fillUpOrDown(false,aa);return true}for(var T=0;T<aa.length;T++){D.cellLast.isEdit=true;var I=aa[T];for(var S=0;S<I.length;S++){W++;var Q=D.getTd(-1,T+U.row,S+U.col);if(Q===null){continue}Q.row=U.row;Q.col=U.col;if(Q.length){if(!D.spreadsheets[D.i]||!D.spreadsheets[D.i][T+U.row]||!D.spreadsheets[D.i][T+U.row][S+U.col]){continue}var Y=D.spreadsheets[D.i][T+U.row][S+U.col];if(Y){H.parent.one("sheetPreCalculation",function(){if((I[S]+"").charAt(0)=="="){Y.formula=I[S].substring(1);Y.value="";Q.setAttribute("data-formula",I[S])}else{Y.formula="";Y.value=I[S];Q.removeData("formula")}});D.resolveCell(Y);if(T==0&&S==0){R=I[S]}}}}}if(P!=R){V.val(R)}D.fillUpOrDown(false,R);D.evt.cellEditDone(true);return true},evt:{inPlaceEdit:{enter:function(I){if(I.shiftKey){return true}return D.evt.cellSetActiveFromKeyCode(I,true)},tab:function(I){if(I.shiftKey){return true}return D.evt.cellSetActiveFromKeyCode(I,true)},keydown:function(I){I=I||f.event;D.trigger("sheetFormulaKeydown",[true]);switch(I.keyCode){case s.ENTER:return D.evt.inPlaceEdit.enter(I);break;case s.TAB:return D.evt.inPlaceEdit.tab(I);break;case s.ESCAPE:D.evt.cellEditAbandon();return false;break}}},formula:{keydown:function(I){I=I||f.event;if(D.readOnly[D.i]){return false}if(D.cellLast.row<0||D.cellLast.col<0){return false}D.trigger("sheetFormulaKeydown",[false]);switch(I.keyCode){case s.C:if(I.ctrlKey){return D.evt.document.copy(I)}case s.X:if(I.ctrlKey){return D.evt.document.cut(I)}case s.Y:if(I.ctrlKey){D.evt.document.redo(I);return false}break;case s.Z:if(I.ctrlKey){D.evt.document.undo(I);return false}break;case s.ESCAPE:D.evt.cellEditAbandon();return true;break;case s.ENTER:D.evt.cellSetActiveFromKeyCode(I,true);return false;break;case s.UNKNOWN:return false}D.cellLast.isEdit=true},If:function(P,I){if(P){d(D.obj.tdActive()).dblclick();return true}return false}},document:{enter:function(I){if(!D.cellLast.isEdit&&!I.ctrlKey){d(D.obj.tdActive()).dblclick()}return false},tab:function(I){D.evt.cellSetActiveFromKeyCode(I)},findCell:function(I){if(I.ctrlKey){D.cellFind();return false}return true},redo:function(I){if(I.ctrlKey&&!D.cellLast.isEdit){D.undo.manager.redo();return false}return true},undo:function(I){if(I.ctrlKey&&!D.cellLast.isEdit){D.undo.manager.undo();return false}return true},copy:function(S,P){var R=D.highlighted(true),T=D.obj.formula(),Q=T.val(),I=D.toTsv(R,P);T.val(I).focus().select();O.one("keyup",function(){if(P){T.val("")}else{T.val(Q)}});return true},cut:function(I){return this.copy(I,true)},pageUpDown:function(I){var R=D.sheetSize(),V=D.obj.pane(),Q=V.clientHeight,S=0,T=0,U,P;if(I){for(P=D.cellLast.row;P>0&&S<Q;P--){U=D.getTd(-1,P,1);if(U!==null&&!U.getAttribute("data-hidden")&&d(U).is(":hidden")){d(U).show()}S+=U.parentNode.clientHeight}}else{for(P=D.cellLast.row;P<R.rows&&S<Q;P++){U=D.getTd(-1,P,1);if(U===null){continue}S+=U.parentNode.clientHeight}}D.cellEdit(U);return false},keydown:function(I){I=I||f.event;if(D.readOnly[D.i]){return false}if(D.cellLast.row<0||D.cellLast.col<0){return false}var P=D.cellLast.td;if(D.nav){switch(I.keyCode){case s.DELETE:D.toTsv(null,true);D.obj.formula().val("");break;case s.TAB:D.evt.document.tab(I);break;case s.ENTER:D.evt.cellSetActiveFromKeyCode(I);break;case s.LEFT:case s.UP:case s.RIGHT:case s.DOWN:(I.shiftKey?D.evt.cellSetHighlightFromKeyCode(I):D.evt.cellSetActiveFromKeyCode(I));break;case s.PAGE_UP:D.evt.document.pageUpDown(true);break;case s.PAGE_DOWN:D.evt.document.pageUpDown();break;case s.HOME:case s.END:D.evt.cellSetActiveFromKeyCode(I);break;case s.V:if(I.ctrlKey){return D.evt.formula.If(!D.evt.pasteOverCells(I),I)}else{d(P).trigger("cellEdit");return true}break;case s.Y:if(I.ctrlKey){D.evt.document.redo(I);return false}else{d(P).trigger("cellEdit");return true}break;case s.Z:if(I.ctrlKey){D.evt.document.undo(I);return false}else{d(P).trigger("cellEdit");return true}break;case s.ESCAPE:D.evt.cellEditAbandon();break;case s.F:if(I.ctrlKey){return D.evt.formula.If(D.evt.document.findCell(I),I)}else{d(P).trigger("cellEdit");return true}break;case s.CAPS_LOCK:case s.SHIFT:case s.ALT:break;case s.CONTROL:D.obj.formula().focus().select();return true;break;default:if(D.obj.inPlaceEdit().td!==P){d(P).trigger("cellEdit")}return true;break}return false}}},pasteOverCells:function(P){P=P||f.event;if(P.ctrlKey||P.type=="paste"){var I=function(){D.updateCellsAfterPasteToFormula()};var Q=O.one("keyup",function(){I();I=function(){};Q.mouseup()}).one("mouseup",function(){I();I=function(){};Q.keyup()});D.setDirty(true);D.setChanged(true);return true}return false},cellEditDone:function(I){var P=D.obj.inPlaceEdit(),Q=d(P).is(":focus");(D.obj.inPlaceEdit().destroy||C)();if(D.cellLast.isEdit||I){var T=(Q?d(P):D.obj.formula()),R=D.obj.tdActive();if(D.isFormulaEditable(R)){if(R&&D.cellLast.row>0&&D.cellLast.col>0){var W=T.val(),X=R.jSCell,S=0,V=H.loader,U;if(!X.edited){X.edited=true;D.obj.cellsEdited().push(X)}H.parent.one("sheetPreCalculation",function(){X.parsedFormula=null;if(W.charAt(0)=="="){R.setAttribute("data-formula",W);X.formula=W}else{R.removeAttribute("data-formula");X.value=W;X.formula="";if((U=X.loadedFrom)!==G){V.setCellAttributes(U,{cache:G,formula:"",value:W})}}X.setNeedsUpdated()});D.resolveCell(X);D.cellLast.isEdit=false;D.trigger("sheetCellEdited",[X])}}}},cellEditAbandon:function(I){(D.obj.inPlaceEdit().destroy||C)();D.highlighter.clearBar().clear();if(!I){D.calc()}D.cellLast.td=null;D.cellLast.row=0;D.cellLast.col=0;D.rowLast=0;D.colLast=0;D.highlighter.start={row:0,col:0};D.highlighter.end={row:0,col:0};D.labelUpdate("",true);D.obj.formula().val("").blur();D.autoFillerHide();return false},cellSetHighlightFromKeyCode:function(S){var R=D.highlightedLastOrdered(),Q=D.sheetSize(),V=D.obj.tdActive(),T=D.getTdLocation(V),U=R.start,I=R.end,P=D.highlighter;switch(S.keyCode){case s.UP:if(U.row<T.row){U.row--;U.row=x.max(U.row,1);break}I.row--;I.row=x.max(I.row,1);break;case s.DOWN:if(U.row===U.end){U.row++;U.row=x.min(U.row,Q.rows);break}if(U.row<T.row){U.row++;U.row=x.max(U.row,1);break}I.row++;I.row=x.min(I.row,Q.rows);break;case s.LEFT:if(U.col<T.col){U.col--;U.col=x.max(U.col,1);break}I.col--;I.col=x.max(I.col,1);break;case s.RIGHT:if(U.col<T.col){U.col++;U.col=x.min(U.col,Q.cols);break}I.col++;I.col=x.min(I.col,Q.cols);break}D.highlighter.start=U;D.highlighter.end=I;D.cycleCellArea(function(W){P.set(W.td)},U,I);return false},cellSetActiveFromKeyCode:function(S,I){var T={row:D.cellLast.row,col:D.cellLast.col},R=false,Q,P=false;switch(S.keyCode){case s.UP:T.row--;break;case s.DOWN:T.row++;break;case s.LEFT:T.col--;break;case s.RIGHT:T.col++;break;case s.ENTER:T=D.evt.incrementAndStayInGrid(D.highlightedLastOrdered(),T,"row","col",S.shiftKey);R=true;Q=D.highlighted();if(Q.length>1){P=true}else{if(!I){T.row+=(S.shiftKey?-1:1)}if(H.autoAddCells&&T.row>D.sheetSize().rows){D.controlFactory.addRow()}}break;case s.TAB:T=D.evt.incrementAndStayInGrid(D.highlightedLastOrdered(),T,"col","row",S.shiftKey);R=true;Q=D.highlighted();if(Q.length>1){P=true}else{if(!I){T.col+=(S.shiftKey?-1:1)}if(H.autoAddCells&&T.col>D.sheetSize().cols){D.controlFactory.addColumn()}}break;case s.HOME:T.col=1;break;case s.END:T.col=D.obj.tdActive().parentNode.children.length-2;break}T.col=T.col||1;T.row=T.row||1;if(!D.cellLast.isEdit||R){var U=D.getTd(-1,T.row,T.col);if(U!==null){D.cellEdit(U,null,P);return false}}return true},incrementAndStayInGrid:function(R,S,P,I,Q){if(Q){S[P]--;if(S[P]<R.start[P]){S[P]=R.end[P];S[I]--}if(S[I]<R.start[I]){S[I]=R.end[I]}}else{S[P]++;if(S[P]>R.end[P]){S[P]=R.start[P];S[I]++}if(S[I]>R.end[I]){S[I]=R.start[I]}}return S},cellOnMouseDown:function(I){D.obj.formula().blur();if(I.shiftKey){D.getTdRange(I,D.obj.formula().val())}else{D.cellEdit(I.target,true)}},cellOnDblClick:function(I){if(D.isBusy()){return false}D.controlFactory.inPlaceEdit();return true},cellEdit:function(I){if(D.isBusy()){return false}D.controlFactory.inPlaceEdit(null,true);return true},barInteraction:{first:0,last:0,selecting:false,select:function(Q){if(!Q){return}if(!Q.type=="bar"){return}var I=Q.entity,P=D.getBarIndex[I](Q);if(P<0){return false}D[I+"Last"]=P;D.evt.barInteraction.last=D.evt.barInteraction.first=P;D.cellSetActiveBar(I,D.evt.barInteraction.first,D.evt.barInteraction.last);D.evt.barInteraction.first=D.evt.barInteraction.last=D[I+"Last"]=P;D.evt.barInteraction.selecting=true;O.one("mouseup",function(){D.evt.barInteraction.selecting=false});return false}}},refreshColumnLabels:function(T){T=T||0;var P=D.obj.barMenuParentTop();if((P)&&(P.length)){var S=P.get(0);if(d.isFunction(S.destroy)){S.destroy()}}var I=D.controls.bar.x.th[D.i],R;if(!I){return}for(var Q=g.max(T,0);Q<I.length;Q++){if(Q>0){R=I[Q];R.innerHTML=R.label=h.columnLabelString(R.cellIndex)}}},refreshRowLabels:function(S,I){S=S||0;var P=D.controls.bar.y.th[D.i],R;if(!P){return}I=I||P.length;for(var Q=S;Q<I;Q++){if(Q>0){R=P[Q];R.innerHTML=R.label=R.parentNode.rowIndex}}},isCell:function(I){if(I&&I.jSCell!==G){return true}return false},isBar:function(I){if(I&&I.tagName&&I.tagName=="TH"&&I.type&&I.type=="bar"){return true}return false},readOnly:[],isSheetEditable:function(I){I=I||D.i;return(H.editable==true&&!D.readOnly[I])},isFormulaEditable:function(I){if(H.lockFormulas){if(I.data("formula")!==G){return false}}return true},toggleFullScreen:function(){if(!D){return}D.evt.cellEditDone();var Q=D.obj.fullScreen(),T=D.obj.pane();if(Q.is(":visible")){J.unbind("jSResize");M.removeClass("bodyNoScroll");H.parent=Q[0].origParent;H.parent.prepend(Q.children());Q.remove();D.sheetSyncSize();if(T.inPlaceEdit){T.inPlaceEdit.goToTd()}D.trigger("sheetFullScreen",[false])}else{M.addClass("bodyNoScroll");var R=d(H.parent),Q=m.createElement("div"),P=d._data(H.parent[0],"events");Q.className=D.cl.fullScreen+" "+D.theme.fullScreen+" "+D.cl.parent;Q.origParent=R;H.parent=D.controls.fullScreen=d(Q).append(R.children()).appendTo(M);J.bind("resize",function(){J.trigger("jSResize")}).bind("jSResize",function(){this.w=J.width();this.h=J.height();H.parent.width(this.w).height(this.h);D.sheetSyncSize();if(T.inPlaceEdit){T.inPlaceEdit.goToTd()}}).trigger("jSResize");R.trigger("sheetFullScreen",[true]);for(var S in P){for(var I=0;I<P[S].length;I++){H.parent.bind(S,P[S][I].handler)}}}},renameSheet:function(I){if(L(I)){return false}if(I>-1){D.sheetTab()}return true},switchSheet:function(I){if(L(I)){return false}if(I==-1){D.addSheet()}else{if(I!=D.i){D.setActiveSheet(I);if(H.loader===null){D.calc(I)}}}return true},tuneTableForSheetUse:function(Q){var P=d(Q);D.controls.table[D.i]=P.addClass(D.cl.table).addClass(D.theme.table).attr("id",D.id+D.i).attr("border","1px").attr("cellpadding","0").attr("cellspacing","0");Q.spreadsheetIndex=D.i;D.formatTable(Q);D.sheetDecorateRemove(false,P);D.controls.tables=D.obj.tables().add(Q);var R=P.attr("data-frozenatrow")*1,I=P.attr("data-frozenatcol")*1;if(!D.s.frozenAt[D.i]){D.s.frozenAt[D.i]={row:0,col:0}}if(R){D.s.frozenAt[D.i].row=R}if(I){D.s.frozenAt[D.i].col=I}},createSpreadsheet:function(P,I){this.createSpreadsheetForArea(P,I)},createSpreadsheetForArea:function(am,ak,ab,ai,af,R){var ae,W=am.tBody,an,ad=(H.loader!==null?H.loader:null),T=H.colMargin+"px",al=(ad!==null?ad.setRowHeight:function(ap,au,at){var ar,aq,ao=T;if((ar=at.nextSibling)===G){return ao}if((aq=ar.style)===G){return ao}if(aq.height!==G){ao=aq.height}at.style.height=ao}),ah=am.pane,ag=W.children,I,Z=ah.actionUI,U=Z.yDetacher,V,X,S,Q,ac,P,Y,aj,aa;if(ab===G&&af===G){am.spreadsheet=D.spreadsheets[ak]=[]}V=am.spreadsheet;ab=ab||0;ai=(ai===G&&H.loader===null?ag.length-1:ai||1);af=af||0;R=(R===G&&H.loader===null?ag[0].children.length-1:R||1);ae=ab;for(;ae<=ai;ae++){X=V[ae];an=af;if(X===G){if(y){P=(V.length>0?V.length-1:0);ac=ae-P;D.controlFactory.addCells(P,false,(ac>0?ac:1),"row-init");X=V[ae]}else{X=V[ae]=[]}}an=af;for(;an<=R;an++){if(ae>0&&an>0){Q=X[an];if(Q===G){if(y){Y=(X.length>0?X.length-1:0);ac=an-Y;D.controlFactory.addCells(X.length-1,false,ac>0?ac:1,"col-init");Q=X[an]}else{D.createCell(ak,ae,an);Q=X[an];Q.needsUpdated=true;Q.updateValue()}}else{Q.updateValue()}}else{I=ag[ae];aa=(I!==G&&I.children.length>an?I.children[an]:null);if(aa!==null){if(an==0&&ae>0){aa.type="bar";aa.entity="left";aa.innerHTML=ae;aa.className=D.cl.barLeft+" "+D.cl.barLeft+"_"+D.i+" "+D.theme.bar;if(al!==G){al.call(ad,ak,ae,aa)}}if(ae==0&&an>0){aa.type="bar";aa.entity="top";aa.innerHTML=h.columnLabelString(an);aa.className=D.cl.barTop+" "+D.cl.barTop+"_"+D.i+" "+D.theme.bar}if(ae==0&&an==0){aa.type="bar";aa.entity="corner";aa.className=D.theme.bar+" "+D.cl.barCorner;D.controls.bar.corner[D.i]=aa}}}}}},updateYBarWidthToCorner:function(I){var U=I.scrolledArea,Z=I.table,W=Z.tBody,X=Z.corner,T=g.min(H.initCalcRows+U.row,U.row+20,W.lastChild.rowIndex),V=W.children[T],Q,Y,S,P=20,R=X.col;if(V===G){return}Q=V.children[0];if(Q.label===G){return}Y=Q.label+"";S=f.defaultCharSize.width*Y.length;S=(S>P?S:P);if(S!==R._width||R._width===G){R._width=S;R.style.width=(S)+"px"}},toggleHideRow:function(I){I=I||D.rowLast;if(!I){return}var P=D.obj.pane().actionUI;P.toggleHideRow(I);D.autoFillerGoToTd()},toggleHideRowRange:function(Q,P){var I=D.obj.pane().actionUI;I.toggleHideRowRange(Q,P);D.autoFillerGoToTd()},toggleHideColumn:function(I){I=I||D.colLast;if(!I){return}var P=D.obj.pane().actionUI;P.toggleHideColumn(I);D.autoFillerGoToTd()},toggleHideColumnRange:function(Q,P){var I=D.obj.pane().actionUI;I.toggleHideColumnRange(Q,P);D.autoFillerGoToTd()},rowShowAll:function(){D.obj.pane().actionUI.rowShowAll()},columnShowAll:function(){D.obj.pane().actionUI.columnShowAll()},merge:function(U){U=U||D.highlighted();if(!U.length){return}var S=[],I=U[0],R=U[U.length-1],Z=D.getTdLocation(I),P=D.getTdLocation(R),ab={},X={},W=0,Y=0,T=U.length-1,aa,ac,Q,V;if(Z.row){D.setDirty(true);D.setChanged(true);if(Z.row<P.row){ab.row=Z.row;X.row=P.row;Q=I}else{ab.row=P.row;X.row=Z.row;Q=R}if(Q.getAttribute("rowSpan")||Q.getAttribute("colSpan")){return false}if(Z.col<P.col){ab.col=Z.col;X.col=P.col}else{ab.col=P.col;X.col=Z.col}Y=(X.row-ab.row)+1;W=(X.col-ab.col)+1;V=D.getTdLocation(Q);do{ac=U[T];aa=ac.jSCell;if(aa.formula||aa.value){S.unshift(aa.formula?"("+aa.formula.substring(1)+")":aa.value)}H.parent.one("sheetPreCalculation",function(){if(ac.cellIndex!=V.col||ac.parentNode.rowIndex!=V.row){aa.formula=null;aa.value="";aa.defer=Q.jSCell;ac.removeAttribute("data-formula");ac.removeAttribute("data-celltype");ac.innerHTML="";ac.style.display="none";ac.colSpan=W-(ac.cellIndex-Q.cellIndex);ac.rowSpan=Y-(ac.parentNode.rowIndex-Q.parentNode.rowIndex)}});D.resolveCell(aa)}while(T--);Q.jSCell.value=S.join(" ");Q.jSCell.formula=(Q.jSCell.formula?S.join(" "):"");Q.style.display="";Q.setAttribute("rowSpan",Y);Q.setAttribute("colSpan",W);D.resolveCell(Q.jSCell);D.evt.cellEditDone();D.autoFillerGoToTd(Q);D.cellSetActive(Q,V)}return true},unmerge:function(P){P=P||D.highlighted();if(!P){return}var T=D.getTdLocation(P),U=new a(),W=x.max(P.getAttribute("rowSpan")*1,1)-1,I=x.max(P.getAttribute("colSpan")*1,1)-1,S=W+T.row,Q,V,R=[];if(W==0&&I==0){return false}do{Q=T.col+I;do{V=D.getTd(-1,S,Q);if(V===null){continue}V.style.display="";V.removeAttribute("colSpan");V.removeAttribute("rowSpan");V.jSCell.defer=null;D.resolveCell(V.jSCell,U);R.push(V)}while(Q-->T.col)}while(S-->T.row);D.evt.cellEditDone();D.autoFillerGoToTd(P);D.cellSetActive(P,T);D.highlighter.set(R);return true},fillUpOrDown:function(V,W,Y){D.evt.cellEditDone();Y=Y||D.highlighted(true);if(Y.length<1){return false}var S=D.obj.tdActive();if(Y.length<1){return false}var T=D.getTdLocation(Y[0].td),Z=D.getTdLocation(Y[Y.length-1].td),I=D.getTdLocation(S),Q={row:0,col:0},P=W||S.jSCell.value,X=false,R=Y.length-1,U=function(){};W=W||S.jSCell.value;if(R>=0){if(W.charAt&&W.charAt(0)=="="){if(R>=0){do{if(!V){Q.row=I.row-Z.row;Q.col=I.col-Z.col}else{Q.row=I.row-T.row;Q.col=I.col-T.col}P=D.reparseFormula(W,Q);H.parent.one("sheetPreCalculation",function(){Y[R].formula=P;Y[R].value="";Y[R].td.setAttribute("data-formula",P)});D.resolveCell(Y[R])}while(R--);return true}}else{if((X=!L(P))||P.length>0){if(X&&P!=""){P*=1;if(V){P-=Y.length-1}U=function(){P++}}}do{H.parent.one("sheetPreCalculation",function(){Y[R].formula="";Y[R].value=P+"";Y[R].td.removeAttribute("data-formula")});D.resolveCell(Y[R]);U()}while(R--);return true}}return false},toTsv:function(Y,R,W){Y=Y||D.highlighted(true);if(Y.type){Y=[Y]}W=W||function(ab,aa){if(R){H.parent.one("sheetPreCalculation",function(){aa.formula="";aa.value=""});D.resolveCell(aa)}};var U=[],X,T,P={},Q=Y.length-1,Z,I;if(Q>=0){X=D.getTdLocation(Y[0].td);T=D.getTdLocation(Y[Y.length-1].td);P.row=x.min(X.row,T.row);P.col=x.min(X.col,T.col);do{var S=D.getTdLocation(Y[Q].td),V=(Y[Q].formula?"="+Y[Q].formula:Y[Q].value);Z=x.abs(S.row-P.row);I=x.abs(S.col-P.col);if(!U[Z]){U[Z]=[]}if((V+="").match(/\n/)){V='"'+V+'"'}U[Z][I]=(V||"");W.call(Y[Q].td,S,Y[Q])}while(Q-->0);Q=U.length-1;do{U[Q]=U[Q].join("\t")}while(Q-->0);return U.join("\n")}return""},offsetFormulas:function(U,T,Q,S){var P=D.sheetSize(),R={first:{row:1,col:1},last:{row:P.rows,col:P.cols}},I=[];D.cycleCells(function(){var V=this;if(this.formula&&typeof this.formula=="string"&&D.isFormulaEditable(this.td)){this.formula=D.reparseFormula(this.formula,T,U,Q,S);this.td.setAttribute("data-formula","="+this.formula)}I.push(function(){D.resolveCell(V,true)})},R.first,R.last);while(I.length){I.pop()()}D.evt.cellEditDone()},reparseFormula:function(S,R,Q,I,P){return S.replace(h.regEx.cell,function(U,V,Z,aa){if(V=="SHEET"){return U}R=R||{loc:0,row:0};var T={row:Z*1,col:h.columnLabelIndex(V)},Y,X,W={row:Z,col:V,use:false};if(Q){if(P){if(I){if(T.col&&T.col==Q.col-1){W.col="#REF!";W.use=true}if(T.row&&T.row==Q.row-1){W.row="#REF!";W.use=true}if(T.col>=Q.col){Y=true}if(T.row>=Q.row){X=true}}else{if(Q.col&&T.col==Q.col){W.col="#REF!";W.use=true}if(Q.row&&T.row==Q.row){W.row="#REF!";W.use=true}if(Q.col&&T.col>Q.col){Y=true}if(Q.row&&T.row>Q.row){X=true}}if(W.use){return W.col+W.row}if(Y){T.col+=R.col;return D.makeFormula(T)}if(X){T.row+=R.row;return D.makeFormula(T)}}else{if(I){if(Q.col&&T.col>=Q.col){Y=true}if(Q.row&&T.row>=Q.row){X=true}}else{if(Q.col&&T.col>Q.col){Y=true}if(Q.row&&T.row>Q.row){X=true}}if(Y){T.col+=R.col;return D.makeFormula(T)}if(X){T.row+=R.row;return D.makeFormula(T)}}}else{return D.makeFormula(T,R)}return U})},makeFormula:function(P,I){I=d.extend({row:0,col:0},I);P.col+=I.col;P.row+=I.row;if(P.col<0){P.col=0}if(P.row<0){P.row=0}return h.parseCellName(P.col,P.row)},cycleCells:function(S,V,Q,P){P=P||D.i;V=V||{row:1,col:1};if(!Q){var X=D.sheetSize();Q={row:X.rows,col:X.cols}}var I=D.spreadsheets[P],R=Q.row,U,W,T;if(R<V.row){return}do{U=Q.col;W=I[R];do{T=W[U];S.call(T,P,R,U)}while(U-->V.col)}while(R-->V.row)},cycleCellsAll:function(R){var S=D.i,Q,P,I;for(Q=0;Q<=D.sheetCount;Q++){D.i=Q;P=D.sheetSize();I={row:P.rows,col:P.cols};D.cycleCells(R,{row:0,col:0},I,Q)}D.i=S},cycleCellArea:function(W,aa,T,S,X){var I={start:{},end:{}},V,Z,ab,Y,R=D.i,P={cell:[],td:[]},U=D.spreadsheets[R],Q=(X?"unshift":"push");if(S){I.start=aa;I.end=T}else{I.start.row=x.max(x.min(aa.row,T.row),1);I.start.col=x.max(x.min(aa.col,T.col),1);I.end.row=x.max(aa.row,T.row,1);I.end.col=x.max(aa.col,T.col,1)}V=I.end.row;do{Z=I.end.col;ab=U[V]||null;do{if(ab){Y=ab[Z]||null;if(Y){P.cell[Q](Y);P.td[Q](Y.td)}}}while(Z-->I.start.col)}while(V-->I.start.row);if(W){W(P)}},formatTable:function(ab){var Z=H.newColumnWidth+"px",U=H.colMargin+"px",P=ab.children,S=P.length-1,R,Q,X,I,V,aa,T,Y=(H.loader!==null?H.loader:null),W=(Y!==null?Y.getWidth:function(ac,ad){return H.newColumnWidth});if(S>-1){do{switch(P[S].nodeName){case"TBODY":aa=true;X=P[S];break;case"COLGROUP":T=true;I=P[S];break}}while(S--)}else{}if(!X){X=m.createElement("tbody");if(P.length>0){do{X.appendChild(P[0])}while(P.length)}}if(!I||I.children.length<1){I=m.createElement("colgroup");ab.appendChild(I);ab.appendChild(X);if(X.children.length>0){V=X.children[0];for(S=0,R=g.min(V.children.length,H.initCalcCols);S<R;S++){Q=m.createElement("col");Q.style.width=W(D.i,S)+"px";I.appendChild(Q)}for(S=0,R=g.min(X.children.length,H.initCalcRows);S<R;S++){X.children[S].style.height=U}}}ab.tBody=X;ab.colGroup=I;ab.removeAttribute("width");ab.style.width=""},checkMinSize:function(S){var Q=D.tableSize(S),T=H.minSize.rows||0,I=H.minSize.cols||0,R=D.obj.pane().actionUI,P=R.frozenAt;T=g.max((P.row>T?P.row+1:T),1,H.initScrollRows);I=g.max((P.col>I?P.col+1:I),1,H.initScrollCols);if(Q.cols<I){I-=Q.cols;if(R.hiddenColumns.length>0){I+=c.indexOfNearestLessThan(R.hiddenColumns,I)+1}D.controlFactory.addColumnMulti(null,I,false,true,true)}Q=D.tableSize(S);if(Q.rows<T){T-=Q.rows;D.controlFactory.addRowMulti(null,T,false,true,true)}},theme:null,highlighter:null,resizable:function(P,I){if(!P.data("resizable")){P.resizable(I)}},busy:[],setBusy:function(I){if(I){D.busy.push(I)}else{D.busy.pop()}},isBusy:function(){return(D.busy.length>0)},draggable:function(P,I){if(!P.data("jSdraggable")){P.data("jSdraggable",true).draggable(I)}},nearest:function(P,I){return d(P).nearest(I)},resizeBar:{top:function(T,Q,V,P){D.obj.barTopControls().remove();var R=m.createElement("div"),U=d(R).addClass(D.cl.barController+" "+D.theme.barResizer).width(T.width()).prependTo(T),I,S;D.controls.bar.x.controls[D.i]=D.obj.barTopControls().add(U);D.resizableCells(U,{handles:"e",start:function(X,W){D.autoFillerHide();D.setBusy(true);I=D.col(P,Q);if(V.freezeHandleTop){V.freezeHandleTop.remove()}I.removeAttribute("width")},resize:function(X,W){I.style.width=W.size.width+"px";if(V.inPlaceEdit){V.inPlaceEdit.goToTd()}},stop:function(X,W){D.setBusy(false);if(V.inPlaceEdit){V.inPlaceEdit.goToTd()}D.followMe();D.setDirty(true)},minWidth:32});S=R.children[0];S.style.height=T.outerHeight()+"px";S.style.position="absolute"},left:function(R,U,Q,Y){D.obj.barLeftControls().remove();var T=R.offset(),Z=m.createElement("div"),W=d(Z).addClass(D.cl.barController+" "+D.theme.barResizer).prependTo(R).offset({top:T.top,left:T.left}),X=R[0],S=R.next()[0],aa=S.parentNode,P=m.createElement("div"),I=d(P).addClass(D.cl.barControllerChild).height(R.height()).prependTo(W),V;D.controls.bar.y.controls[D.i]=D.obj.barLeftControls().add(W);D.resizableCells(I,{handles:"s",start:function(){D.autoFillerHide();D.setBusy(true);if(Q.freezeHandleLeft){Q.freezeHandleLeft.remove()}aa.removeAttribute("height");X.removeAttribute("height");S.removeAttribute("height")},resize:function(ac,ab){Z.style.height=S.style.height=X.style.height=aa.style.height=ab.size.height+"px";if(Q.inPlaceEdit){Q.inPlaceEdit.goToTd()}},stop:function(ac,ab){D.setBusy(false);if(Q.inPlaceEdit){Q.inPlaceEdit.goToTd()}D.followMe();D.setDirty(true)},minHeight:15});V=P.children[0];V.style.width=R.outerWidth()+"px";V.style.position="absolute"},corner:function(){}},sheetDecorateRemove:function(P,I){I=I||D.obj.tables();I=(P?I.clone():I);I.find("td."+D.theme.tdActive).removeClass(D.theme.tdActive);I.find("td."+D.theme.tdHighlighted).removeClass(D.theme.tdHighlighted);return I},labelUpdate:function(P,I){if(!I){P=h.parseCellName(P.col,P.row);if(P){D.obj.label().text(P)}}else{D.obj.label().text(P)}},cellEdit:function(T,R,Q){D.autoFillerNotGroup=true;D.evt.cellEditDone();if(T===null){return}var S=D.getTdLocation(T),I=T.jSCell,P;if(I===G||I===null){return}if(I.uneditable){return}D.trigger("sheetCellEdit",[I]);if(T!==D.cellLast.td){D.followMe(T)}else{D.autoFillerGoToTd(T)}D.labelUpdate(S);if(I.formula.length>0){P="="+I.formula}else{P=I.value}D.obj.formula().val(P).blur();D.cellSetActive(T,S,R,false,null,Q)},cellSetActive:function(S,U,P,W,T,Q){U=U||D.getTdLocation(S);if(U.col!=G){D.cellLast.td=S;D.cellLast.row=D.rowLast=U.row;D.cellLast.col=D.colLast=U.col;if(!Q){D.highlighter.set(S).setStart(U).setEnd(U)}if(S===null){return}D.highlighter.setBar("left",S.parentNode.firstChild).setBar("top",S.parentNode.parentNode.children[0].children[S.cellIndex]);var V,X;switch(H.cellSelectModel){case l.excelSelectModel:case l.googleDriveSelectModel:V=function(){};X=function(){};break;case l.openOfficeSelectModel:V=function(Y){if(D.isCell(Y)){D.cellEdit(Y)}};X=function(){};break}if(P){var I={},R=D.obj.pane();I.last=U;R.onmousemove=function(ag){ag=ag||f.event;var ah=ag.target||ag.srcElement;if(D.isBusy()){return false}var Y=D.highlighter.end=D.getTdLocation(ah),ai=true,aj=D.highlighter;if(Y.col<1||Y.row<1||Y.col==B||Y.row==B){return false}if(W){ai=false;if(U.col==Y.col||U.row==Y.row){ai=true}}if((I.last.col!=Y.col||I.last.row!=Y.row)&&ai){V(ah);D.cycleCellArea(function(al){aj.set(al.td)},U,Y,false,true)}D.followMe(ah);var ab=ag.clientY,ac=ag.clientX,ad=R.$enclosure.offset(),ak=D.getTdLocation(ah),ae=ak.row,aa=ak.col,Z=false,af;if(L(ae)||L(aa)){return false}if(ab>ad.top){Z=true;ae--}if(ac>ad.left){Z=true;aa--}if(Z){if(ae<1||aa<1){return false}af=D.spreadsheets[D.i][ae][aa];D.followMe(af.td,true)}I.last=Y;return true};m.onmouseup=function(){R.onmousemove=null;R.onmousemove=null;R.onmouseup=null;m.onmouseup=null;if(T){T()}}}}},colLast:0,rowLast:0,cellLast:{td:[],row:0,col:0,isEdit:false},highlightedLastOrdered:function(){var P=this.highlighter,I={start:{},end:{}};I.start.row=g.min(P.start.row,P.end.row);I.start.col=g.min(P.start.col,P.end.col);I.end.row=g.max(P.start.row,P.end.row);I.end.col=g.max(P.start.col,P.end.col);return I},cellStyleToggle:function(U,T,R){R=R||D.highlighted();if(R.length<1){return false}D.setDirty(true);var V,S,Q=R.length-1,I=D.obj.cellsEdited(),P;if(Q>=0){P=R[0].className.match(U);do{V=R[Q];S=d(V);if(T){S.removeClass(T)}if(P){S.removeClass(U)}else{S.addClass(U)}if(!V.jSCell.edited){V.jSCell.edited=true;I.push(V.jSCell)}}while(Q--);return true}return false},cellTypeToggle:function(S,Q){Q=Q||D.highlighted(true);if(Q.length<1){return}var R=Q.length-1,P=Q[R].cellType==S,I;if(R>=0){do{I=Q[R];if(P){I.cellType=null}else{I.cellType=S}I.updateValue()}while(R--)}},fontReSize:function(T,S){S=S||D.highlighted();if(S.length<1){return false}var P=0;switch(T){case"up":P=1;break;case"down":P=-1;break}var V,U,R=S.length-1,Q,I=D.obj.cellsEdited();if(R>=0){do{V=S[R];U=d(V);Q=(U.css("font-size")+"").replace("px","")*1;U.css("font-size",((Q||10)+P)+"px");if(!V.jSCell.edited){V.jSCell.edited=true;I.push(V.jSCell)}}while(R--);return true}return false},cellHandler:null,calc:function(Q,S){Q=(Q===G?D.i:Q);if(D.readOnly[Q]||D.isChanged(Q)===false&&!S){return false}var P=H.loader,I;if(P!==null){P.cycleCells(Q,function(T,V,U){I=P.jitCell(T,V,U);I.updateValue()})}else{var R=D.spreadsheetToArray(null,Q);h.calc(Q,R);D.trigger("sheetCalculation",[{which:"spreadsheet",sheet:R,index:Q}])}D.setChanged(false);return true},calcAll:function(Q){var P=0,I;if(H.loader!==null){I=H.loader.count;for(;P<I;P++){D.calc(P,Q)}}else{I=D.spreadsheets.length;for(;P<I;P++){D.calc(P,Q)}}},calcVisiblePos:{row:-1,col:-1},calcVisibleInit:function(aa){aa=aa||D.i;var P=D.spreadsheetToArray(null,aa)||[],S=g.min,T=H.initCalcRows,I=H.initCalcCols,X=1,Q=S(P.length-1,T),ab,U,Z,W={row:-1,col:-1},V=[],Y=function(){this.cell.rowIndex=this.rowIndex;this.cell.columnIndex=this.columnIndex;this.cell.updateValue()},R=function(){V.length=0;D.trigger("sheetCalculation",[{which:"spreadsheet",sheet:P,index:aa}])};W.row=Q;for(;X<=Q;X++){if(X>0&&(ab=P[X])!==G){Z=W.col=S(ab.length-1,I);U=1;for(;U<=Z;U++){V.push({cell:ab[U],rowIndex:X,columnIndex:U})}}}z(V,{each:Y,done:R});this.calcVisiblePos=W;D.setChanged(false)},calcVisibleRow:function(I,W){W=W||D.i;var S=D.spreadsheets[W],U=H.initCalcRows,X=I.table,T=I.pane,V,R,P=this.calcVisiblePos,Q=function(){var Z=[],ab=T.size(),aa=X.size(),ad,ac,Y;if(aa.rows<U&&S.length<=ab.rows&&P.row<=(ab.rows+1)){ad=P.row;P.row++;V=1;R=P.col;for(;V<=R;V++){ac=S[ad];Y=ac!==G?ac[V]:G;Z.push({row:ac,cell:Y,rowIndex:ad,columnIndex:V})}z(Z,{each:function(){if(this.row===G||(this.row=S[this.rowIndex])===G){if(S[this.rowIndex]===G){D.createSpreadsheetForArea(I.table,W,this.rowIndex,this.rowIndex,this.columnIndex,this.columnIndex);this.row=S[this.rowIndex]}}else{if((this.cell=this.row[this.columnIndex])===G){D.createCell(D.i,this.rowIndex,this.columnIndex);this.cell=this.row[this.columnIndex]}}},done:function(){Q()}})}};P.row=P.row>=0?P.row:U;Q();D.setChanged(false)},calcVisibleCol:function(I,ad){ad=ad||D.i;var T=D.spreadsheetToArray(null,ad)||[],Q=I.scrolledArea,P=I.pane.size(),W=H.initCalcRows,R=H.initCalcCols,S=g.max((Q.row+W)-1,I.foldArea.row),V=g.max((Q.col+R)-1,I.foldArea.col),Z,ae,ac,ab,U=this.calcVisiblePos,X={row:U.row,col:U.col},Y=[],aa=function(){if(this.row===G||this.cell===G){D.createSpreadsheetForArea(I.table,ad,this.rowIndex,this.rowIndex,this.colIndex,this.colIndex);this.row=T[this.rowIndex]}if(this.row===G){return}ab=this.row[this.colIndex];if(ab===G){return}ab.updateValue()};S=S<P.rows?S:P.rows;V=V<P.cols?V:P.cols;Z=S;if(Z>0&&V>0){do{ac=V;ae=T[Z];Y.push({row:ae,cell:ae!==G?ae[ac]:G,rowIndex:Z,colIndex:ac})}while(Z-->1)}this.calcVisiblePos=X;z(Y,{each:aa});D.trigger("sheetCalculation",[{which:"spreadsheet",sheet:T,index:ad}]);D.setChanged(false)},resolveCell:function(I,P){var Q=!I.needsUpdated;if(!P){D.undo.createCells([I],function(R){D.trigger("sheetPreCalculation",[{which:"cell",cell:I}]);D.setDirty(true);D.setChanged(true);I.updateValue(function(){D.trigger("sheetCalculation",[{which:"cell",cell:I}]);if(Q){I.updateDependencies()}});return R})}else{D.trigger("sheetPreCalculation",[{which:"cell",cell:I}]);D.setDirty(true);D.setChanged(true);I.updateValue(function(){D.trigger("sheetCalculation",[{which:"cell",cell:I}]);if(Q){I.updateDependencies()}})}},addSheet:function(I){I=I||{rows:25,cols:10};D.evt.cellEditAbandon();D.setDirty(true);D.controlFactory.sheetUI(D.obj.ui,d.sheet.makeTable(I),D.sheetCount);D.setActiveSheet(D.sheetCount);D.sheetCount++;D.sheetSyncSize();var P=D.obj.pane();if(P.inPlaceEdit){P.inPlaceEdit.goToTd()}D.trigger("sheetAdd",[D.i])},insertSheet:null,deleteSheet:function(P){var S=P||D.i,R=D.controls.enclosures.toArray(),I;R.splice(S,1);D.obj.barHelper().remove();D.obj.enclosure().remove();D.controls.enclosures=d(R);D.obj.menus().remove();D.obj.tabContainer().children().eq(D.i).remove();D.spreadsheets.splice(S,1);D.controls.autoFiller.splice(S,1);D.controls.bar.helper.splice(S,1);D.controls.bar.corner.splice(S,1);D.controls.bar.x.controls.splice(S,1);D.controls.bar.x.handleFreeze.splice(S,1);D.controls.bar.x.controls.splice(S,1);D.controls.bar.x.menu.splice(S,1);if(D.controls.bar.x.menuParent&&D.controls.bar.x.menuParent[S]){D.controls.bar.x.menuParent.splice(S,1)}D.controls.bar.x.parent.splice(S,1);D.controls.bar.x.th.splice(S,1);D.controls.bar.y.controls.splice(S,1);D.controls.bar.y.handleFreeze.splice(S,1);D.controls.bar.y.controls.splice(S,1);D.controls.bar.y.menu.splice(S,1);if(D.controls.bar.y.menuParent&&D.controls.bar.y.menuParent[S]){D.controls.bar.y.menuParent.splice(S,1)}D.controls.bar.y.parent.splice(S,1);D.controls.bar.y.th.splice(S,1);D.controls.barMenuLeft.splice(S,1);D.controls.barMenuTop.splice(S,1);D.controls.barLeft.splice(S,1);D.controls.barTop.splice(S,1);D.controls.barTopParent.splice(S,1);D.controls.chart.splice(S,1);D.controls.tdMenu.splice(S,1);D.controls.enclosure.splice(S,1);D.controls.fullScreen=null;D.controls.inPlaceEdit.splice(S,1);D.controls.menus.splice(S,1);D.controls.menuLeft.splice(S,1);D.controls.menuRight.splice(S,1);D.controls.pane.splice(S,1);D.controls.tables.splice(S,1);D.controls.table.splice(S,1);for(I=S+1;I<D.controls.tab.length;++I){var Q=D.controls.tab[I].get(0);Q.i--}D.controls.tab.splice(S,1);D.controls.toggleHide.x.splice(S,1);D.controls.toggleHide.y.splice(S,1);D.readOnly.splice(S,1);D.i=0;D.sheetCount--;D.sheetCount=x.max(D.sheetCount,0);if(D.sheetCount==0){D.addSheet()}D.setActiveSheet(D.i);D.setDirty(true);D.setChanged(true);D.trigger("sheetDelete",[S])},deleteRow:function(U,T){var S,I,R,W,Y=D.sheetSize(),X,P=D.obj.pane(),V=P.table.tBody,Q;if(U){I=R=U}else{I=x.min(D.highlighter.start.row,D.highlighter.end.row);R=x.max(D.highlighter.start.row,D.highlighter.end.row)}W=(R-I)+1;if(I<1||Y.cols<2||W>=Y.rows){return}S=R;do{Q=D.getTd(-1,S,1);if(Q===null){continue}X=Q.parentNode;V.removeChild(X)}while(I<S--);D.controls.bar.y.th[D.i].splice(I,W);D.spreadsheets[D.i].splice(I,W);D.refreshRowLabels(I);D.setChanged(true);D.offsetFormulas({row:I,col:0},{row:-W,col:0},false,true);D.setDirty(true);D.evt.cellEditAbandon();if(P.inPlaceEdit){P.inPlaceEdit.goToTd()}D.trigger("sheetDeleteRow",S)},deleteColumn:function(U){var T,I,S,W,Y=D.sheetSize(),X,R,Q=D.obj.pane();if(U){I=S=U}else{I=x.min(D.highlighter.start.col,D.highlighter.end.col);S=x.max(D.highlighter.start.col,D.highlighter.end.col)}W=(S-I)+1;if(I<1||Y.cols<2||W>=Y.cols){return}T=S;D.obj.barHelper().remove();do{var V=D.obj.table(),P=D.col(V[0],T);d(D.obj.barTop(T)).remove();d(P).remove()}while(I<T--);D.controls.bar.x.th[D.i].splice(I,W);R=D.spreadsheets[D.i].length-W;do{X=D.spreadsheets[D.i][R].splice(I,W);while(X.length>0){d(X.pop().td).remove()}}while(R-->1);D.refreshColumnLabels(I);D.setChanged(true);D.offsetFormulas({row:0,col:I},{row:0,col:-W},false,true);D.setDirty(true);D.evt.cellEditAbandon();if(Q.inPlaceEdit){Q.inPlaceEdit.goToTd()}D.trigger("sheetDeleteColumn",T)},sheetTab:function(P,R){var I="",Q;if(P){Q=D.obj.table();I=Q.attr("title")||D.msg.sheetTitleDefault.replace(/[{]index[}]/gi,D.i+1);if(R){Q.attr("title",I);R(I)}return I}else{if(D.isSheetEditable()&&H.editableNames){H.prompt(D.msg.newSheetTitle,function(S){if(!S){I=D.obj.table().attr("title");S=(I?I:D.msg.sheetTitleDefault.replace(/[{]index[}]/gi,D.i+1))}else{D.setDirty(true);D.obj.table().attr("title",S);D.obj.tab().html(S);I=S}if(R){R(d(m.createElement("div")).text(I).html())}},D.sheetTab(true));return null}}},followMe:function(R,I){R=R||D.obj.tdActive();if(R===null){return}var Q=D.obj.pane(),P=Q.actionUI;D.setBusy(true);P.putTdInView(R);D.setBusy(false);if(!I){D.autoFillerGoToTd(R)}},autoFillerGoToTd:function(R,P,I){if(!H.autoFiller){return}if(R===G){R=D.obj.tdActive()}if(R&&R.type=="cell"){P=P||R.clientHeight;I=I||R.clientWidth;if(!R.offsetHeight||!R.offsetWidth||!R.clientHeight||!R.clientWidth){D.autoFillerHide();return}var Q=d(R).position();D.obj.autoFiller().show().css("top",((Q.top+(P||R.clientHeight)-3)+"px")).css("left",((Q.left+(I||R.clientWidth)-3)+"px"))}},autoFillerHide:function(){if(!H.autoFiller){return}D.obj.autoFiller().hide()},setActiveSheet:function(R,I){if(I!==G){R=I.i}else{R=R||0}if(D.cellLast.row>0||D.cellLast.col>0){D.evt.cellEditDone();D.obj.formula().val("")}var Q=D.obj.enclosures(),P=Q.length-1,S,T;D.autoFillerHide();if(P>0){do{if(R!=P){S=Q[P];S._scrollLeft=S._scrollLeft||S.scrollUI.scrollLeft;S._scrollTop=S._scrollTop||S.scrollUI.scrollTop;S.style.display="none"}}while(P-->0)}D.i=R;if(I!==G){S=I.enclosure}else{S=D.controls.enclosure[R][0]}S.style.display="";D.highlighter.setTab(D.obj.tab());D.readOnly[R]=(S.table.className||"").match(/\breadonly\b/i)!=null;T=S.pane;if(T.inPlaceEdit){T.inPlaceEdit.goToTd()}S.scrollUI.scrollLeft=S._scrollLeft||S.scrollUI.scrollLeft;S.scrollUI.scrollTop=S._scrollTop||S.scrollUI.scrollTop;S._scrollLeft=S._scrollTop=null;S.scrollUI.onscroll()},getSpreadsheetIndexByTitle:function(T){if(H.loader!==null){var S=H.loader.getSpreadsheetIndexByTitle(T);return S}var Q=D.obj.tables(),I=Q.length,R,P=0;for(;P<I;P++){R=Q[P];if(R.getAttribute("title")==T){return R.spreadsheetIndex}}return null},openSheet:function(P){var Q=P.length-1,I=function(){D.setBusy(true);var X=D.controlFactory.header(),W=D.controlFactory.ui(),R=D.controlFactory.sheetAdder(),T=D.controlFactory.tabContainer(),V,U={sizeCheck:function(Y){if(d.sheet.max){var Z=D.tableSize(Y.table);if(Z.rows>d.sheet.max||Z.cols>d.sheet.max){D.trigger("sheetMaxSize",[Y.table,Y.i]);H.confirm(D.msg.maxSizeBrowserLimitationOnOpen,function(){Y.load()})}else{Y.load()}}else{Y.load()}},initChildren:function(aa,Z,Y){D.controlFactory.sheetUI(aa,Z,Y);D.trigger("sheetOpened",[Y])},done:function(Y){D.sheetSyncSize();D.setActiveSheet(0);D.setDirty(false);D.setBusy(false);while(Y.length>0){D.calcVisibleInit(D.i=Y.pop())}D.trigger("sheetAllOpened")},lastIndex:Q},S;X.ui=W;X.tabContainer=T;W.header=X;W.sheetAdder=R;W.tabContainer=T;T.header=X;T.ui=W;H.parent.append(X).append(W).append(R).append(T);D.resizableSheet(H.parent,{minWidth:H.parent.width()*0.1,minHeight:H.parent.height()*0.1,start:function(){D.setBusy(true);D.obj.enclosure().hide();W.sheetAdder.hide();W.tabContainer.hide()},stop:function(){D.obj.enclosure().show();W.sheetAdder.show();W.tabContainer.show();D.setBusy(false);D.sheetSyncSize();var Y=D.obj.pane();if(Y.inPlaceEdit){Y.inPlaceEdit.goToTd()}}});if(H.loader===null){for(V=0;V<P.length;V++){new l.SpreadsheetUI(V,W,P[V],U);D.sheetCount++}}else{D.insertSheet=function(ac,Y,ab,aa){D.sheetCount++;ac=ac||null;aa=aa||m.createElement("table");ab=ab!==G?ab:true;Y=Y||D.sheetCount-1;if(ac!==null){loader.addSpreadsheet(ac)}if(!aa.hasAttribute("title")){aa.setAttribute("title",loader.title(Y))}var ad=function(){D.obj.enclosure().hide();D.setBusy(true);var ae=new l.SpreadsheetUI(Y,W,aa,U);D.setActiveSheet(-1,ae);D.calcVisibleInit(Y);D.setBusy(false);D.sheetSyncSize()},Z;if(ab){ad();return}Z=D.controlFactory.customTab(aa.getAttribute("title")).mousedown(function(){ad();D.obj.tab().insertBefore(this);d(this).remove();return false});if(H.loader.isHidden(Y)){Z.hide()}};S=new l.SpreadsheetUI(0,W,P[0],U);D.sheetCount++;if(P.length>1){for(V=1;V<P.length;V++){D.insertSheet(null,V,false,P[V])}D.i=0;S.loaded()}}};if(D.isDirty){H.confirm(D.msg.openSheet,I)}else{I()}},newSheet:function(){H.parent.html(d.sheet.makeTable()).sheet(H)},sheetSyncSize:function(){var Y=H.parent,U=Y[0],aa=U.clientHeight,V=U.clientWidth,Z=D.obj.tabContainer(),ab=Z[0],I=ab.style,ae=f.scrollBarSize.width,P,ad,X,W,S=D.obj.ui.style,T,af,R,ac,Q;if(!aa){aa=400;Y.height(aa)}else{if(aa<200){aa=200;Y.height(aa)}}Q=ab.scrollLeft;I.width="";P=ab.clientWidth;ad=(V-(H.colMargin+ae));X=(V-H.colMargin*2)+"px";W=((H.colMargin+ae)+"px");if(P>ad){I.height=W;Z.addClass(D.cl.tabContainerScrollable);aa-=ae}else{I.height=null;Z.removeClass(D.cl.tabContainerScrollable)}I.width=X;ab.scrollLeft=Q;aa-=D.obj.header().outerHeight()+H.boxModelCorrection;aa-=ab.clientHeight+H.boxModelCorrection;T=(aa-f.scrollBarSize.height-H.boxModelCorrection)+"px";af=(V-f.scrollBarSize.width)+"px";R=(aa+"px");ac=(V+"px");D.obj.panes().each(function(){var ai=this.style,ah=this.actionUI.scrollUI.style,ag=this.enclosure.style;ai.height=T;ai.width=af;ag.height=ah.height=R;ag.width=ah.width=ac});S.height=R;S.width=ac},showSheets:function(){D.obj.tabContainer().children().each(function(I){d(this).show();if(H.loader!==null){H.loader.setMetadata(I,{hidden:false})}})},showSheet:function(I){D.obj.tabContainer().children().eq(I).show();if(H.loader!==null){H.loader.setMetadata(I,{hidden:false})}},hideSheet:function(I){D.obj.tabContainer().children().eq(I).hide();if(H.loader!==null){H.loader.setMetadata(I,{hidden:true})}},cellChangeStyle:function(Q,R,I){I=I||D.highlighted(true);if(I.length<1){return false}D.setDirty(this);var P=I.length-1;if(P>=0){D.undo.createCells(I,function(S){do{S[P].td.css(Q,R)}while(P--);return S});return true}return false},cellFind:function(I){function P(R){var Q=D.obj.table().children("tbody").children("tr");if(R){var S=Q.children('td:contains("'+R+'")');if(S.length<1){S=Q.children('td:contains("'+R.toLowerCase()+'")')}if(S.length<1){S=Q.children('td:contains("'+R.toUpperCase()+'")')}S=S.eq(0);if(S.length>0){D.cellEdit(S)}else{H.alert(D.msg.cellNoFind)}}}if(!I){H.prompt(D.msg.cellFind,P)}else{P(I)}},cellSetActiveBar:function(X,Q,S){var ac=D.sheetSize(),U=x.min(Q,S),Z=x.max(Q,S),I={},Y={},ab=function(ad){switch(H.cellSelectModel){case l.openOfficeSelectModel:this.row=(ad?I.row:Y.row);this.col=(ad?I.col:Y.col);this.td=D.getTd(-1,this.row,this.col);if(this.td!==null&&this.td!==D.cellLast.td){D.cellEdit(this.td,false,true)}break;default:this.row=(ad?Y.row:I.row);this.col=(ad?Y.col:I.col);this.td=D.getTd(-1,this.row,this.col);if(this.td!==null&&this.td!==D.cellLast.td){D.cellEdit(this.td,false,true)}break}},T=[],V=D.obj.pane().actionUI.scrolledArea,W=D.obj.table(),P,aa,R;switch(X){case"top":I.row=V.row;I.col=U;Y.row=V.row;Y.col=Z;D.highlighter.start.row=1;D.highlighter.start.col=U;D.highlighter.end.row=ac.rows;D.highlighter.end.col=Z;P=Z;do{T.push(D.col(W[0],P))}while(P-->U);break;case"left":I.row=U;I.col=V.col;Y.row=Z;Y.col=V.col;D.highlighter.start.row=U;D.highlighter.start.col=1;D.highlighter.end.row=Z;D.highlighter.end.col=ac.cols;aa=Z;do{R=D.getTd(-1,aa,1);if(R===null){continue}T.push(R.parentNode)}while(aa-->U);break;case"corner":I.row=1;I.col=1;Y.col=ac.cols;Y.row=ac.rows;T.push(W[0]);break}new ab(Q>S);D.highlighter.set(T)},getTdRange:function(R,W,U,V){D.cellLast.isEdit=true;var P=function(Y){if(Y.first.col>Y.last.col||Y.first.row>Y.last.row){return{first:h.parseCellName(Y.last.col,Y.last.row),last:h.parseCellName(Y.first.col,Y.first.row)}}else{return{first:h.parseCellName(Y.first.col,Y.first.row),last:h.parseCellName(Y.last.col,Y.last.row)}}},T=function(ab){var Y=P(ab),aa=W+"";aa=(aa.match(/=/)?aa:"="+aa);if(U||aa.charAt(aa.length-1)!="("){aa=aa+(U?U:"")+"("}var ac,Z="";if(Y.first!=Y.last){ac=Y.first+":"+Y.last}else{ac=Y.first}if(aa.charAt(aa.length-1)=="("){Z=")"}return aa+ac+Z},I="",Q,S,X;if(R){Q={first:D.getTdLocation([R.target])};S=D.obj.table().mousemove(function(Y){Q.last=D.getTdLocation([Y.target]);I=T(Q);if(!V){D.obj.formula().val(I);D.obj.inPlaceEdit().val(I)}});O.one("mouseup",function(){S.unbind("mousemove");return I})}else{X=D.highlighted().not(D.obj.tdActive());if(X.length){Q={first:D.getTdLocation(X.first()),last:D.getTdLocation(X.last())};I=T(Q);if(!V){D.obj.formula().val(I);D.obj.inPlaceEdit().val(I)}return I}else{return""}}return""},getTd:function(S,U,P){var Q=(S>-1?D.obj.tables()[S]:D.obj.table()[0]),I,R,T;if(!Q||!(I=Q.tBody)||!(R=I.children[U])||!(T=R.children[P])){return null}return T},getTdLocation:function(R){var I={col:0,row:0},P=0,Q=D.obj.pane();if(R===G||R===null){return I}if(R.parentNode===G||(R.parentNode.rowIndex+P)<0){return I}return{col:R.cellIndex,row:R.parentNode.rowIndex+P}},getBarIndex:{left:function(I){I=I||{};if(!I.parentNode||L(I.parentNode.rowIndex)){return -1}else{return I.parentNode.rowIndex}},top:function(I){I=I||{};if(L(I.cellIndex)){return -1}else{return I.cellIndex}},corner:function(){return 0}},time:{now:new a(),last:new a(),diff:function(){return x.abs(x.ceil(this.last.getTime()-this.now.getTime())/1000).toFixed(5)},set:function(){this.last=this.now;this.now=new a()},get:function(){return this.now.getHours()+":"+this.now.getMinutes()+":"+this.now.getSeconds()}},changed:[],isChanged:function(I){return D.changed[I||D.i]},setChanged:function(I){D.changed[D.i]=I},isDirty:false,setDirty:function(I){D.dirty=I},appendToFormula:function(I){var Q=D.obj.formula(),P=Q.val();if(P.charAt(0)!="="){P="="+P}Q.val(P+I)},undo:{manager:(f.UndoManager?new UndoManager():{undo:C,redo:C,register:C}),cells:[],id:-1,createCells:function(I,P,S){if(S===G){D.undo.id++;S=D.undo.id}var Q=(new l.CellRange(I)).clone().cells,R=(P!==G?(new l.CellRange(P(I)).clone()).cells:Q);Q.id=S;R.id=S;D.undo.manager.add({undo:function(){D.undo.removeCells(Q,S)},redo:function(){D.undo.createCells(R,null,S)}});if(S!==D.undo.id){D.undo.draw(R)}return true},removeCells:function(P,R){var Q=0,I=-1;if(P.id===R){I=Q}if(I!==-1){D.undo.cells.splice(I,1)}D.undo.draw(P)},draw:function(Q){var P,T,S,I,R;for(P=0;P<Q.length;P++){S=Q[P];R=D.getTdLocation(S.td);I=D.spreadsheets[S.sheetIndex][R.row][R.col];I.value=S.value;I.formula=S.formula;T=I.td=S.td;I.dependencies=S.dependencies;I.needsUpdated=S.needsUpdated;I.calcCount=S.calcCount;I.sheetIndex=S.sheetIndex;I.rowIndex=R.row;I.columnIndex=R.col;I.state=S.state;I.jS=S.jS;T.setAttribute("style",S.style);T.setAttribute("class",S.cl);I.setNeedsUpdated();I.updateValue()}}},cols:function(I){I=I||D.obj.table()[0];if(!I){return[]}if(!I.colGroup){return[]}if(!I.colGroup.children){return[]}return I.colGroup.children},tables:function(X,S){X=X||D.obj.tables();var W=[],Q=X.length-1,P,Z,V,I,aa,R,Y,T,U;do{Z=(S?m.body.removeChild(X[Q]):X[Q].cloneNode(true));if((I=Z.children[0])&&(aa=I.children[0])){I.removeChild(aa)}if(V=Z.children[1]){T=V.children;Y=T[0];V.removeChild(Y);P=T.length-1;do{U=T[P];R=U.children[0];U.removeChild(R)}while(P-->0)}W[Q]=Z}while(Q-->0);return D.sheetDecorateRemove(false,d(W))},col:function(P,I){P=P||D.obj.table()[0];var Q=D.cols(P);if(I===G){I=Q.length-1}return Q[I]},rowTds:function(P,I){P=P||D.obj.table();var Q=D.rows(P);if(!Q.length){return[]}if(I==G){I=Q.length-1}if(!Q[I]){return[]}if(!Q[I].children){return[]}return Q[I].children},rows:function(I){I=I||D.obj.table()[0];if(I===G){return[]}if(I.tBody===G){return[]}if(I.tBody.children===G){return[]}return I.tBody.children},highlighted:function(P){var R=D.highlighter.last||d([]),S=[],I,Q;if(!(I=R)||!R.length||!(I=I[0])||!I.tagName){return P?S:d(S)}switch(I.tagName){case"TD":Q=R.length-1;do{S.unshift(P?R[Q].jSCell:R[Q])}while(Q-->0);break;case"TR":Q=R.length-1;do{if(R[Q].tds){S=S.concat(P?R[Q].jSCells:R[Q].tds)}}while(Q-->0);break;case"COL":R=R.filter("col");Q=R.length-1;do{if(R[Q].tds){S=S.concat(P?R[Q].jSCells:R[Q].tds)}}while(Q-->0);break;case"TABLE":S=(P?I.jSCells:I.tds);break}return P?S:d(S)},sheetSize:function(Q){var P,T,I={},R=H.minSize||{rows:1,cols:1},S;if(H.loader!==null){S=H.loader.size(Q.spreadsheetIndex);I.rows=g.max(S.rows,R.rows);I.cols=g.max(S.cols,R.cols)}else{Q=Q||D.obj.table()[0];if((I.cols=H.initScrollCols)>0&&(I.rows=H.initScrollRows)>0){}else{P=D.rowTds(Q);T=D.getTdLocation(P[P.length-1]);I.cols=T.col;I.rows=T.row}}return I},sortVerticalSelectAscending:function(){if(confirm("Do you want to extend your selection?")){D.sortVertical();return true}else{D.sortVerticalSingle(false);return true}},sortVerticalSelectDescending:function(){if(confirm("Do you want to extend your selection?")){D.sortVertical();return false}else{D.sortVerticalSingle(true);return false}},sortVertical:function(X){var V=D.highlighted(true),S=V[0].td.parent().prev(),I=V.length,Q=new a(),U=true,Y=[],aa=[],T,W=0,Z,P,R;while(W<I){Z=V[W];R=Z.td;if(!isNaN(Z.value)){P=(new t(Z.value.valueOf()))}else{U=false;P=(new q(Z.value.valueOf()))}P.loc=D.getTdLocation(R);P.row=R.parentNode;P.col=R;P.cell=Z;Y.push(P);W++}if(X){if(U==false){Y.sort(function(ac,ab){return ab-ac})}else{Y.sort();Y.reverse()}}else{if(U==true){Y.sort(function(ac,ab){return ac-ab})}else{Y.sort()}}D.undo.createCells(V);while(T=Y.length){P=Y.pop();aa=D.spreadsheets[D.i].splice(P.row.rowIndex,1);Z=P.cell;Z.value=P.valueOf();P.row.parentNode.removeChild(P.row);S.after(P.row);P.row.children[0].innerHTML=S[0].rowIndex+T;D.spreadsheets[D.i].splice(S[0].rowIndex+1,0,aa[0]);D.track.call(Z,true)}D.undo.createCells(V)},sortVerticalSingle:function(T){var R=D.highlighted(true),S=R.length,Q=0,P=[],I;while(Q<S){P.push(R[Q].value);Q++}if(T){P.sort(function(V,U){return U-V})}else{P.sort(function(V,U){return V-U})}while(R.length){I=R.pop();I.value=P[R.length];I.updateValue()}},sortHorizontalSelectAscending:function(){if(confirm("Do you want to extend your selection?")){D.sortHorizontal();return true}else{D.sortHorizontalSingle(false);return true}},sortHorizontalSelectDescending:function(){if(confirm("Do you want to extend your selection?")){D.sortHorizontal();return false}else{D.sortHorizontalSingle(true);return false}},sortHorizontal:function(X){var V=D.highlighted(true),ad=V[0].td[0],Z=ad.cellIndex,I=ad.table.colGroup,ae=D.sheetSize().rows,P=V.length,R=new a(),U=true,aa=[],T,W=0,ab,ac,Q,Y,S;while(W<P){ab=0;ac=V[W];S=ac.td;if(!isNaN(ac.value)){Q=new t(ac.value.valueOf())}else{U=false;Q=new q(ac.value.valueOf())}Q.tds=[];Q.loc=D.getTdLocation(S);Q.tr=S.parentNode;Q.td=S;Q.cell=ac;while(ab<=ae){Q.tds.push(D.obj.pane().table.children[1].children[ab].children[S.cellIndex]);ab++}aa.push(Q);W++}if(X){if(U==false){aa.sort(function(ag,af){return af-ag})}else{aa.sort();aa.reverse()}}else{if(U==true){aa.sort(function(ag,af){return ag-af})}else{aa.sort()}}D.undo.createCells(V);while(aa.length){Q=aa.pop();while(Q.tds.length>1){S=Q.tds.pop();Y=S.parentNode;ac=D.spreadsheets[D.i][Y.rowIndex].splice(S.cellIndex,1);Y.insertBefore(S,Y.children[Z]);S.col=I.children[aa.length+S.cellIndex-1];S.barTop=S.col.bar;ac.value=S.jSCell.value;D.spreadsheets[D.i][Y.rowIndex].splice(S.cellIndex,0,ac[0]);D.resolveCell(ac,true)}}D.undo.createCells(V)},sortHorizontalSingle:function(T){var R=D.highlighted(true),S=R.length,Q=0,P=[],I;while(Q<S){P.push(R[Q].value);Q++}if(T){P.sort(function(V,U){return U-V})}else{P.sort(function(V,U){return V-U})}while(R.length){I=R.pop();I.value=P[R.length];I.updateValue()}},tableSize:function(X,U){var W,Q,V,I,S,P=X.pane,Y=0,R=0,T=0;X=X||D.obj.table()[0];if((W=X.tBody)!==G&&(Q=W.children)!==G&&(V=Q[Q.length-1])!==G&&(I=V.children)!==G&&(S=I[I.length-1])!==G){if(U===true){Y=V.rowIndex}else{Y=V.rowIndex+T}R=S.cellIndex}else{return{}}return{cols:R,rows:Y}},toggleState:function(I){if(H.allowToggleState){var P=I||D.tables();if(H.editable){D.evt.cellEditAbandon();D.trigger("sheetSave",[P])}D.setDirty(false);D.setChanged(true);H.editable=!H.editable;D.kill();H.parent.html(P).sheet(H);H=null}},setCellRef:function(Q){function P(S){if(S){D.s.formulaVariables[S]=I.updateValue()}}var R=D.obj.tdActive(),I=R.jSCell;if(Q){P(Q)}else{H.prompt(D.msg.setCellRef,P)}},formulaParser:null,print:function(I,P){I=I||D.i;var R=f.open(),Q;if(R!==G){Q=R.document;Q.write('<html>	<head id="head"></head>	<body>		<div id="entry" class="'+D.cl.parent+'" style="overflow: show;">		</div>	</body></html>');if(P!==true){d(Q.getElementById("head")).append(d("style,link").clone())}d(Q.getElementById("entry")).append(D.obj.pane().cloneNode(true));Q.close();R.focus();R.print()}}},w=[],A;D.setBusy(true);H.parent[0].jS=D;if(!f.console){f.console={log:function(){}}}if(f.scrollBarSize===G){f.scrollBarSize=n()}if(f.defaultCharSize===G){f.defaultCharSize=k()}D.cellHandler=new l.CellHandler(D,h,d.sheet.fn);D.theme=new l.Theme(H.theme);D.highlighter=new l.Highlighter(D.theme.tdHighlighted,D.theme.barHighlight,D.theme.tabActive,function(){D.obj.pane().actionUI.redraw()});H.origHtml=H.parent.children().detach();H.parent.addClass(D.cl.parent);H.parent.bind("sheetSwitch",function(Q,P,I){D.switchSheet(I)}).bind("sheetRename",function(Q,P,I){D.renameSheet(I)});H.width=(H.width?H.width:H.parent.width());H.height=(H.height?H.height:H.parent.height());if(!d.nearest){D.nearest=C}D.resizableCells=D.resizableSheet=D.resizable;if(!d.ui){D.resizable=D.resizableCells=D.resizableSheet=D.draggable=C}else{if(!H.resizableCells){D.resizableCells=C}if(!H.resizableSheet){D.resizableSheet=C}}if(!d.support.boxModel){H.boxModelCorrection=0}if(!H.barMenus){D.controlFactory.barMenuTop=D.controlFactory.barMenuLeft=C}if(!H.freezableCells){D.controlFactory.barHandleFreeze.top=D.controlFactory.barHandleFreeze.left=C}if(H.calcOff){D.calc=C}if(!f.Raphael){h.chart=C}J.resize(function(){if(D&&!D.isBusy()){H.width=H.parent.width();H.height=H.parent.height();D.sheetSyncSize()}}).unload(function(){var Q=l.Cell.threads,P=0,I=Q.length;for(;P<I;P++){Q[P].terminate()}});if(d.sheet.fn){d.sheet.fn=d.extend(d.sheet.fn,H.formulaFunctions);if(d.sheet.advancedfn){d.sheet.fn=d.extend(d.sheet.fn,d.sheet.advancedfn)}if(d.sheet.financefn){d.sheet.fn=d.extend(d.sheet.fn,d.sheet.financefn)}}H.title=H.title||H.parent.attr("title")||"";D.s=H;H.parent.addClass(D.theme.parent);if(H.origHtml.length){D.openSheet(H.origHtml)}else{if(H.loader!==null){H.loader.bindJS(D).bindHandler(D.cellHandler);while(w.length<H.loader.count){A=m.createElement("table");A.setAttribute("title",H.loader.title(w.length)||D.msg.sheetTitleDefault.replace(/[{]index[}]/gi,w.length+1));w.push(A)}D.openSheet(w)}else{D.openSheet([m.createElement("table")])}}D.setBusy(false);return D},makeTable:function(I,y,w){var G=m;I=I||{rows:25,cols:10};y=y||120;w=w||15;var H=m.createElement("table"),x=m.createElement("colgroup"),F=m.createElement("tbody"),C="width:"+y+"px;",A="height:"+w+"px;",E,z,D,B;D=I.cols;do{z=m.createElement("col");z.setAttribute("style",C);x.appendChild(z)}while(D-->1);D=I.rows;do{E=m.createElement("tr");E.setAttribute("style",A);B=I.cols;do{E.appendChild(m.createElement("td"))}while(B-->1);F.appendChild(E)}while(D-->1);H.appendChild(x);H.appendChild(F);return H},killAll:function(){if(d.sheet){var w=d.sheet.instance;if(w){for(var x=0;x<w.length;x++){if(w[x]&&w[x].kill){w[x].kill()}}d.sheet.instance=[]}}},scrollLocker:function(x){var w=d.sheet.instance;w[x].obj.panes().each(function(y){var z;d(z=this.scrollUI).scroll(function(B){var A=w.length-1,C;if(A>-1){do{C=w[A].controls.enclosure[y][0].scrollUI;if(this!==C){C.scrollLeft=z.scrollLeft;C.scrollTop=z.scrollTop}}while(A--)}})})},switchSheetLocker:function(w){d.each(d.sheet.instance,function(){this.s.parent.bind("sheetSwitch",function(z,y,x){d.each(d.sheet.instance,function(){this.setActiveSheet(x)})})})},I:function(){var w=0;if(this.instance){w=(this.instance.length===0?0:this.instance.length-1)}else{this.instance=[]}return w}};var h=d.sheet.engine={calc:function(z,x,A){x=x||[];var C=x.length-1,B,y,w;if(C>0){do{if(C>0&&x[C]){B=x[C];y=B.length-1;if(y>0){do{w=B[y];w.updateValue()}while(y-->1)}}}while(C-->1)}},parseLocation:function(w,x){return{row:parseInt(x),col:h.columnLabelIndex(w)}},parseSheetLocation:function(x){var w=((x+"").replace(/SHEET/i,"")*1)-1;return isNaN(w)?-1:w},parseCellName:function(w,x){return h.columnLabelString(w)+(x||"")},alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),columnLabels:{},columnLabelIndex:function(w){return this.columnLabels[w.toUpperCase()]},columnIndexes:[],columnLabelString:function(z){if(!this.columnIndexes.length){var B="",A,y,x,w;A=y=x=-1;for(w=1;w<16385;++w){B="";++x;if(x==26){x=0;++y;if(y==26){y=0;++A}}if(A>=0){B+=this.alphabet[A]}if(y>=0){B+=this.alphabet[y]}if(x>=0){B+=this.alphabet[x]}this.columnIndexes[w]=B;this.columnLabels[B]=w}}return this.columnIndexes[z]||""},regEx:{n:/[\$,\s]/g,cell:/(\$?[a-zA-Z]+|[#]REF[!])(\$?[0-9]+|[#]REF[!])/gi,range:/(\$?[a-zA-Z]+)\$?([0-9]+):(\$?[a-zA-Z]+)(\$?[0-9]+)/gi,remoteCell:/\$?(SHEET+)(\$?[0-9]+)[:!](\$?[a-zA-Z]+)(\$?[0-9]+)/gi,remoteCellRange:/\$?(SHEET+)(\$?[0-9]+)[:!](\$?[a-zA-Z]+)(\$?[0-9]+):(\$?[a-zA-Z]+)(\$?[0-9]+)/gi,sheet:/SHEET/i,amp:/&/g,gt:/</g,lt:/>/g,nbsp:/&nbsp;/g},chart:function(y){var B=this.jS,E=m.createElement("div"),A=this.td,D,C=m.body;C.appendChild(E);function z(G,H){if(!G){if(H){G=0}else{G=""}}else{if(H){G=c.toNumbers(G)}else{G=c.flatten(G)}}return G}y=d.extend({x:{legend:"",data:[0]},y:{legend:"",data:[0]},title:"",data:[0],legend:""},y);E.className=B.cl.chart;E.onmousedown=function(){d(A).mousedown()};E.onmousemove=function(){d(A).mousemove();return false};B.controls.chart[B.i]=B.obj.chart().add(E);y.data=z(y.data,true);y.x.data=z(y.x.data,true);y.y.data=z(y.y.data,true);y.legend=z(y.legend);y.x.legend=z(y.x.legend);y.y.legend=z(y.y.legend);y.legend=(y.legend?y.legend:y.data);var x,F,w=Raphael(E);if(A.clientHeight>0){x=g.max(A.clientWidth,100);F=g.max(A.clientHeight,50)}if(y.title){w.text(x/2,10,y.title).attr({"font-size":20})}switch(y.type){case"bar":D=w.barchart(x/8,F/8,x*0.8,F*0.8,y.data,y.legend).hover(function(){this.flag=w.popup(this.bar.x,this.bar.y,this.bar.value||"0").insertBefore(this)},function(){this.flag.animate({opacity:0},300,function(){this.remove()})});break;case"hbar":D=w.hbarchart(x/8,F/8,x*0.8,F*0.8,y.data,y.legend).hover(function(){this.flag=w.popup(this.bar.x,this.bar.y,this.bar.value||"0").insertBefore(this)},function(){this.flag.animate({opacity:0},300,function(){this.remove()})});break;case"line":D=w.linechart(x/8,F/8,x*0.8,F*0.8,y.x.data,y.y.data,{nostroke:false,axis:"0 0 1 1",symbol:"circle",smooth:true}).hoverColumn(function(){this.tags=w.set();if(this.symbols.length){for(var G=0,H=this.y.length;G<H;G++){this.tags.push(w.tag(this.x,this.y[G],this.values[G],160,10).insertBefore(this).attr([{fill:"#fff"},{fill:this.symbols[G].attr("fill")}]))}}},function(){this.tags&&this.tags.remove()});break;case"pie":D=w.piechart(x/2,F/2,(x<F?x:F)/2,y.data,{legend:y.legend}).hover(function(){this.sector.stop();this.sector.scale(1.1,1.1,this.cx,this.cy);if(this.label){this.label[0].stop();this.label[0].attr({r:7.5});this.label[1].attr({"font-weight":800})}},function(){this.sector.animate({transform:"s1 1 "+this.cx+" "+this.cy},500,"bounce");if(this.label){this.label[0].animate({r:5},500,"bounce");this.label[1].attr({"font-weight":400})}});break;case"dot":D=w.dotchart(x/8,F/8,x*0.8,F*0.8,y.x.data,y.y.data,y.data,{symbol:"o",max:10,heat:true,axis:"0 0 1 1",axisxstep:y.x.data.length-1,axisystep:y.y.data.length-1,axisxlabels:(y.x.legend?y.x.legend:y.x.data),axisylabels:(y.y.legend?y.y.legend:y.y.data),axisxtype:" ",axisytype:" "}).hover(function(){this.marker=this.marker||w.tag(this.x,this.y,this.value,0,this.r+2).insertBefore(this);this.marker.show()},function(){this.marker&&this.marker.hide()});break}D.mousedown(function(){d(A).mousedown().mouseup()});C.removeChild(E);return E}};var o=d.sheet.fn={ISNUMBER:function(x){var w;if(!isNaN(x.valueOf())){w=new v(true);w.html="TRUE";return w}w=new v(false);w.html="FALSE";return w},N:function(w){if(w==null){return 0}if(w instanceof a){return w.getTime()}if(typeof(w)=="object"){w=w.toString()}if(typeof(w)=="string"){w=parseFloat(w.replace(h.regEx.n,""))}if(isNaN(w)){return 0}if(typeof(w)=="number"){return w}if(w==true){return 1}return 0},VERSION:function(){return this.jS.version},ABS:function(w){return g.abs(o.N(w))},CEILING:function(x,w){w=w||1;return(parseInt(x/w)*w)+w},EVEN:function(w){w=g.round(w);var x=(w%2==0);if(!x){if(w>0){w++}else{w--}}return w},EXP:function(w){return g.exp(w)},FLOOR:function(y,x){x=x||1;if((y<0&&x>0)||(y>0&&x<0)){var w=new t(0);w.html="#NUM";return w}if(y>=0){return g.floor(y/x)*x}else{return g.ceil(y/x)*x}},INT:function(w){return g.floor(o.N(w))},LN:function(w){return g.log(w)},LOG:function(w,x){x=x||10;return g.log(w)/g.log(x)},LOG10:function(w){return o.LOG(w)},MOD:function(w,A){var z=w%A;if(A<0){z*=-1}return z},ODD:function(w){var y=false;if(w>0){w=g.floor(g.round(w));y=true}else{w=g.ceil(w)}var x=g.abs(w);if((x%2)==0){x++}if(y){return x}else{return -x}},PI:function(){return g.PI},POWER:function(w,z){return g.pow(w,z)},SQRT:function(w){return g.sqrt(w)},RAND:function(){return g.random()},RND:function(){return g.random()},ROUND:function(y,x){var w=g.pow(10,x||0);return g.round(y*w)/w},ROUNDDOWN:function(x,w){var y=(x<0);x=g.abs(x);w=w||0;x=g.floor(x*g.pow(10,w))/g.pow(10,w);return(y?-x:x)},ROUNDUP:function(x,w){var y=(x<0);x=g.abs(x);w=w||0;x=g.ceil(x*g.pow(10,w))/g.pow(10,w);return(y?-x:x)},SUM:function(){var C=0,A=arguments,w,y,B=A.length-1,z,x,D=isNaN;if(B<0){return 0}do{w=A[B];z=w.length-1;do{y=w[z];if(y===null||y===undefined){continue}y=y.valueOf();if(!D(y)){switch(typeof y){case"string":C+=(y*1);break;default:C+=y}}}while(z-->0)}while(B-->0);return C},TRUNC:function(w,x){x=x||0;w=w+"";if(x==0){return w.split(".").shift()}if(w.match(".")){if(x==1){w=w.substr(0,w.length-1)}else{if(x==-1){w=w.split(".").shift();w=w.substr(0,w.length-1)+"0"}}}return w},AVERAGE:function(){return o.SUM.apply(this,arguments)/o.COUNT.apply(this,arguments)},AVG:function(){return o.AVERAGE.apply(this,arguments)},COUNT:function(){var y=0,w=c.toNumbers(arguments),x=w.length-1;if(x<0){return y}do{if(w[x]!==null){y++}}while(x--);return y},COUNTA:function(){var y=0,w=c.flatten(arguments),x=w.length-1;if(x<0){return y}do{if(w[x]){y++}}while(x--);return y},MAX:function(){var x=c.toNumbers(arguments),w=x[0],y=x.length-1;if(y<0){return 0}do{w=(x[y]>w?x[y]:w)}while(y--);return w},MIN:function(){var w=c.toNumbers(arguments),y=w[0],x=w.length-1;if(x<0){return 0}do{y=(w[x]<y?w[x]:y)}while(x--);return y},ASC:function(w){return w.charCodeAt(0)},CHAR:function(w){return q.fromCharCode(w)},CLEAN:function(w){var x=new b("[cG\x1BcLcJcMcIcK\x07\x1B\f\n\r\t\v]","g");return w.replace(x,"")},CODE:function(w){return o.ASC(w)},CONCATENATE:function(){var y=c.flatten(arguments),x="",w=this;jQuery.each(y,function(z){x+=y[z]});return x},DOLLAR:function(y,x,A){x=x||2;A=A||"$";var w=new t(y),z=o.FIXED(y,x,false);if(y>=0){w.html=A+z}else{w.html="("+A+z.slice(1)+")"}return w},FIXED:function(z,y,x){y=(y===undefined?2:y);var A=g.pow(10,y),w,z=g.round(z*A)/A;w=new q(z.toFixed(y));w.html=Globalize.format(z,"n"+y);if(x){w.html=w.html.replace(Globalize.culture().numberFormat[","],"")}return w},LEFT:function(w,x){w=w.valueOf().toString();x=x||1;return w.substring(0,x)},LEN:function(w){if(!w){return 0}return w.length},LOWER:function(w){return w.toLowerCase()},MID:function(y,z,x){if(!y||!z||!x){var w=new t(0);w.html="ERROR";return w}return y.substring(z-1,x+z-1)},REPLACE:function(x,A,y,z){if(!x||!A||!y||!z){var w=new q("");w.html="ERROR";return w}var w=x.split("");w.splice(A-1,y);w.splice(A-1,0,z);return w.join("")},REPT:function(x,z){var w="";for(var y=0;y<z;y++){w+=x}return w},RIGHT:function(w,x){x=x||1;return w.substring(w.length-x,w.length)},SEARCH:function(z,x,A){A=A||0;if(A){x=x.split("");x.splice(0,A-1);x=x.join("")}var y=x.search(z);if(y<0){var w=new q("");w.html="#VALUE!";return w}return A+(A?0:1)+y},SUBSTITUTE:function(z,w,y,A){A=A||0;w=new b(w,"g");var x=1;z=z.replace(w,function(C,E,F,D){var B=C;if(A){if(x>=A){B=y}}else{B=y}x++;return B});return z},TEXT:function(x,w){return x},UPPER:function(w){return w.toUpperCase()},VALUE:function(x){if(jQuery.isNumeric(x)){return x*=1}else{var w=new q("");w.html="#VALUE!";return w}},NOW:function(){var w=new a();w.html=e.toString(w);return w},TODAY:function(){var x=new a(),w=new t(e.toCentury(x)-1);w.html=e.toString(x,"d");return w},WEEKENDING:function(x){var w=new a();w=new a(w.getFullYear(),w.getMonth(),w.getDate()+5-w.getDay()-((x||0)*7));w.html=e.toString(w,"d");return w},WEEKDAY:function(x,y){x=e.get(x);var w=x.getDay();y=(y?y:1);switch(y){case 3:switch(w){case 0:return 7;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6}break;case 2:switch(w){case 0:return 6;case 1:return 0;case 2:return 1;case 3:return 2;case 4:return 3;case 5:return 4;case 6:return 5}break;case 1:w++;break}return w},WEEKNUM:function(w){w=e.get(w);return e.week(w)+1},YEAR:function(w){w=e.get(w);return w.getFullYear()},DAYSFROM:function(x,y,w){return g.floor((new a()-new a(x,(y-1),w))/e.dayDiv)},DAYS:function(A,y){var x=e.get(A),w=e.get(y),z=1000*60*60*24;return g.round(g.abs(x.getTime()-w.getTime())/z)},DAY:function(w){w=e.get(w);return w.getDate()},DAYS360:function(B,y,D){B=e.get(B);y=e.get(y);var w=B.getDate(),A=y.getDate(),z=e.isLastDayOfMonth(B),C=e.isLastDayOfMonth(y),x=e.diffMonths(B,y);if(D){w=g.min(w,30);A=g.min(A,30)}else{if(z){w=30}if(C){if(w<30){x++;A=1}else{A=30}}}return(x*30)+(A-w)},DATE:function(z,A,x){var y=new a(z,A-1,x),w=new t(e.toCentury(y));w.html=e.toString(y,"d");return w},DATEVALUE:function(x){x=e.get(x);var w=new t(e.toCentury(x));w.html=e.toString(x,"d");return w},EDATE:function(y,x){y=e.get(y);y.setMonth(y.getMonth()+x);var w=new t(e.toCentury(y));w.html=e.toString(y,"d");return w},EOMONTH:function(y,x){y=e.get(y);y.setMonth(y.getMonth()+x+1);y=new a(y.getFullYear(),y.getMonth(),0);var w=new t(e.toCentury(y));w.html=e.toString(y,"d");return w},HOUR:function(w){w=j.fromMath(w);return w.hour},MINUTE:function(w){return j.fromMath(w).minute},MONTH:function(w){w=e.get(w);return w.getMonth()+1},SECOND:function(w){return j.fromMath(w).second},TIME:function(w,B,x){x=(x?x:0);B=(B?B:0);w=(w?w:0);if(x&&x>60){var y=(((x/60)+"").split(".")[0])*1;x=x-(y*60);B+=y}if(B&&B>60){var A=(((B/60)+"").split(".")[0])*1;B=B-(A*60);w+=A}var z=(w*60*60*1000)+(B*60*1000)+(x*1000);return z/e.dayDiv},TIMEVALUE:function(w){if(!isNaN(w)){return w}if(/([0]?[1-9]|1[0-2])[:][0-5][0-9]([:][0-5][0-9])?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm)/.test(w)){return j.fromString(w,true)}else{if(/([0]?[0-9]|1[0-9]|2[0-3])[:][0-5][0-9]([:][0-5][0-9])?/.test(w)){return j.fromString(w)}}return 0},WORKDAY:function(x,A,z){var B={1:true,2:true,3:true,4:true,5:true},x=e.get(x),A=(A&&!isNaN(A)?A:0),C=0,y=0,w=x,E;if(z){if(!jQuery.isArray(z)){z=[z]}z=c.flatten(z);var D={};jQuery.each(z,function(F){if(z[F]){D[e.toString(e.get(z[F]),"d")]=true}});z=D}else{z={}}while(y<A){w=new a(w.setDate(w.getDate()+1));if(B[w.getDay()]){if(!z[e.toString(w,"d")]){y++}}C++}E=new t(e.toCentury(w));E.html=e.toString(w,"d");return E},YEARFRAC:function(x,B,A){x=e.get(x);B=e.get(B);if(!x||!B){var w=new q("");w.html="#VALUE!";return w}A=(A?A:0);this.html=[];var z=e.diff(x,B,A),y=e.calcAnnualBasis(x,B,A);return z/y},AND:function(){var x,y=0,w=arguments.length;for(;y<w;y++){x=arguments[y];if(x===undefined||(x.valueOf!==undefined&&x.valueOf()!=true)||x!=true){return o.FALSE()}}return o.TRUE()},FALSE:function(){var w=new v(false);w.html="FALSE";return w},IF:function(A,y,x){var w=A.valueOf(),z;switch(typeof w){case"boolean":if(w===true){return y}else{return x}break;case"number":if(w!==0){return y}else{return x}break;case"string":z=w.toUpperCase();if(z==="TRUE"){return y}else{if(z==="FALSE"){return x}else{if(z.replace(/ /g,"").length>0){return y}}}break}if(w){return y}return y},NOT:function(x){var w;if(!x.valueOf()){w=new v(true);w.html="TRUE"}else{w=new v(false);w.html="FALSE"}return w},OR:function(){var y=arguments,w,z=y.length-1,x;if(z>-1){do{x=y[z].valueOf();if(x){w=new v(true);w.html="TRUE";return w}}while(z--)}w=new v(false);w.html="FALSE";return w},TRUE:function(){var w=new v(true);w.html="TRUE";return w},GREATER:function(y,x){var w;if(y>x){w=new v(true);w.html="TRUE"}else{w=new v(false);w.html="FALSE"}return w},LESS:function(y,x){var w;if(y<x){w=new v(true);w.html="TRUE"}else{w=new v(false);w.html="FALSE"}return w},EQUAL:function(z,y){var w,A,x;if(z===undefined||z===null){z=""}if(y===undefined||y===null){y=""}A=z+"";x=y+"";if(A==x){w=new v(true);w.html="TRUE"}else{w=new v(false);w.html="FALSE"}return w},GREATER_EQUAL:function(y,x){var w;if(y>=x){w=new v(true);w.html="TRUE"}else{w=new v(false);w.html="FALSE"}return w},LESS_EQUAL:function(y,x){var w;if(y<=x){w=new v(true);w.html="TRUE"}else{w=new v(false);w.html="FALSE"}return w},IMG:function(x){var w=new q("");w.html=d(m.createElement("img")).attr("src",x);return w},TRIM:function(w){if(typeof(w)=="string"){w=d.trim(w)}return w},HYPERLINK:function(x,y){y=y||"LINK";var w=new q(y.valueOf()),z=m.createElement("a");z.setAttribute("href",x);z.setAttribute("target","_new");z.innerText=z.textContent=y;w.html=z;return w},DROPDOWN:function(){var G=this,B=this.jS,y=this.td,E,F,A,D,x,H,z=0,C;if(y!==null){d(y).children().detach();A=G.value.html}if(A===undefined||G.needsUpdated||A.length<1){F=c.flatten(arguments);F=c.unique(F);if(this.id!==null){x=this.id+"-dropdown"}else{if(y!==null){x="dropdown"+this.sheetIndex+"_"+this.rowIndex+"_"+this.columnIndex+"_"+B.I}}D=m.createElement("select");D.setAttribute("name",x);D.setAttribute("id",x);D.className="jSDropdown";D.cell=this;D.onmouseup=function(){if(this.cell.td!==null){B.cellEdit(this.cell.td)}};D.onchange=function(){E=new q(this.value);E.html=D;E.cell=G;G.value=E;G.setNeedsUpdated(false);B.resolveCell(G);B.trigger("sheetCellEdited",[G])};C=(F.length<=50?F.length:50);for(;z<C;z++){if(F[z]){var w=m.createElement("option");w.setAttribute("value",F[z]);w.text=w.innerText=F[z];D.appendChild(w)}}if(!B.s.editable){D.setAttribute("disabled",true)}else{B.s.parent.bind("sheetKill",function(){y.innerText=y.textContent=G.value=D.value})}D.value=G.value||F[0]}if(typeof G.value!=="object"){H=new q(G.value)}else{H=G.value}H.html=D;return H},RADIO:function(){var I=this,C=this.jS,z=this.td,H,G,B,D,w,y,x,J;if(z!==null){B=I.value.html;d(z).children().detach()}if(B===undefined||B.length<1||I.needsUpdated){H=c.flatten(arguments);H=c.unique(H);D=[];if(this.id!==null){x=this.id+"-radio"}else{if(z!==null){x="radio"+this.sheetIndex+"_"+this.rowIndex+"_"+this.columnIndex+"_"+C.I}}B=m.createElement("span");B.className="jSRadio";B.onmousedown=function(){if(this.cell.td!==null){C.cellEdit(this.cell.td)}};B.cell=I;for(var A=0;A<(H.length<=25?H.length:25);A++){if(H[A]){var F=m.createElement("input"),E=m.createElement("span");F.setAttribute("type","radio");F.setAttribute("name",x);F.className=x;F.value=H[A];F.onchange=function(){G=new q(this.value);G.html=B;G.cell=I;I.value=G;I.setNeedsUpdated(false);C.resolveCell(I);C.trigger("sheetCellEdited",[I])};D.push(F);if(H[A]==I.value){F.setAttribute("checked","true")}E.textContent=E.innerText=H[A];B.appendChild(F);B.input=F;E.onclick=function(){d(this).prev().click()};B.appendChild(E);B.appendChild(m.createElement("br"))}}w=d(D);if(!C.s.editable){I.value=w.filter(":checked").val();w.attr("disabled",true)}else{C.s.parent.bind("sheetKill",function(){I.value=w.filter(":checked").val();z.textContent=z.innerText=I.value})}}if(typeof I.value!=="object"){J=new q(I.value)}else{J=I.value}J.html=B;return J},CHECKBOX:function(D){if(d.isArray(D)){D=D[0]}var E=this,z=this.jS,x=this.td,y,B,A,w,C,F;if(x!==null){y=E.value.html;d(x).children().detach()}if(y===undefined||y.length<1||E.needsUpdated){if(this.id!==null){w=this.id+"-checkbox"}else{if(x!==null){w="checkbox"+this.sheet+"_"+this.rowIndex+"_"+this.columnIndex+"_"+z.I}}A=m.createElement("input");A.setAttribute("type","checkbox");A.setAttribute("name",w);A.setAttribute("id",w);A.className=w;A.value=D;A.onchange=function(){if(d(this).is(":checked")){C=new q(D)}else{C=new q("")}C.html=y;C.cell=E;E.value=C;E.setNeedsUpdated(false);z.resolveCell(E);z.trigger("sheetCellEdited",[E])};if(!z.s.editable){A.setAttribute("disabled","true")}else{z.s.parent.bind("sheetKill",function(){E.value=(E.value=="true"||d(A).is(":checked")?D:"");if(E.td!==null){E.td.innerText=E.td.textContent=E.cell.value}})}y=m.createElement("span");y.className="jSCheckbox";y.appendChild(A);B=m.createElement("span");B.textContent=B.innerText=D;y.appendChild(B);y.appendChild(m.createElement("br"));y.onmousedown=function(){if(this.cell.td!==null){z.cellEdit(this.cell.td)}};y.cell=E;if(D==E.value||E.value==="true"){A.checked=true}}if(E.value==="true"||d(A).is(":checked")){F=new q(D)}else{F=new q("")}F.html=y;return F},BARCHART:function(x,y,z){var w=new q("");w.html=h.chart.call(this,{type:"bar",data:x,legend:y,title:z});return w},HBARCHART:function(x,y,z){var w=new q("");w.html=h.chart.call(this,{type:"hbar",data:x,legend:y,title:z});return w},LINECHART:function(y,x){var w=new q("");w.html=h.chart.call(this,{type:"line",x:{data:y},y:{data:x},title:""});return w},PIECHART:function(x,y,z){var w=new q("");w.html=h.chart.call(this,{type:"pie",data:x,legend:y,title:z});return w},DOTCHART:function(C,A,x,z,y,B){var w=new q("");w.html=h.chart.call(this,{type:"dot",data:(x?x:C),x:{data:C,legend:z},y:{data:(A?A:C),legend:(y?y:z)},title:B});return w},CELLREF:function(w){return(this.jS.spreadsheets[w]?this.jS.spreadsheets[w]:"Cell Reference Not Found")},CALCTIME:function(z,x){z=z||"";x=x||"";var w=this,y=this.jS;this.jS.s.parent.one("sheetCalculation",function(){y.time.last=y.calcLast;w.td.text(z+y.time.diff()+x)});return""},HLOOKUP:function(C,z,y,E){if(C===undefined){return null}var A=this.jS,D,w,F="",x=0,B=z.length;y=y||1;E=E!==undefined?E:true;if(C!==undefined||((isNaN(C)&&C!="#REF!")||C.length===0)){for(;x<B;x++){if(z[x].toString()==C){D=z[x];break}}}else{c.getClosestNum(C,z,function(H,G){if(E){D=H}else{if(H==C){D=H}}})}if(D!==undefined){w=D.cell;w=A.getCell(w.sheetIndex,y,w.columnIndex);if(w!==null){F=w.updateValue()}else{F=""}}else{F=new q();F.html="#N/A"}return F},VLOOKUP:function(C,z,y,E){if(C===undefined){return null}var A=this.jS,D,w,F,x=0,B=z.length;E=E!==undefined?E:true;if((isNaN(C)&&C!="#REF!")||C.length===0){for(;x<B;x++){if(z[x].toString()==C){D=z[x];break}}}else{c.getClosestNum(C,z,function(H,G){if(E){D=H}else{if(H==C){D=H}}})}if(D!==undefined){w=D.cell;w=A.getCell(w.sheetIndex,w.rowIndex,y);if(w!==null){F=w.value}else{F=""}}else{F=new q();F.html="#N/A"}return F},TRANSPOSE:function(I){var O=0,D=this.jS,C=this.sheetIndex,G=I[0],y=G.cell,z=I[I.length-1],K=z.cell,w=y.rowIndex,B=y.columnIndex,F,P,x,A=[],N,H,E=[],J,M=I.length,L,Q=false;for(;O<M;O++){J=I[O];x=J.cell;F=this.rowIndex+(x.columnIndex-B);P=this.columnIndex+(x.rowIndex-w);H=D.getCell(this.sheetIndex,F,P);if(H!==null&&H!==this){if(H.value!=""){Q=true}E.push(H);A.push(x)}}if(Q){L=new q("");L.html="#REF!";return L}O=0;M=E.length;for(;O<M;O++){H=E[O];if(H!==this){x=A[O];H.defer=x;H.setNeedsUpdated();N=H.updateValue();H.addDependency(this);H.td.innerHTML=N}}return G},THISROWCELL:function(w){var x=this.jS;if(isNaN(w)){w=h.columnLabelIndex(w)}return x.getCell(this.sheetIndex,this.rowIndex,w).updateValue()},THISCOLCELL:function(x){var w=this.jS;return w.getCell(this.sheetIndex,x,this.columnIndex).updateValue()}};var s={BACKSPACE:8,CAPS_LOCK:20,COMMA:188,CONTROL:17,ALT:18,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,C:67,F:70,V:86,X:88,Y:89,Z:90,UNKNOWN:229};var c=f.arrHelpers={math:g,toNumbers:function(w){w=this.flatten(w);var x=w.length-1;if(x<0){return[]}do{if(w[x]){w[x]=d.trim(w[x]);if(isNaN(w[x])){w[x]=0}else{w[x]=w[x]*1}}else{w[x]=0}}while(x--);return w},unique:function(w){var A={},y,x=w.length,z=[];for(y=0;y<x;y+=1){A[w[y]]=w[y]}for(y in A){z.push(A[y])}return z},flatten:function(x){var A=[],z,y=0,w=x.length;for(;y<w;y++){z=x[y];if(z instanceof Array){A=A.concat(this.flatten(z))}else{A=A.concat(z)}}return A},insertAt:function(w,y,x){d(y).each(function(){if(x>-1&&x<=w.length){w.splice(x,0,this)}});return w},indexOfNearestLessThan:function(C,B){if(C.length===0){return -1}var z=C.length-1,w=0,x,y,A=-1;if(C[z]<B){return z}while(w<=z){x=(w+z)>>1;y=C[x];if(y>B){z=x-1}else{if(y<B){A=x;w=x+1}else{A=w;break}}}return A},ofSet:function(F,z){if(F.length===0){return null}var x=F.length-1,C=x,y=F[x],D=F[0],G=0,H,I,E=-1,B,A=-1,w=-1;if(F[x]<z||F[0]>z){return null}else{while(G<=x){H=(G+x)>>1;I=F[H];if(I>z){E=H;x=H-1}else{if(I<z){G=H+1}else{E=x;break}}}}if(E>-1){B=E;while(B<=C){if(F[B]+1===F[B+1]){B++}else{A=F[B];break}}if(A===-1){A=y}B=E;while(B>=0){if(F[B]-1===F[B-1]){B--}else{w=F[B];break}}if(w===-1){w=D}}return{start:w,end:A}},closest:function(B,x,y,w){y=y||0;w=w||B.length-1;var A,z;while(true){A=((y+w)>>1);z=B[A];if((A===w||A===y)&&z!==x){return z}if(z>x){w=A}else{if(z<x){y=A}else{return z}}}},getClosestNum:function(y,w,A){var z=0,x,D,C,B;if(w.length){D=w[0];x=z;for(z;z<w.length;z++){C=g.abs(y-D);B=g.abs(y-w[z]);if(B<C){x=z;D=w[z]}C=null;B=null}if(A){return A(D,x)}return D}return false},levenshtein:(function(){var w=[];return function(G,F){if(G===F){return 0}else{var D=G.length,B=F.length;if(D&&B){var y=0,x=0,E,C,A,z,H=w;while(y<D){H[y]=++y}while(x<B){z=F.charCodeAt(x);E=x;++x;C=x;for(y=0;y<D;++y){A=E+(G.charCodeAt(y)===z?0:1);E=H[y];C=C<E?(C<A?C+1:A):(E<A?E+1:A);H[y]=C}}return C}else{return D+B}}}})(),lSearch:function(x,B){var y=0,z,w=x.length,A=-1,C;for(;y<w;y++){z=x[y];C=new t(this.levenshtein(z,B));C.item=z;if(C<A){A=C}}return(C!==undefined?C.item:null)}};var e={dayDiv:86400000,math:g,toCentury:function(w,x){x=x||86400000;return this.math.round(this.math.abs((new a(1900,0,-1))-w)/x)},get:function(x,y){y=y||86400000;if(x.getMonth){return x}else{if(isNaN(x)){return new a(Globalize.parseDate(x))}else{x*=y;var w=(new a(1900,0,-1))*1;x+=w;x=new a(x);return x}}},week:function(w,y){y=y||86400000;var x=new a(w.getFullYear(),0,1);return this.math.ceil((((w-x)/y)+x.getDay()+1)/7)},toString:function(w,x){if(!x){return Globalize.format(w)}return Globalize.format(w,Globalize.culture().calendar.patterns[x])},diff:function(A,x,z,y){y=y||86400000;switch(z){case 0:return this.days360Nasd(A,x,0,true);case 1:case 2:case 3:var w=this.math.abs(x-A)/y;return w;case 4:return this.days360Euro(A,x)}return 0},diffMonths:function(y,x){var w;w=(x.getFullYear()-y.getFullYear())*12;w-=y.getMonth()+1;w+=x.getMonth()+1;return w},days360:function(y,B,z,x,w,A){return((B-y)*360)+((x-z)*30)+(A-w)},days360Nasd:function(x,A,w,y){var z=x.getDate(),E=x.getMonth(),D=x.getFullYear(),C=A.getDate(),B=A.getMonth(),F=A.getFullYear();if((B==2&&this.isEndOfMonth(C,B,F))&&((E==2&&this.isEndOfMonth(z,E,D))||w==3)){C=30}if(C==31&&(z>=30||w==3)){C=30}if(z==31){z=30}if(y&&E==2&&this.isEndOfMonth(z,E,D)){z=30}return this.days360(D,F,E,B,z,C)},days360Euro:function(D,y){var w=D.getDate(),A=D.getMonth(),z=D.getFullYear(),B=y.getDate(),x=y.getMonth(),C=y.getFullYear();if(w==31){w=30}if(B==31){B=30}return this.days360(z,C,A,x,w,B)},isEndOfMonth:function(w,y,x){return w==(new a(x,y+1,0,23,59,59)).getDate()},isLeapYear:function(w){return new a(w,1,29).getMonth()==1},calcAnnualBasis:function(w,y,C){switch(C){case 0:case 2:case 4:return 360;case 3:return 365;case 1:var x=w.getDate(),E=w.getMonth(),B=w.getFullYear(),z=y.getDate(),A=y.getMonth(),F=y.getFullYear(),G=0;if(B==F){if(this.isLeapYear(B)){G=366}else{G=365}}else{if(((F-1)==B)&&((E>A)||((E==A)&&x>=z))){if(this.isLeapYear(B)){if(E<2||(E==2&&x<=29)){G=366}else{G=365}}else{if(this.isLeapYear(F)){if(A>2||(A==2&&z==29)){G=366}else{G=365}}else{G=365}}}else{for(var D=B;D<=F;D++){if(this.isLeapYear(D)){G+=366}else{G+=365}}G=G/(F-B+1)}}return G}return 0},lastDayOfMonth:function(w){w.setDate(0);return w.getDate()},isLastDayOfMonth:function(w){return(w.getDate()==this.lastDayOfMonth(w))}};var j=f.times={math:g,fromMath:function(y){var w={},x=this;w.hour=((y*24)+"").split(".")[0]*1;w.minute=function(z){z=x.math.round(z*24*100)/100;z=(z+"").split(".");var A=0;if(z[1]){if(z[1].length<2){z[1]+="0"}A=z[1]*0.6}return x.math.round(A)}(y);w.second=function(C){C=x.math.round(C*24*10000)/10000;C=(C+"").split(".");var A=0;if(C[1]){for(var B=0;B<4;B++){if(!C[1].charAt(B)){C[1]+="0"}}var z=((C[1]*0.006)+"").split(".");if(z[1]){if(z[1]&&z[1].length>2){z[1]=z[1].substr(0,2)}return x.math.round(z[1]*0.6)}}return A}(y);return w},fromString:function(y,C){var z=new a(),D=y,w,B,A,x,E;if(C){E=D.substr(-2).toLowerCase();D=D.replace(/(am|pm)/i,"")}D=D.split(":");B=D[0]*1;A=D[1]*1;x=(D[2]?D[2]:0)*1;if(C&&E=="pm"){B+=12}return o.TIME(B,A,x)}};d.extend(g,{log10:function(w){return g.log(w)/2.302585092994046},signum:function(w){return(w/g.abs(w))||w},log1p:function(w){var y=0,A=50;if(w<=-1){return"-INF"}if(w<0||w>1){return g.log(1+w)}for(var z=1;z<A;z++){if((z%2)===0){y-=g.pow(w,z)/z}else{y+=g.pow(w,z)/z}}return y}});var n=function(){var C=m,F=d(m.createElement("p")).css({width:"100%",height:"100%"}),E=d(m.createElement("div")).css({position:"absolute",width:"100px",height:"100px",top:"0",left:"0",visibility:"hidden",overflow:"hidden"}).append(F);d(m.body).append(E);var z=F.width(),B=F.height();E.css("overflow","scroll");var x=F.width(),A=F.height();if(z==x&&E[0].clientWidth){x=E[0].clientWidth}if(B==A&&E[0].clientHeight){A=E[0].clientHeight}E.detach();var D=z-x,y=B-A;return{width:D||15,height:y||15}};var k=function(){var w="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",y=d(m.createElement("span")).html(w).appendTo("body"),x={width:y.width()/w.length,height:y.height()};y.remove();return x};var p=function(w,D,A,z,C){z=z||"#"+g.floor(g.random()*16777215).toString(16);if(A){var B=d([]);B=B.add(p(A.left,A.top,null,z,"top-left"));B=B.add(p(A.right,A.top,null,z,"top-right"));B=B.add(p(A.left,A.bottom,null,z,"bottom-left"));B=B.add(p(A.right,A.bottom,null,z,"bottom-right"));return B}return d('<div style="width: 10px; height: 10px; position: absolute;"></div>').css("top",(D-5)+"px").css("left",(w+5)+"px").css("background-color",z).click(function(){console.log(C||"none")}).appendTo("body")};d.printSource=function(y){var x=win.open();x.document.write("<html><body><xmp>"+y+"\n</xmp></body></html>");x.document.close()};if(!Object.getPrototypeOf){Object.getPrototypeOf=function(w){return w||{}}}if(!Array.prototype.indexOf){d.sheet.max=60;Array.prototype.indexOf=function(y,z){for(var x=(z||0),w=this.length;x<w;x++){if(this[x]===y){return x}}return -1}}return l})(jQuery,document,window,Date,String,Number,Boolean,Math,RegExp,Error);var parser=(function(){var U=function(Y,X,Z,W){for(Z=Z||{},W=Y.length;W--;Z[Y[W]]=X){}return Z},n=[1,5],m=[1,6],l=[1,8],k=[1,9],j=[1,10],h=[1,13],f=[1,11],d=[1,12],c=[1,14],b=[1,15],T=[1,20],S=[1,18],R=[1,21],Q=[1,22],P=[1,17],O=[1,24],N=[1,25],M=[1,26],L=[1,27],K=[1,28],J=[1,29],I=[1,30],H=[1,31],G=[1,32],F=[4,13,14,15,17,18,19,20,21,22,23,35,36],E=[1,35],D=[1,36],B=[1,37],A=[4,13,14,15,17,18,19,20,21,22,23,35,36,38],z=[4,13,14,15,17,18,19,20,21,22,23,35,36,39],y=[4,13,14,15,17,18,19,20,21,22,23,29,35,36],x=[4,14,15,17,18,19,20,35,36],w=[1,71],v=[4,14,17,18,19,35,36],t=[4,14,15,17,18,19,20,21,22,35,36],s=[17,35,36];var C={trace:function r(){},yy:{},symbols_:{error:2,expressions:3,EOF:4,expression:5,variableSequence:6,TIME_AMPM:7,TIME_24:8,number:9,STRING:10,ESCAPED_STRING:11,LETTERS:12,"&":13,"=":14,"+":15,"(":16,")":17,"<":18,">":19,"-":20,"*":21,"/":22,"^":23,E:24,FUNCTION:25,expseq:26,cellRange:27,cell:28,":":29,SHEET:30,"!":31,NUMBER:32,"$":33,REF:34,";":35,",":36,VARIABLE:37,DECIMAL:38,"%":39,"$accept":0,"$end":1},terminals_:{2:"error",4:"EOF",7:"TIME_AMPM",8:"TIME_24",10:"STRING",11:"ESCAPED_STRING",12:"LETTERS",13:"&",14:"=",15:"+",16:"(",17:")",18:"<",19:">",20:"-",21:"*",22:"/",23:"^",24:"E",25:"FUNCTION",29:":",30:"SHEET",31:"!",32:"NUMBER",33:"$",34:"REF",35:";",36:",",37:"VARIABLE",38:"DECIMAL",39:"%"},productions_:[0,[3,1],[3,2],[5,1],[5,1],[5,1],[5,1],[5,1],[5,1],[5,1],[5,3],[5,3],[5,3],[5,3],[5,4],[5,4],[5,4],[5,3],[5,3],[5,3],[5,3],[5,3],[5,3],[5,2],[5,2],[5,1],[5,3],[5,4],[5,1],[27,1],[27,3],[27,3],[27,5],[28,2],[28,3],[28,3],[28,4],[28,1],[28,2],[28,2],[28,2],[28,3],[28,3],[28,3],[28,3],[28,3],[28,3],[28,4],[28,4],[28,4],[26,1],[26,2],[26,2],[26,3],[26,3],[6,1],[6,3],[9,1],[9,3],[9,2]],performAction:function q(Y,aa,o,ab,ad,ae,W){var X=ae.length-1;switch(ad){case 1:return null;break;case 2:var Z=ab.types;ab.types=[];return Z;break;case 3:var ac={t:"m",m:"variable",a:[ae[X]]};this.$=ab.types.length;ab.types.push(ac);break;case 4:var ac={t:"m",m:"time",a:[ae[X],true]};this.$=ab.types.length;ab.types.push(ac);break;case 5:var ac={t:"m",m:"time",a:[ae[X]]};this.$=ab.types.length;ab.types.push(ac);break;case 6:var ac={t:"m",m:"number",a:[ae[X]]};this.$=ab.types.length;ab.types.push(ac);break;case 7:var ac={t:"v",v:ab.escape(ae[X].substring(1,ae[X].length-1))};this.$=ab.types.length;ab.types.push(ac);break;case 8:var ac={t:"v",v:ab.escape(ae[X].substring(2,ae[X].length-2))};this.$=ab.types.length;ab.types.push(ac);break;case 9:var ac={t:"v",v:ae[X]};ab.types.push(ac);break;case 10:var ac={t:"m",m:"concatenate",a:[ae[X-2],ae[X]]};this.$=ab.types.length;ab.types.push(ac);break;case 11:var ac={t:"m",m:"callFunction",a:["EQUAL",[ae[X-2],ae[X]]]};this.$=ab.types.length;ab.types.push(ac);break;case 12:var ac={t:"m",m:"performMath",a:["+",ae[X-2],ae[X]]};this.$=ab.types.length;ab.types.push(ac);break;case 13:this.$=ae[X-1];break;case 14:var ac={t:"m",m:"callFunction",a:["LESS_EQUAL",[ae[X-3],ae[X]]]};this.$=ab.types.length;ab.types.push(ac);break;case 15:var ac={t:"m",m:"callFunction",a:["GREATER_EQUAL",[ae[X-3],ae[X]]]};this.$=ab.types.length;ab.types.push(ac);break;case 16:var ac={t:"m",m:"not",a:[ae[X-3],ae[X]]};this.$=ab.types.length;ab.types.push(ac);break;case 17:var ac={t:"m",m:"callFunction",a:["GREATER",[ae[X-2],ae[X]]]};this.$=ab.types.length;ab.types.push(ac);break;case 18:var ac={t:"m",m:"callFunction",a:["LESS",[ae[X-2],ae[X]]]};this.$=ab.types.length;ab.types.push(ac);break;case 19:var ac={t:"m",m:"performMath",a:["-",ae[X-2],ae[X]]};this.$=ab.types.length;ab.types.push(ac);break;case 20:var ac={t:"m",m:"performMath",a:["*",ae[X-2],ae[X]]};this.$=ab.types.length;ab.types.push(ac);break;case 21:var ac={t:"m",m:"performMath",a:["/",ae[X-2],ae[X]]};this.$=ab.types.length;ab.types.push(ac);break;case 22:var ac={t:"m",m:"performMath",a:["^",ae[X-2],ae[X]]};this.$=ab.types.length;ab.types.push(ac);break;case 23:var ac={t:"m",m:"invertNumber",a:[ae[X]]};this.$=ab.types.length;ab.types.push(ac);break;case 24:var ac={t:"m",m:"number",a:[ae[X]]};this.$=ab.types.length;ab.types.push(ac);break;case 25:break;case 26:var ac={t:"m",m:"callFunction",a:[ae[X-2]]};this.$=ab.types.length;ab.types.push(ac);break;case 27:var ac={t:"m",m:"callFunction",a:[ae[X-3],ae[X-1]]};this.$=ab.types.length;ab.types.push(ac);break;case 29:var ac={t:"l",m:"cellValue",a:[ae[X]]};this.$=ab.types.length;ab.types.push(ac);break;case 30:var ac={t:"l",m:"cellRangeValue",a:[ae[X-2],ae[X]]};this.$=ab.types.length;ab.types.push(ac);break;case 31:var ac={t:"l",m:"remoteCellValue",a:[ae[X-2],ae[X]]};this.$=ab.types.length;ab.types.push(ac);break;case 32:var ac={t:"l",m:"remoteCellRangeValue",a:[ae[X-4],ae[X-2],ae[X]]};this.$=ab.types.length;ab.types.push(ac);break;case 33:var ac={t:"cell",c:ae[X-1],r:ae[X]};this.$=ab.types.length;ab.types.push(ac);break;case 34:var ac={t:"cell",c:ae[X-1],r:ae[X]};this.$=ab.types.length;ab.types.push(ac);break;case 35:case 36:var ac={t:"cell",c:ae[X-2],r:ae[X]};this.$=ab.types.length;ab.types.push(ac);break;case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:return"#REF!";break;case 50:this.$=[ae[X]];break;case 53:ae[X-2].push(ae[X]);this.$=ae[X-2];break;case 54:ae[X-2].push(ae[X]);this.$=ae[X-2];break;case 55:this.$=[ae[X]];break;case 56:this.$=(ae[X-2] instanceof Array?ae[X-2]:[ae[X-2]]);this.$.push(ae[X]);break;case 57:this.$=ae[X];break;case 58:this.$=(ae[X-2]+"."+ae[X])*1;break;case 59:this.$=ae[X-1]*0.01;break}},table:[{3:1,4:[1,2],5:3,6:4,7:n,8:m,9:7,10:l,11:k,12:j,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:T,32:S,33:R,34:Q,37:P},{1:[3]},{1:[2,1]},{4:[1,23],13:O,14:N,15:M,18:L,19:K,20:J,21:I,22:H,23:G},U(F,[2,3],{38:[1,33]}),U(F,[2,4]),U(F,[2,5]),U(F,[2,6],{39:[1,34]}),U(F,[2,7]),U(F,[2,8]),U(F,[2,9],{32:E,33:D,34:B}),{5:38,6:4,7:n,8:m,9:7,10:l,11:k,12:j,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:T,32:S,33:R,34:Q,37:P},{5:39,6:4,7:n,8:m,9:7,10:l,11:k,12:j,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:T,32:S,33:R,34:Q,37:P},{5:40,6:4,7:n,8:m,9:7,10:l,11:k,12:j,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:T,32:S,33:R,34:Q,37:P},U(F,[2,25]),{16:[1,41]},U(F,[2,28]),U(A,[2,55]),U(z,[2,57],{38:[1,42]}),U(F,[2,29],{29:[1,43]}),{31:[1,44]},{12:[1,45],34:[1,46]},U(y,[2,37],{32:[1,47],33:[1,49],34:[1,48]}),{1:[2,2]},{5:50,6:4,7:n,8:m,9:7,10:l,11:k,12:j,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:T,32:S,33:R,34:Q,37:P},{5:51,6:4,7:n,8:m,9:7,10:l,11:k,12:j,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:T,32:S,33:R,34:Q,37:P},{5:52,6:4,7:n,8:m,9:7,10:l,11:k,12:j,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:T,32:S,33:R,34:Q,37:P},{5:55,6:4,7:n,8:m,9:7,10:l,11:k,12:j,14:[1,53],15:h,16:f,19:[1,54],20:d,24:c,25:b,27:16,28:19,30:T,32:S,33:R,34:Q,37:P},{5:57,6:4,7:n,8:m,9:7,10:l,11:k,12:j,14:[1,56],15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:T,32:S,33:R,34:Q,37:P},{5:58,6:4,7:n,8:m,9:7,10:l,11:k,12:j,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:T,32:S,33:R,34:Q,37:P},{5:59,6:4,7:n,8:m,9:7,10:l,11:k,12:j,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:T,32:S,33:R,34:Q,37:P},{5:60,6:4,7:n,8:m,9:7,10:l,11:k,12:j,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:T,32:S,33:R,34:Q,37:P},{5:61,6:4,7:n,8:m,9:7,10:l,11:k,12:j,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:T,32:S,33:R,34:Q,37:P},{37:[1,62]},U(z,[2,59]),U(y,[2,33]),{32:[1,63],34:[1,64]},U(y,[2,39]),{13:O,14:N,15:M,17:[1,65],18:L,19:K,20:J,21:I,22:H,23:G},U(x,[2,23],{13:O,21:I,22:H,23:G}),U(x,[2,24],{13:O,21:I,22:H,23:G}),{5:68,6:4,7:n,8:m,9:7,10:l,11:k,12:j,15:h,16:f,17:[1,66],20:d,24:c,25:b,26:67,27:16,28:19,30:T,32:S,33:R,34:Q,37:P},{32:[1,69]},{12:w,28:70,33:R,34:Q},{12:w,28:72,33:R,34:Q},{32:[1,73],33:[1,74],34:[1,75]},{32:[1,76],33:[1,78],34:[1,77]},U(y,[2,38]),U(y,[2,40]),{32:[1,79],34:[1,80]},U([4,17,35,36],[2,10],{13:O,14:N,15:M,18:L,19:K,20:J,21:I,22:H,23:G}),U([4,14,17,35,36],[2,11],{13:O,15:M,18:L,19:K,20:J,21:I,22:H,23:G}),U(x,[2,12],{13:O,21:I,22:H,23:G}),{5:81,6:4,7:n,8:m,9:7,10:l,11:k,12:j,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:T,32:S,33:R,34:Q,37:P},{5:82,6:4,7:n,8:m,9:7,10:l,11:k,12:j,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:T,32:S,33:R,34:Q,37:P},U(v,[2,18],{13:O,15:M,20:J,21:I,22:H,23:G}),{5:83,6:4,7:n,8:m,9:7,10:l,11:k,12:j,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:T,32:S,33:R,34:Q,37:P},U(v,[2,17],{13:O,15:M,20:J,21:I,22:H,23:G}),U(x,[2,19],{13:O,21:I,22:H,23:G}),U(t,[2,20],{13:O,23:G}),U(t,[2,21],{13:O,23:G}),U([4,14,15,17,18,19,20,21,22,23,35,36],[2,22],{13:O}),U(A,[2,56]),U(y,[2,35]),U(y,[2,45]),U(F,[2,13]),U(F,[2,26]),{17:[1,84],35:[1,85],36:[1,86]},U(s,[2,50],{13:O,14:N,15:M,18:L,19:K,20:J,21:I,22:H,23:G}),U(z,[2,58]),U(F,[2,30]),{32:E,33:D,34:B},U(F,[2,31],{29:[1,87]}),U(y,[2,34]),{32:[1,88]},U(y,[2,42]),U(y,[2,41]),U(y,[2,43]),{32:[1,89],34:[1,90]},U(y,[2,44]),U(y,[2,46]),U(v,[2,14],{13:O,15:M,20:J,21:I,22:H,23:G}),U(v,[2,16],{13:O,15:M,20:J,21:I,22:H,23:G}),U(v,[2,15],{13:O,15:M,20:J,21:I,22:H,23:G}),U(F,[2,27]),U(s,[2,51],{6:4,9:7,27:16,28:19,5:91,7:n,8:m,10:l,11:k,12:j,15:h,16:f,20:d,24:c,25:b,30:T,32:S,33:R,34:Q,37:P}),U(s,[2,52],{6:4,9:7,27:16,28:19,5:92,7:n,8:m,10:l,11:k,12:j,15:h,16:f,20:d,24:c,25:b,30:T,32:S,33:R,34:Q,37:P}),{12:w,28:93,33:R,34:Q},U(y,[2,36]),U(y,[2,47]),U(y,[2,49]),U(s,[2,53],{13:O,14:N,15:M,18:L,19:K,20:J,21:I,22:H,23:G}),U(s,[2,54],{13:O,14:N,15:M,18:L,19:K,20:J,21:I,22:H,23:G}),U(F,[2,32])],defaultActions:{2:[2,1],23:[2,2]},parseError:function g(W,o){if(o.recoverable){this.trace(W)}else{throw new Error(W)}},parse:function p(ah){var ap=this,ae=[0],ao=[],aA=[null],aj=[],aC=this.table,X="",ai=0,ay=0,Z=0,ag=2,an=1;var aa=aj.slice.call(arguments,1);var o=Object.create(this.lexer);var aB={yy:{}};for(var ax in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,ax)){aB.yy[ax]=this.yy[ax]}}o.setInput(ah,aB.yy);aB.yy.lexer=o;aB.yy.parser=this;if(typeof o.yylloc=="undefined"){o.yylloc={}}var Y=o.yylloc;aj.push(Y);var ab=o.options&&o.options.ranges;if(typeof aB.yy.parseError==="function"){this.parseError=aB.yy.parseError}else{this.parseError=Object.getPrototypeOf(this).parseError}function am(aF){ae.length=ae.length-2*aF;aA.length=aA.length-aF;aj.length=aj.length-aF}_token_stack:function al(){var aF;aF=o.lex()||an;if(typeof aF!=="number"){aF=ap.symbols_[aF]||aF}return aF}var aw,ar,ad,av,aE,ak,au={},aq,az,W,af;while(true){ad=ae[ae.length-1];if(this.defaultActions[ad]){av=this.defaultActions[ad]}else{if(aw===null||typeof aw=="undefined"){aw=al()}av=aC[ad]&&aC[ad][aw]}_handle_error:if(typeof av==="undefined"||!av.length||!av[0]){var ac;var at="";function aD(aG){var aF=ae.length-1;var aH=0;for(;;){if((ag.toString()) in aC[aG]){return aH}if(aG===0||aF<2){return false}aF-=2;aG=ae[aF];++aH}}if(!Z){ac=aD(ad);af=[];for(aq in aC[ad]){if(this.terminals_[aq]&&aq>ag){af.push("'"+this.terminals_[aq]+"'")}}if(o.showPosition){at="Parse error on line "+(ai+1)+":\n"+o.showPosition()+"\nExpecting "+af.join(", ")+", got '"+(this.terminals_[aw]||aw)+"'"}else{at="Parse error on line "+(ai+1)+": Unexpected "+(aw==an?"end of input":("'"+(this.terminals_[aw]||aw)+"'"))}return this.parseError(at,{text:o.match,token:this.terminals_[aw]||aw,line:o.yylineno,loc:Y,expected:af,recoverable:(ac!==false)})}else{if(ar!==an){ac=aD(ad)}}if(Z==3){if(aw===an||ar===an){throw new Error(at||"Parsing halted while starting to recover from another error.")}ay=o.yyleng;X=o.yytext;ai=o.yylineno;Y=o.yylloc;aw=al()}if(ac===false){throw new Error(at||"Parsing halted. No suitable error recovery rule available.")}am(ac);ar=(aw==ag?null:aw);aw=ag;ad=ae[ae.length-1];av=aC[ad]&&aC[ad][ag];Z=3}if(av[0] instanceof Array&&av.length>1){throw new Error("Parse Error: multiple actions possible at state: "+ad+", token: "+aw)}switch(av[0]){case 1:ae.push(aw);aA.push(o.yytext);aj.push(o.yylloc);ae.push(av[1]);aw=null;if(!ar){ay=o.yyleng;X=o.yytext;ai=o.yylineno;Y=o.yylloc;if(Z>0){Z--}}else{aw=ar;ar=null}break;case 2:az=this.productions_[av[1]][1];au.$=aA[aA.length-az];au._$={first_line:aj[aj.length-(az||1)].first_line,last_line:aj[aj.length-1].last_line,first_column:aj[aj.length-(az||1)].first_column,last_column:aj[aj.length-1].last_column};if(ab){au._$.range=[aj[aj.length-(az||1)].range[0],aj[aj.length-1].range[1]]}ak=this.performAction.apply(au,[X,ay,ai,aB.yy,av[1],aA,aj].concat(aa));if(typeof ak!=="undefined"){return ak}if(az){ae=ae.slice(0,-1*az*2);aA=aA.slice(0,-1*az);aj=aj.slice(0,-1*az)}ae.push(this.productions_[av[1]][0]);aA.push(au.$);aj.push(au._$);W=aC[ae[ae.length-2]][ae[ae.length-1]];ae.push(W);break;case 3:return true}}return true}};var e=function(X){var Y=function(){};Y.prototype=C.lexer;var W=function(){this.lexer=new Y();this.yy={types:[],escape:function(Z){return Z.replace(/&/gi,"&amp;").replace(/>/gi,"&gt;").replace(/</gi,"&lt;").replace(/\n/g,"\n<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp ").replace(/  /g,"&nbsp; ")},parseError:function(ab,aa){this.done=true;var Z=new String();Z.html="<pre>"+ab+"</pre>";Z.hash=aa;return Z}}};W.prototype=C;var o=new W();return o};if(typeof(window)!=="undefined"){window.Formula=e}else{C.Formula=e}var V=(function(){var X=({EOF:1,parseError:function Y(ag,af){if(this.yy.parser){this.yy.parser.parseError(ag,af)}else{throw new Error(ag)}},setInput:function(af,ag){this.yy=ag||this.yy||{};this._input=new a.InputReader(af);this._more=this._backtrack=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function(){var ag=this._input.ch();this.yytext+=ag;this.yyleng++;this.offset++;this.match+=ag;var af=ag.match(/(?:\r\n?|\n).*/g);if(af){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}return ag},unput:function(ah){var af=ah.length;var ag=ah.split(/(?:\r\n?|\n)/g);this._input.unCh(af,ah);this.yytext=this.yytext.substr(0,this.yytext.length-af);this.offset-=af;var aj=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);if(ag.length-1){this.yylineno-=ag.length-1}var ai=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:ag?(ag.length===aj.length?this.yylloc.first_column:0)+aj[aj.length-ag.length].length-ag[0].length:this.yylloc.first_column-af};if(this.options.ranges){this.yylloc.range=[ai[0],ai[0]+this.yyleng-af]}this.yyleng=this.yytext.length;return this},more:function(){this._more=true;return this},reject:function(){if(this.options.backtrack_lexer){this._backtrack=true}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}return this},less:function(af){this.unput(this.match.slice(af))},pastInput:function(){var af=this._input.toString();var ag=af.substr(0,af.length-this.match.length);return(ag.length>20?"...":"")+ag.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var af=this._input.input.substr(this._input.position,this._input.input.length-1);return(af.substr(0,20)+(af.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var af=this.pastInput();var ag=new Array(af.length+1).join("-");return af+this.upcomingInput()+"\n"+ag+"^"},test_match:function(aj,ah){var ak,af,ai,ag;if(this.options.backtrack_lexer){ai={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,yyleng:this.yyleng,offset:this.offset,_more:this._more,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){ai.yylloc.range=this.yylloc.range.slice(0)}}af=aj.match(/(?:\r\n?|\n).*/g);if(af){this.yylineno+=af.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:af!==null?af[af.length-1].length-af[af.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+aj.length};this.yytext+=aj;this.match+=aj;this.matches=aj;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._backtrack=false;this._input.addMatch(aj);ak=this.performAction.call(this,this.yy,this,ah,this.conditionStack[this.conditionStack.length-1]);if(this.done&&!this._input.done){this.done=false}if(ak){return ak}else{if(this._backtrack){for(ag in ai){if(ai.hasOwnProperty(ag)){this[ag]=ai[ag]}}return null}}return null},next:function(){if(this.done){return this.EOF}if(this._input.done){this.done=true}var aj,ah,af,ag;if(!this._more){this.yytext="";this.match=""}var ak=this._currentRules();for(var ai=0;ai<ak.length;ai++){af=this._input.match(this.rules[ak[ai]]);if(af!==null&&(ah===undefined||af[0].length>ah.length)){ah=af[0];ag=ai;if(this.options.backtrack_lexer){aj=this.test_match(af[0],ak[ai]);if(aj!==null){return aj}else{if(this._backtrack){ah=undefined;continue}else{return null}}}else{if(!this.options.flex){break}}}}if(ah!==undefined){aj=this.test_match(ah,ak[ag]);if(aj!==null){return aj}return null}if(this._input.done){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function o(){var af=this.next();if(af!==null){return af}else{return this.lex()}},begin:function W(af){this.conditionStack.push(af)},popState:function Z(){var af=this.conditionStack.length-1;if(af>0){return this.conditionStack.pop()}else{return this.conditionStack[0]}},_currentRules:function ae(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}else{return this.conditions.INITIAL.rules}},topState:function ac(af){af=this.conditionStack.length-1-Math.abs(af||0);if(af>=0){return this.conditionStack[af]}else{return"INITIAL"}},pushState:function ab(af){this.begin(af)},stateStackSize:function aa(){return this.conditionStack.length},options:{},performAction:function ad(aj,ag,ai,af){var ah=af;switch(ai){case 0:break;case 1:return 25;break;case 2:return 7;break;case 3:return 8;break;case 4:return 30;break;case 5:ag.yytext=ag.yytext.substring(1,ag.yytext.length-1);return 30;break;case 6:return 10;break;case 7:return 10;break;case 8:return 11;break;case 9:return 11;break;case 10:return 12;break;case 11:return 37;break;case 12:return 37;break;case 13:return 32;break;case 14:return 33;break;case 15:return 13;break;case 16:return" ";break;case 17:return 38;break;case 18:return 29;break;case 19:return 35;break;case 20:return 36;break;case 21:return 21;break;case 22:return 22;break;case 23:return 20;break;case 24:return 15;break;case 25:return 23;break;case 26:return 16;break;case 27:return 17;break;case 28:return 19;break;case 29:return 18;break;case 30:return"PI";break;case 31:return 24;break;case 32:return'"';break;case 33:return"'";break;case 34:return'"';break;case 35:return"'";break;case 36:return"!";break;case 37:return 14;break;case 38:return 39;break;case 39:return 34;break;case 40:return"#";break;case 41:return 4;break}},rules:[/^(?:\s+)/,/^(?:([A-Za-z]{1,})([A-Za-z_0-9]+)?(?=[(]))/,/^(?:([0]?[1-9]|1[0-2])[:][0-5][0-9]([:][0-5][0-9])?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm))/,/^(?:([0]?[0-9]|1[0-9]|2[0-3])[:][0-5][0-9]([:][0-5][0-9])?)/,/^(?:(([A-Za-z0-9]+))(?=[!]))/,/^(?:((['](\\[']|[^'])*['])|(["](\\["]|[^"])*["]))(?=[!]))/,/^(?:((['](\\[']|[^'])*['])))/,/^(?:((["](\\["]|[^"])*["])))/,/^(?:(([\\]['].+?[\\]['])))/,/^(?:(([\\]["].+?[\\]["])))/,/^(?:[A-Z]+(?=[0-9$]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\$)/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:PI\b)/,/^(?:E\b)/,/^(?:")/,/^(?:')/,/^(?:\\")/,/^(?:\\')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:#REF!)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41],inclusive:true}}});return X})();C.lexer=V;function a(){this.yy={}}a.prototype=C;a.InputReader=(function(X,W,aa){var Z=RegExp.prototype.sticky!==undefined,ai,af,ag,ab;function aj(ak){this.done=false;this.input=ak;this.length=ak.length;this.matches=[];this.position=0}if(Z){aj.prototype={addMatch:function ah(ak){this.matches.push(ak);this.position+=ak.length;this.done=(this.position>=this.length)},ch:function o(){var ak=this.input[this.position];this.addMatch(ak);return ak},unCh:function ae(ak){this.position-=ak;this.position=X.max(0,this.position);this.done=(this.position>=this.length)},substring:function ad(al,ak){al=(al!=0?this.position+al:this.position);ak=(ak!=0?al+ak:this.length);return this.input.substring(al,ak)},match:function ac(al){var ak;al.lastIndex=this.position;if((ak=al.exec(this.input))!==null){return ak}return null},toString:function Y(){return this.matches.join("")}};ai=aa.rules;ag=ai.length;ab=0;for(;ab<ag;ab++){af=ai[ab];ai[ab]=new RegExp(af.source.substring(1),"y")}}else{aj.prototype={addMatch:function ah(ak){this.input=this.input.slice(ak.length);this.matches.push(ak);this.position+=ak.length;this.done=(this.position>=this.length)},ch:function o(){var ak=this.input[0];this.addMatch(ak);return ak},unCh:function ae(al,ak){this.position-=al;this.position=X.max(0,this.position);this.input=ak+this.input;this.done=(this.position>=this.length)},substring:function ad(al,ak){al=(al!=0?this.position+al:this.position);ak=(ak!=0?al+ak:this.length);return this.input.substring(al,ak)},match:function ac(am){var al,ak=this.input;if((al=ak.match(am))!==null){return al}return null},toString:function Y(){return this.matches.join("")}}}return aj})(Math,C,V);C.Parser=a;return new a})();if(typeof require!=="undefined"&&typeof exports!=="undefined"){exports.parser=parser;exports.Parser=parser.Parser;exports.parse=function(){return parser.parse.apply(parser,arguments)};exports.main=function commonjsMain(a){if(!a[1]){console.log("Usage: "+a[0]+" FILE");process.exit(1)}var b=require("fs").readFileSync(require("path").normalize(a[1]),"utf8");return exports.parser.parse(b)};if(typeof module!=="undefined"&&require.main===module){exports.main(process.argv.slice(1))}}var parser=(function(){var p=function(y,x,z,w){for(z=z||{},w=y.length;w--;z[y[w]]=x){}return z},m=[1,10],k=[1,11],j=[1,12],h=[1,13],g=[5,7,8,9,10],f=[1,19],c=[1,20],a=[5,7,8,9,10,12,13],t=[1,21],s=[5,7,8,9,10,12,13,14,16];var l={trace:function q(){},yy:{},symbols_:{error:2,grid:3,rows:4,EOF:5,row:6,END_OF_LINE:7,END_OF_LINE_WITH_EMPTY_NEXT_FIRST_COLUMN:8,END_OF_LINE_WITH_NO_COLUMNS:9,END_OF_LINE_WITH_EMPTY_COLUMN:10,string:11,COLUMN_EMPTY:12,COLUMN_STRING:13,CHAR:14,QUOTE_ON:15,QUOTE_OFF:16,"$accept":0,"$end":1},terminals_:{2:"error",5:"EOF",7:"END_OF_LINE",8:"END_OF_LINE_WITH_EMPTY_NEXT_FIRST_COLUMN",9:"END_OF_LINE_WITH_NO_COLUMNS",10:"END_OF_LINE_WITH_EMPTY_COLUMN",12:"COLUMN_EMPTY",13:"COLUMN_STRING",14:"CHAR",15:"QUOTE_ON",16:"QUOTE_OFF"},productions_:[0,[3,2],[3,1],[4,1],[4,1],[4,1],[4,1],[4,1],[4,2],[4,2],[4,2],[4,2],[4,3],[4,3],[4,3],[4,3],[6,1],[6,1],[6,2],[6,3],[6,1],[6,2],[6,3],[11,1],[11,2],[11,3]],performAction:function e(o,x,y,B,A,w,z){var v=w.length-1;switch(A){case 1:return w[v-1];break;case 2:return[[""]];break;case 3:this.$=[w[v]];break;case 4:this.$=[];break;case 5:this.$=[""];break;case 6:this.$=[""];break;case 7:this.$=[""];break;case 8:this.$=w[v-1];break;case 9:w[v-1].push([""]);this.$=w[v-1];break;case 10:w[v-1].push([""]);this.$=w[v-1];break;case 11:w[v-1][w[v-1].length-1].push("");this.$=w[v-1];break;case 12:w[v-2].push(w[v]);this.$=w[v-2];break;case 13:w[v].unshift("");w[v-2].push(w[v]);this.$=w[v-2];break;case 14:w[v-2].push([""]);w[v-2].push(w[v]);this.$=w[v-2];break;case 15:w[v-2][w[v-2].length-1].push("");w[v-2].push(w[v]);this.$=w[v-2];break;case 16:this.$=[w[v].join("")];break;case 17:this.$=[""];break;case 18:w[v-1].push("");this.$=w[v-1];break;case 19:w[v-2].push("");w[v-2].push(w[v].join(""));this.$=w[v-2];break;case 20:break;case 21:break;case 22:w[v-2].push(w[v].join(""));this.$=w[v-2];break;case 23:this.$=[w[v]];break;case 24:w[v-1].push(w[v]);this.$=w[v-1];break;case 25:this.$=w[v-1];break}},table:[{3:1,4:2,5:[1,3],6:4,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,12:m,13:k,14:j,15:h},{1:[3]},{5:[1,14],7:[1,15],8:[1,16],9:[1,17],10:[1,18]},{1:[2,2]},p(g,[2,3],{12:f,13:c}),p(g,[2,4]),p(g,[2,5]),p(g,[2,6]),p(g,[2,7]),p(a,[2,16],{14:t}),p(a,[2,17]),p(a,[2,20]),p(s,[2,23]),{11:22,14:j,15:h},{1:[2,1]},p(g,[2,8],{11:9,6:23,12:m,13:k,14:j,15:h}),p(g,[2,9],{11:9,6:24,12:m,13:k,14:j,15:h}),p(g,[2,10],{11:9,6:25,12:m,13:k,14:j,15:h}),p(g,[2,11],{11:9,6:26,12:m,13:k,14:j,15:h}),p(a,[2,18],{11:27,14:j,15:h}),p(a,[2,21],{11:28,14:j,15:h}),p(s,[2,24]),{14:t,16:[1,29]},p(g,[2,12],{12:f,13:c}),p(g,[2,13],{12:f,13:c}),p(g,[2,14],{12:f,13:c}),p(g,[2,15],{12:f,13:c}),p(a,[2,19],{14:t}),p(a,[2,22],{14:t}),p(s,[2,25])],defaultActions:{3:[2,2],14:[2,1]},parseError:function r(v,o){if(o.recoverable){this.trace(v)}else{throw new Error(v)}},parse:function n(F){var N=this,C=[0],M=[],X=[null],H=[],Z=this.table,w="",G=0,V=0,y=0,E=2,L=1;var z=H.slice.call(arguments,1);var o=Object.create(this.lexer);var Y={yy:{}};for(var U in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,U)){Y.yy[U]=this.yy[U]}}o.setInput(F,Y.yy);Y.yy.lexer=o;Y.yy.parser=this;if(typeof o.yylloc=="undefined"){o.yylloc={}}var x=o.yylloc;H.push(x);var A=o.options&&o.options.ranges;if(typeof Y.yy.parseError==="function"){this.parseError=Y.yy.parseError}else{this.parseError=Object.getPrototypeOf(this).parseError}function K(ab){C.length=C.length-2*ab;X.length=X.length-ab;H.length=H.length-ab}_token_stack:function J(){var ab;ab=o.lex()||L;if(typeof ab!=="number"){ab=N.symbols_[ab]||ab}return ab}var T,P,B,S,aa,I,R={},O,W,v,D;while(true){B=C[C.length-1];if(this.defaultActions[B]){S=this.defaultActions[B]}else{if(T===null||typeof T=="undefined"){T=J()}S=Z[B]&&Z[B][T]}if(typeof S==="undefined"||!S.length||!S[0]){var Q="";D=[];for(O in Z[B]){if(this.terminals_[O]&&O>E){D.push("'"+this.terminals_[O]+"'")}}if(o.showPosition){Q="Parse error on line "+(G+1)+":\n"+o.showPosition()+"\nExpecting "+D.join(", ")+", got '"+(this.terminals_[T]||T)+"'"}else{Q="Parse error on line "+(G+1)+": Unexpected "+(T==L?"end of input":"'"+(this.terminals_[T]||T)+"'")}this.parseError(Q,{text:o.match,token:this.terminals_[T]||T,line:o.yylineno,loc:x,expected:D})}if(S[0] instanceof Array&&S.length>1){throw new Error("Parse Error: multiple actions possible at state: "+B+", token: "+T)}switch(S[0]){case 1:C.push(T);X.push(o.yytext);H.push(o.yylloc);C.push(S[1]);T=null;if(!P){V=o.yyleng;w=o.yytext;G=o.yylineno;x=o.yylloc;if(y>0){y--}}else{T=P;P=null}break;case 2:W=this.productions_[S[1]][1];R.$=X[X.length-W];R._$={first_line:H[H.length-(W||1)].first_line,last_line:H[H.length-1].last_line,first_column:H[H.length-(W||1)].first_column,last_column:H[H.length-1].last_column};if(A){R._$.range=[H[H.length-(W||1)].range[0],H[H.length-1].range[1]]}I=this.performAction.apply(R,[w,V,G,Y.yy,S[1],X,H].concat(z));if(typeof I!=="undefined"){return I}if(W){C=C.slice(0,-1*W*2);X=X.slice(0,-1*W);H=H.slice(0,-1*W)}C.push(this.productions_[S[1]][0]);X.push(R.$);H.push(R._$);v=Z[C[C.length-2]][C[C.length-1]];C.push(v);break;case 3:return true}}return true}};if(typeof GLOBAL!=="undefined"){GLOBAL.window=GLOBAL}if(typeof window.TSV==="undefined"){var n=l.parse;l.parse=function(o){var v=this.lexer.setInput;this.lexer.setInput=function(w){v.call(this,w);this.begin("BOF");return this};this.parse=n;return n.call(this,o)};window.TSV=function(v){var x=function(){};x.prototype=l.lexer;var w=function(){this.lexer=new x();this.yy={}};w.prototype=l;var o=new w;o.setObj=function(y){o.yy.obj=y};o.yy.handler=v;return o}}var b=(function(){var w=({EOF:1,parseError:function x(F,E){if(this.yy.parser){this.yy.parser.parseError(F,E)}else{throw new Error(F)}},setInput:function(E,F){this.yy=F||this.yy||{};this._input=E;this._more=this._backtrack=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function(){var F=this._input[0];this.yytext+=F;this.yyleng++;this.offset++;this.match+=F;this.matched+=F;var E=F.match(/(?:\r\n?|\n).*/g);if(E){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}this._input=this._input.slice(1);return F},unput:function(G){var E=G.length;var F=G.split(/(?:\r\n?|\n)/g);this._input=G+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-E);this.offset-=E;var I=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(F.length-1){this.yylineno-=F.length-1}var H=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:F?(F.length===I.length?this.yylloc.first_column:0)+I[I.length-F.length].length-F[0].length:this.yylloc.first_column-E};if(this.options.ranges){this.yylloc.range=[H[0],H[0]+this.yyleng-E]}this.yyleng=this.yytext.length;return this},more:function(){this._more=true;return this},reject:function(){if(this.options.backtrack_lexer){this._backtrack=true}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}return this},less:function(E){this.unput(this.match.slice(E))},pastInput:function(){var E=this.matched.substr(0,this.matched.length-this.match.length);return(E.length>20?"...":"")+E.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var E=this.match;if(E.length<20){E+=this._input.substr(0,20-E.length)}return(E.substr(0,20)+(E.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var E=this.pastInput();var F=new Array(E.length+1).join("-");return E+this.upcomingInput()+"\n"+F+"^"},test_match:function(I,G){var J,E,H;if(this.options.backtrack_lexer){H={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){H.yylloc.range=this.yylloc.range.slice(0)}}E=I[0].match(/(?:\r\n?|\n).*/g);if(E){this.yylineno+=E.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:E?E[E.length-1].length-E[E.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+I[0].length};this.yytext+=I[0];this.match+=I[0];this.matches=I;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._backtrack=false;this._input=this._input.slice(I[0].length);this.matched+=I[0];J=this.performAction.call(this,this.yy,this,G,this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input){this.done=false}if(J){return J}else{if(this._backtrack){for(var F in H){this[F]=H[F]}return false}}return false},next:function(){if(this.done){return this.EOF}if(!this._input){this.done=true}var I,G,E,F;if(!this._more){this.yytext="";this.match=""}var J=this._currentRules();for(var H=0;H<J.length;H++){E=this._input.match(this.rules[J[H]]);if(E&&(!G||E[0].length>G[0].length)){G=E;F=H;if(this.options.backtrack_lexer){I=this.test_match(E,J[H]);if(I!==false){return I}else{if(this._backtrack){G=false;continue}else{return false}}}else{if(!this.options.flex){break}}}}if(G){I=this.test_match(G,J[F]);if(I!==false){return I}return false}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function o(){var E=this.next();if(E){return E}else{return this.lex()}},begin:function v(E){this.conditionStack.push(E)},popState:function y(){var E=this.conditionStack.length-1;if(E>0){return this.conditionStack.pop()}else{return this.conditionStack[0]}},_currentRules:function D(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}else{return this.conditions.INITIAL.rules}},topState:function B(E){E=this.conditionStack.length-1-Math.abs(E||0);if(E>=0){return this.conditionStack[E]}else{return"INITIAL"}},pushState:function A(E){this.begin(E)},stateStackSize:function z(){return this.conditionStack.length},options:{},performAction:function C(I,F,H,E){var G=E;switch(H){case 0:return 14;break;case 1:this.popState();return 16;break;case 2:if(F.yytext==this.quoteChar){this.popState();this.begin("STRING");return 16}else{return 14}break;case 3:this.popState();this.begin("STRING");return 14;break;case 4:this.popState();this.quoteChar=F.yytext.substring(0);this.begin("QUOTE");return 15;break;case 5:this.quoteChar=F.yytext;this.popState();this.begin("QUOTE");return 15;break;case 6:this.begin("PRE_QUOTE");return 13;break;case 7:this.begin("PRE_QUOTE");return 7;break;case 8:return 14;break;case 9:this.popState();return 8;break;case 10:this.popState();return 9;break;case 11:this.popState();return 7;break;case 12:this.popState();return 13;break;case 13:return 14;break;case 14:this.popState();break;case 15:return"BUFFIN";break;case 16:return 9;break;case 17:return 10;break;case 18:return 12;break;case 19:return 7;break;case 20:this.begin("STRING");return 14;break;case 21:return 5;break}},rules:[/^(?:(\n|\\n))/,/^(?:([\'\"])(?=$))/,/^(?:([\'\"]))/,/^(?:(?=(\t)))/,/^(?:([\'\"]))/,/^(?:([\'\"]))/,/^(?:(\t|\\t)(?=[\'\"]))/,/^(?:(\n|\\n)(?=[\'\"]))/,/^(?:([a-zA-Z0-9_ ]+|.))/,/^(?:(\n\t|\\n\\t))/,/^(?:(\n\n|\\n\\n))/,/^(?:(\n|\\n))/,/^(?:(\t|\\t))/,/^(?:([a-zA-Z0-9_ ]+|.))/,/^(?:)/,/^(?:(\n\t|\\n\\t)(?=.))/,/^(?:(\n\n|\\n\\n))/,/^(?:(\t\n))/,/^(?:(\t))/,/^(?:(\n))/,/^(?:([a-zA-Z0-9_ ]+|.))/,/^(?:$)/],conditions:{BOF:{rules:[4,6,7,14,15,16,17,18,19,20,21],inclusive:true},PRE_QUOTE:{rules:[5,6,7,15,16,17,18,19,20,21],inclusive:true},QUOTE:{rules:[0,1,2,3,6,7,8,15,16,17,18,19,20,21],inclusive:true},STRING:{rules:[6,7,9,10,11,12,13,15,16,17,18,19,20,21],inclusive:true},INITIAL:{rules:[6,7,15,16,17,18,19,20,21],inclusive:true}}});return w})();l.lexer=b;function d(){this.yy={}}d.prototype=l;l.Parser=d;return new d})();if(typeof require!=="undefined"&&typeof exports!=="undefined"){exports.parser=parser;exports.Parser=parser.Parser;exports.parse=function(){return parser.parse.apply(parser,arguments)};exports.main=function commonjsMain(a){if(!a[1]){console.log("Usage: "+a[0]+" FILE");process.exit(1)}var b=require("fs").readFileSync(require("path").normalize(a[1]),"utf8");return exports.parser.parse(b)};if(typeof module!=="undefined"&&require.main===module){exports.main(process.argv.slice(1))}};