var jQuery=window.jQuery||{};var Sheet=(function(d,l,f,a,p,s,t,g,b,q){var k={defaultTheme:0,themeRollerTheme:0,bootstrapTheme:1,customTheme:2,excelSelectModel:0,googleDriveSelectModel:1,openOfficeSelectModel:2,defaultColumnWidth:120,defaultRowHeight:20,calcStack:0};k.Cell=(function(){var v=undefined;function w(x,A,z,y){if(w.cellLoading===null){w.cellLoading=z.msg.cellLoading}if(A!==undefined&&A!==null){this.td=A;A.jSCell=this}else{this.td=null}this.dependencies=[];this.formula="";this.cellType=null;this.value="";this.valueOverride=null;this.calcCount=0;this.sheetIndex=x;this.rowIndex=null;this.columnIndex=null;this.jS=(z!==undefined?z:null);this.state=[];this.needsUpdated=true;this.uneditable=false;this.id=null;this.loader=null;this.loadedFrom=null;this.cellHandler=y;this.waitingCallbacks=[];this.parsedFormula=null;this.defer=null}w.prototype={addDependency:function(x){if(x===undefined||x===null){return}if(x.type!==k.Cell){throw new Exception("Wrong Type")}if(this.dependencies.indexOf(x)<0&&this!==x){this.dependencies.push(x);if(this.loader!==null){this.loader.addDependency(this,x)}}},updateValue:function(B){if(!this.needsUpdated&&this.value.cell!==v&&this.defer===null){var G=(this.valueOverride!==null?this.valueOverride:this.value);this.displayValue();if(B!==v){B.call(this,G)}if(this.waitingCallbacks.length>0){while(this.waitingCallbacks.length>0){this.waitingCallbacks.pop().call(this,G)}}return}if(this.formula.length<1&&this.cellType===null&&this.defer===null){if(this.value!==undefined&&((this.value+"").length<1||!this.hasOperator.test(this.value))){if(this.td!==null){this.td.innerHTML=this.encode(this.value)}this.value=new p(this.value);this.value.cell=this;this.updateDependencies();this.needsUpdated=false;if(B!==v){B.call(this,this.value)}if(this.waitingCallbacks.length>0){while(this.waitingCallbacks.length>0){this.waitingCallbacks.pop().call(this,this.value)}}return}}var N,z=this,H,D,K=this.value,y=this.formula,L=this.cellType,x,A=this.defer,E=this.td,M,I,C,O,J=function(P){z.parsedFormula=P;z.resolveFormula(P,function(Q){if(Q!==v&&Q!==null){if(Q.cell!==v&&Q.cell!==z){Q=Q.valueOf()}k.calcStack--;if(L!==null&&(x=k.CellTypeHandlers[L])!==v){Q=x(z,Q)}F.call(z,Q)}else{F.call(z,null)}})},F=function(P){if(P===v||P===null){P=new p()}if(P.cell===v){switch(typeof(P)){case"object":break;case"undefined":P=new p();break;case"number":P=new s(P);break;case"boolean":P=new t(P);break;case"string":default:P=new p(P);break}P.cell=z}z.value=P;H=z.displayValue().valueOf();z.state.shift();if(z.loader!==null){z.loader.setCellAttributes(z.loadedFrom,{cache:(typeof H!=="object"?H:null),formula:z.formula,parsedFormula:z.parsedFormula,value:z.value+"",cellType:z.cellType,uneditable:z.uneditable}).setDependencies(z)}z.needsUpdated=false;O=z.valueOverride!==null?z.valueOverride:z.value;if(B!==v){B.call(z,O)}if(z.waitingCallbacks.length>0){while(z.waitingCallbacks.length>0){z.waitingCallbacks.pop().call(z,O)}}z.updateDependencies()};if(this.state.length>0){if(B!==v){this.waitingCallbacks.push(B)}return}if(A!==null){A.updateValue(function(P){P=P.valueOf();switch(typeof(P)){case"object":break;case"undefined":P=new p();break;case"number":P=new s(P);break;case"boolean":P=new t(P);break;case"string":default:P=new p(P);break}P.cell=this;this.updateDependencies();this.needsUpdated=false;if(B!==v){B.call(z,P)}if(z.waitingCallbacks.length>0){while(z.waitingCallbacks.length>0){z.waitingCallbacks.pop().call(z,P)}}});return}this.oldValue=K;this.state.unshift("updating");this.fnCount=0;this.valueOverride=null;this.calcCount++;if(y.length>0){if(y.charAt(0)==="="){z.formula=y=y.substring(1)}if(z.td!==null){z.td.innerHTML=w.cellLoading}k.calcStack++;if(this.parsedFormula!==null){J(this.parsedFormula)}else{z.parseFormula({formula:y,callback:J})}}else{if(K!==v&&K!==null&&L!==null&&(x=k.CellTypeHandlers[L])!==v){K=x(z,K);F(K)}else{switch(typeof K.valueOf()){case"string":N=z.startOperators[K.charAt(0)];if(N!==v){z.valueOverride=N.call(z,K)}else{N=z.endOperators[K.charAt(K.length-1)];if(N!==v){z.valueOverride=N.call(z,K)}}break;case"undefined":K="";break}F(K)}}},updateDependencies:function(){var z,x,y;z=this.dependencies;this.dependencies=[];y=z.length-1;if(y>-1){this.state.unshift("updatingDependencies");do{x=z[y];x.updateValue()}while(y-->0);this.state.shift()}if(this.dependencies.length===0){this.dependencies=z}},displayValue:function(){var y=this.value,A=this.td,z=typeof y,x=y.html;if(x===v){if(z==="string"||(y!==null&&z==="object"&&y.toUpperCase!==v)&&y.length>0){x=this.encode(y)}else{x=y}}if(A===v||A===null){return x}switch(typeof x){case"object":if(x===null){A.innerHTML=""}else{if(x.appendChild!==v){if(x.parentNode===null){A.innerHTML="";A.appendChild(x)}return""}}case"string":default:A.innerHTML=x}return A.innerHTML},resolveFormula:function(I,G){if(typeof I==="string"){G(I)}var F=this,B=[],z=0,C=I.length,A,H=this.cellHandler,E=[],D=function(K,M){var N=[],J,L=M.length-1;if(L<0){return}do{J=M[L];switch(typeof J){case"number":N[L]=E[J];break;case"string":N[L]=J;break;case"object":if(J instanceof Array){N[L]=y(J);break}default:N[L]=J}}while(L-->0);N.unshift(K);return N},y=function(L){var M=[],K=L.length-1,J;if(K<0){return}do{J=L[K];switch(typeof J){case"number":M[K]=E[J];break;case"string":M[K]=J;break;case"object":if(J.hasOwnProperty("args")){M[K]=J;M[K].a=y(J.a);break}else{if(J instanceof Array){M[K]=y(J);break}}default:M[K]=J}}while(K-->0);return M},x;if(F.jS.s.useStack){x=function(M){var L=w.thawIndex,N=w.thaws,K,J=(typeof N[L]==="undefined");if(J){K=w.thaws[L]=new Thaw([])}else{K=N[L]}w.thawIndex++;if(w.thawIndex>w.thawLimit){w.thawIndex=0}K.add(function(){if(B.length>0){B.shift()()}else{G(F.value=(M!==v?M:null))}})}}else{x=function(J){if(B.length>0){B.shift()()}else{G(F.value=(J!==v?J:null))}}}for(;z<C;z++){A=I[z];switch(A.t){case"m":(function(J,K){B.push(function(){x(E[K]=H[J.m].apply(H,D(F,J.a)))})})(A,z);break;case"l":(function(J,K){B.push(function(){var L=D(F,J.a);L.push(function(M){x(E[K]=M)});H[J.m].apply(H,L)})})(A,z);break;case"v":(function(J,K){B.push(function(){x(E[K]=J.v)})})(A,z);break;case"cell":(function(J,K){B.push(function(){E[K]=J;x()})})(A,z);break;case v:E[z]=A;break;default:E[z]=null;throw new q("Not implemented:"+A.t);break}}x()},recurseDependencies:function(A,C){if(C>w.maxRecursion){this.recurseDependenciesFlat(A);return this}var z=0,B=this.dependencies,y,x=B.length;if(C===undefined){C=0}for(;z<x;z++){y=B[z];A.call(y);y.recurseDependencies(A,C)}return this},recurseDependenciesFlat:function(B){var C=this.dependencies,z=C.length-1,y,x,A=[];if(z<0){return}do{A.push(C[z])}while(z-->0);do{y=A[A.length-1];A.length--;B.call(y);x=y.dependencies;z=x.length-1;if(z>-1){do{A.push(x[z])}while(z-->0)}}while(A.length>0)},getAllDependencies:function(){var x=[];this.recurseDependencies(function(){x.push(this)});return x},setNeedsUpdated:function(x){if(x!==v){this.needsUpdated=x}else{this.needsUpdated=true}this.recurseDependencies(function(){this.needsUpdated=true})},encode:function(x){switch(typeof x){case"object":if(x.getMonth!==v){return globalize.format(x,"d")}return x}if(!x){return x||""}if(!x.replace){return x||""}return x.replace(/&/gi,"&amp;").replace(/>/gi,"&gt;").replace(/</gi,"&lt;").replace(/\t/g,"&nbsp;&nbsp;&nbsp ").replace(/  /g,"&nbsp; ")},addClass:function(x){var B=this.td,z,y,A=this.loadedFrom;if(B!==v){if(B.classList){B.classList.add(x)}else{B.className+=" "+x}}if(A!==v){z=(this.loader.getCellAttribute(A,"class")||"");y=z.split(" ").indexOf(x);if(y<0){z+=" "+x;this.loader.setCellAttribute(A,"class",z)}}return this},removeClass:function(x){var B=this.td,z,y,A=this.loadedFrom;if(B!==v){if(B.classList){B.classList.remove(x)}else{z=(B.className+"").split(" ");y=z.indexOf(x);if(y>-1){z.splice(y,1);B.className=z.join(" ")}}}if(A!==v){z=(this.loader.getCellAttribute(A,"class")||"").split(" ");y=z.indexOf(x);if(y>-1){z.splice(y,1);this.loader.setCellAttribute(A,"class",z.join(" "))}}return this},hasOperator:/(^[$£])|([%]$)/,startOperators:{"$":function(y,x){return this.cellHandler.fn.DOLLAR.call(this,y.substring(1).replace(Globalize.culture().numberFormat[","],""),2,x||"$")},"£":function(x){return this.startOperators["$"].call(this,x,"£")}},endOperators:{"%":function(x){return x.substring(0,this.value.length-1)/100}},type:w,typeName:"Sheet.Cell",parseFormula:function(B){if(!this.jS.s.useMultiThreads){B.callback(this.cellHandler.formulaParser(k.calcStack).parse(B.formula));return}var z=w.threadIndex,A=w.threads,x,y=(typeof A[z]==="undefined");if(y){x=w.threads[z]=operative(function(C){if(typeof C==="string"){return parser.Formula().parse(C)}return null},[w.formulaParserUrl]);x.busy=false;x.stash=[]}else{x=A[z]}w.threadIndex++;if(w.threadIndex>w.threadLimit){w.threadIndex=0}if(x.busy){x.stash.push(function(){x.busy=true;x(B.formula,function(C){x.busy=false;B.callback(C);if(x.stash.length>0){x.stash.shift()()}})})}else{x.busy=true;x(B.formula,function(C){x.busy=false;B.callback(C);if(x.stash.length>0){x.stash.shift()()}})}}};w.threads=[];w.threadLimit=10;w.threadIndex=0;w.thaws=[];w.thawLimit=500;w.thawIndex=0;w.cellLoading=null;w.formulaParserUrl="../parser/formula/formula.js";w.maxRecursion=10;return w})();k.CellHandler=(function(w){function z(A){return !isNaN(A)}var v=undefined,x=NaN;function y(C,A,B){this.jS=C;this.jSE=A;this.fn=B;this.spareFormulaParsers={}}y.prototype={variable:function(G,E){if(arguments.length){var D=E[0],B=E[1],F=this.jS.s.formulaVariables,C,A;switch(D.toLowerCase()){case"true":A=new t(true);A.html="TRUE";A.cell=G;return A;case"false":A=new t(false);A.html="FALSE";A.cell=G;return A}if(C=F[D]&&!B){return C}else{if(C&&B){return C[B]}else{return""}}}},time:function(A,C,B){return i.fromString(C,B)},number:function(B,A){if(isNaN(A)||A===null){A=0}switch(typeof A){case"number":return A;case"string":if(z(A)){return A*1}case"object":if(A.getMonth){return e.toCentury(A)}}return A},invertNumber:function(D,C){if(isNaN(C)){C=0}var B=this.number(D,C),A=new s(B.valueOf()*-1);if(B.html){A.html=B.html}return A},performMath:function(A,H,G,F){if(G===v||G===null){G=0}if(F===v||F===null){F=0}var E,D,I=true,B=true,K=[],J,C=function(L){return L};if(G.hasOwnProperty("cell")){G.cell.addDependency(A)}if(F.hasOwnProperty("cell")){F.cell.addDependency(A)}switch(E=(typeof G.valueOf())){case"number":break;case"string":if(z(G)){G*=1}else{I=false}break;case"object":if(G.getMonth){G=e.toCentury(G);C=e.get}else{I=false}break;default:I=false}switch(D=(typeof F.valueOf())){case"number":break;case"string":if(z(F)){F*=1}else{B=false}break;case"object":if(F.getMonth){F=e.toCentury(F)}else{B=false}break;default:B=false}if(!I&&H!=="+"){K.push("not a number: "+G);G=0}if(!B){K.push("not a number: "+F);F=0}if(K.length){}switch(H){case"+":J=G+F;break;case"-":J=G-F;break;case"/":J=G/F;if(J==Infinity||J==x){J=0}break;case"*":J=G*F;break;case"^":J=w.pow(G,F);break}return C(J)},not:function(D,C,B){var A;if(C.valueOf()!=B.valueOf()){A=new t(true);A.html="TRUE";A.cell=D}else{A=new t(false);A.html="FALSE";A.cell=D}return A},concatenate:function(C,B,A){if(B===null){B=""}if(A===null){A=""}return B.toString()+A.toString()},cellValue:function(C,B,G){var E=this.jS,F=h.parseLocation(B.c,B.r),A,D;A=E.getCell(C.sheetIndex,F.row,F.col);if(A!==null){A.addDependency(C);A.updateValue(G)}else{if(G!==v){G.call(C,0)}}return this},cellRangeValue:function(B,D,A,C){return this.remoteCellRangeValue(B,B.sheetIndex,D,A,C)},remoteCellValue:function(A,F,C,H){var B=this.jSE,D=this.jS,E=B.parseLocation(C.c,C.r),I=B.parseSheetLocation(F),G;if(I<0){I=D.getSpreadsheetIndexByTitle(F)}G=D.getCell(I,E.row,E.col);if(G!==null){G.addDependency(A);G.updateValue(H)}else{if(H!==v){H.call(A,0)}}return this},remoteCellRangeValue:function(Y,E,F,B,G){var H=(typeof E==="string"?h.parseSheetLocation(E):E),Z=h.parseLocation(F.c,F.r),N=h.parseLocation(B.c,B.r),P=w.max(Z.row,N.row),D=w.min(Z.row,N.row),X=w.max(Z.col,N.col),C=w.min(Z.col,N.col),L=this.jS,Q=[],S,A,K,J=[],aa=H+"!"+F.c+F.r+":"+B.c+B.r,M=y.cellRangeCache[aa],W,V,U,O=this,R=((C-1)-X)*((D-1)-P),T=R+0,I=0;if(H<0){H=L.getSpreadsheetIndexByTitle(E)}if(H<0){Q=new p("");Q.html="#NAME?";G.call(Y,Q);return this}if(E===v){L.spreadsheets[H]=E={}}if(P>=D||X>=C){Q.rowCount=(D-P)+1;Q.columnCount=(C-X)+1;do{S=X;K=(E[P]!==v?E[P]:null);do{if(K===null||(A=K[S])===v){A=L.getCell(H,P,S)}else{A.sheetIndex=H;A.rowIndex=P;A.columnIndex=S}if(A!==null){A.addDependency(Y);A.updateValue(function(ab){Q.unshift(ab);R--;if(R<1){y.cellRangeCache[aa]=Q;G.call(Y,Q)}});I++}}while(S-->C)}while(P-->D)}return this},callFunction:function(D,C,B){C=C.toUpperCase();B=B||[];var E=this.fn[C],A;if(E!==v){D.fnCount++;A=E.apply(D,B)}else{A=new p();A.html="Function "+C+" Not Found"}return A},formulaParser:function(B){var A;if(B>-1){A=this.spareFormulaParsers[B];if(A===v){A=this.spareFormulaParsers[B]=Formula(this)}}else{A=this.jS.formulaParser}return A}};y.cellRangeCache={};return y})(g);k.CellTypeHandlers=(function(){var w=isNaN,v={percent:function(y,A){if(A!==A){return 0}var z=(w(A)?Globalize.parseFloat(A):A*1),x;if(!w(z)){x=new s(z);x.html=Globalize.format(z,"p");return x}return A},date:function(x,z){if(z!==z){return 0}var y=Globalize.parseDate(z);if(y===null){return z}else{x.valueOverride=y;x.html=Globalize.format(y,"d");return z}},time:function(x,z){if(z!==z){return 0}var y=Globalize.parseDate(z);if(y===null){return z}else{y.html=Globalize.format(y,"t");return y}},currency:function(y,A){if(A!==A){return 0}var z=(w(A)?Globalize.parseFloat(A):A*1),x;if(!w(z)){x=new s(z);x.html=Globalize.format(z,"c");return x}return A},number:function(y,A){if(A!==A){return 0}var z,x;if(!v.endOfNumber){z=Globalize.culture().numberFormat["."];v.endOfNumber=new b("(["+(z=="."?".":z)+"])([0-9]*?[1-9]+)?(0)*$")}if(!w(A)){x=new s(A);x.html=Globalize.format(A+"","n10").replace(v.endOfNumber,function(D,C,B){return(B?C:"")+(B||"")});return x}return A}};return v})();k.CellRange=(function(){function v(w){this.cells=w||[]}v.prototype={clone:function(){var A=[],y=this.cells,x=y.length,w,B;for(var z=0;z<x;z++){w=y[z];B={value:w.value,formula:w.formula,td:w.td,dependencies:w.dependencies,needsUpdated:w.needsUpdated,calcCount:w.calcCount,sheetIndex:w.sheetIndex,rowIndex:w.rowIndex,columnIndex:w.columnIndex,html:w.html,state:w.state,jS:w.jS,style:w.style,cl:w.cl,id:w.id,cellType:w.cellType,type:w.type,uneditable:w.uneditable};A.push(B)}return new v(A)},type:v,typeName:"Sheet.CellRange"};return v})();k.ActionUI=(function(v,y,w,x,z){var A=function(F,M,K,L,I){this.enclosure=F;this.pane=v.createElement("div");this.table=M;this.max=I;this.xIndex=0;this.yIndex=0;this.scrollAxisX={};this.scrollAxisY={};this.scrollSize={};this.hiddenColumns=[];if(!(this.frozenAt=L)){this.frozenAt={row:0,col:0}}this.frozenAt.row=w.max(this.frozenAt.row,0);this.frozenAt.col=w.max(this.frozenAt.col,0);this.scrolledArea={row:w.max(this.frozenAt.row,1),col:w.max(this.frozenAt.col,1)};this.foldArea={row:0,col:0};var G=this,C=this.pane,J=this.tBody=M.tBody,H="#"+M.getAttribute("id"),D=this.scrollUI=C.scrollOuter=v.createElement("div"),E=C.scrollInner=v.createElement("div"),B=this.scrollAxisX.scrollStyle=C.scrollStyleX=this.scrollStyleX=new k.StyleUpdater(function(O,P){if(G.xIndex===O){return false}if(O===undefined||O===null){O=G.xIndex}var R=O+G.maximumVisibleColumns,S=c.ofSet(G.hiddenColumns,O),Q=c.ofSet(G.hiddenColumns,R);if(S!==null){O=S.end+(O-S.start)}if(Q!==null){R=Q.end+(R-Q.start)}G.xIndex=O;if(P===undefined){var N=G.frozenAt.col;P=H+" tr > *:nth-child(-n+"+O+") {display: none;}"+H+" col:nth-child(-n+"+O+") {display: none;}"+H+" tr > *:nth-child(-n+"+(N+1)+") {display: table-cell;}"+H+" col:nth-child(-n+"+(N+1)+") {display: table-column;}"+H+" tr > *:nth-child("+(R)+") ~ * {display: none;}"+H+" col:nth-child("+(R)+") ~ col {display: none;}"}this.setStyle(P);G.scrolledArea.col=w.max(O||1,1);G.foldArea.col=R;return true},I);this.yDetacher=new k.Detacher(J);D.setAttribute("class",K);D.appendChild(E);z(D).disableSelectionSpecial();D.addEventListener("scroll",function(){var N=D.scrollTop+D.clientHeight;if(N>=(E.clientHeight-(D.clientHeight/2))){E.style.height=(E.clientHeight+(D.clientHeight*2))+"px"}N=D.scrollLeft+D.clientWidth;if(N>=(E.clientWidth-(D.clientWidth/2))){E.style.width=(E.clientWidth+(D.clientWidth*2))+"px"}});C.appendChild(B.styleElement);new MouseWheel(C,D)};A.prototype={putTdInView:function(G){var C=0,B=0,F=0,E,D;this.xIndex=0;this.yIndex=0;while((E=this.directionToSeeTd(G))!==null){D=this.scrolledArea;if(E.left){B--;this.scrollTo("x",0,D.col-1)}else{if(E.right){B++;this.scrollTo("x",0,D.col+1)}}if(E.up){F--;this.scrollTo("y",0,D.row-1)}else{if(E.down){F++;this.scrollTo("y",0,D.row+1)}}C++;if(C<25){break}}},directionToSeeTd:function(C){var B=this.pane,L={top:0,bottom:B.clientHeight,left:0,right:B.clientWidth},H=C.clientWidth,F=C.clientHeight,J={top:C.offsetTop,bottom:C.offsetTop+F,left:C.offsetLeft,right:C.offsetLeft+H},D=C.parentNode,I=this.scrolledArea;if(!C.col){return null}var K=C.barTop.cellIndex<I.col,E=D.rowIndex<I.row,G={up:E,down:J.bottom>L.bottom&&F<=B.clientHeight,left:K,right:J.right>L.right&&H<=B.clientWidth};if(G.up||G.down||G.left||G.right){return G}return null},redraw:function(){var B=this.pane.style;B.opacity=0.9999;setTimeout(function(){B.opacity=1},0)},hide:function(D,C){var F="#"+this.table.getAttribute("id"),E=this.pane,B=this;if(this.toggleHideStyleX===null){this.toggleHideStyleX=new k.StyleUpdater(function(){var G=this.nthCss("col",F,B.hiddenColumns,0)+this.nthCss("> td",F+" tr",B.hiddenColumns,0)+this.nthCss("> th",F+" tr",B.hiddenColumns,0);this.setStyle(G)})}E.appendChild(this.toggleHideStyleX.styleElement);this.hiddenColumns=(C!==null?C:[]);if(D!==null&&D.length>0){D.sort();this.toggleHideRowRange(D[0],D[D.length-1],true)}if(this.hiddenColumns.length>0){this.hiddenColumns.sort();this.toggleHideStyleX.update()}},toggleHideRow:function(I){var C,J=this.tBody,H=this.yDetacher,D=H.hidden,K=H.hidden[I],E=H.detachedAbove,F=H.detachedBelow,B=E.length,G=B+J.length;if(K===undefined){if(I<B){D[I]=E[I]}else{if(I>G){D[I]=F[I-G]}else{C=I-B;if(C>=J.children.length){D[I]=null}else{J.removeChild(D[I]=J.children[C])}}}}else{delete D[I]}},toggleHideRowRange:function(N,H,I){return;if(!N){return}if(!H){H=N}var C,M=this.tBody,L=N,K=this.yDetacher,D=K.hidden,E=K.detachedAbove,G=K.detachedBelow,F=((I===true)||(D[N]===u)),B=E.length-1,J=B+M.length;for(;L<H;L++){if(F){if(L<B){D[L]=E[L]}else{if(L>J){D[L]=G[L-J]}else{C=L-B;if(C>=M.children.length){D[L]=null}else{M.removeChild(D[L]=M.children[C])}}}}}},rowShowAll:function(){this.toggleHideStyleY.setStyle("");this.hiddenRows={}},toggleHideColumn:function(B){var C;if((C=this.hiddenColumns.indexOf(B))>-1){this.hiddenColumns.splice(C,1)}else{this.hiddenColumns.push(B)}this.hiddenColumns.sort();this.toggleHideStyleX.update()},toggleHideColumnRange:function(I,H){if(!I){return}if(!H){H=I}var G=this.hiddenColumns,E=[],D=G.length,C,F=0,B=null;for(;F<D;F++){C=G[F];if(C>=I&&C<=H){if(B===null){B=true}}else{E.push(C)}}if(B===null){for(F=I;F<=H;F++){E.push(F)}}E.sort();this.hiddenColumns=E;this.toggleHideStyleX.update()},columnShowAll:function(){this.toggleHideStyleX.setStyle("");this.hiddenColumns=[]},remove:function(){},scrollToPixelX:function(C){var E=this.scrollAxisX,B,D,F=(C/this.pixelScrollDensity)>>1,G=c.indexOfNearestLessThan(this.hiddenColumns,F)+1;if(G>0){F+=G}B=E.max;E.value=F;D=F>B?B:F;return E.scrollStyle.update(D)},scrollToPixelY:function(C,E){var D=(C/this.pixelScrollDensity)>>1,B=this.yDetacher;this.yIndex=D;this.scrolledArea.row=w.max(D||1,1);if(E===true){B.attachAboveAfter(D).detachBelowAfter(D+this.maximumVisibleRows+1)}else{B.detachAboveBefore(D).attachBelowBefore(D+this.maximumVisibleRows+1)}return B.aboveChanged||B.belowChanged},scrollToCell:function(B,C){throw new q("Not yet implemented")},toggleHideStyleX:null,toggleHideStyleY:null,pixelScrollDensity:30,maximumVisibleRows:65,maximumVisibleColumns:20};return A})(l,f,g,s,d);k.SpreadsheetUI=(function(){var v=[];function w(y,A,z,x){x=x||{};this.i=y;this.ui=A;this.table=z;this.isLast=x.lastIndex===y;this.enclosure=null;this.pane=null;this.spreadsheet=null;this.sizeCheck=x.sizeCheck||function(){};this.initChildren=x.initChildren||function(){};this.done=x.done||function(){};this.sizeCheck(this)}w.prototype={load:function(){var x=this.table;this.initChildren(this.ui,x,this.i);x.pane.ui=this.ui;this.enclosure=x.enclosure;this.pane=x.pane;this.spreadsheet=x.spreadsheet;v.push(this.i);if(this.isLast){this.loaded()}},loaded:function(){this.done(v,this)}};return w})();k.Theme=(function(v){function w(x){x=x||k.defaultTheme;switch(x){case k.customTheme:this.cl=w.customClasses;break;case k.bootstrapTheme:this.cl=w.bootstrapClasses;break;default:case k.themeRollerTheme:this.cl=w.themeRollerClasses;break}v.extend(this,this.cl)}w.themeRollerClasses={autoFiller:"ui-state-active",bar:"ui-widget-header",barHighlight:"ui-state-active",barHandleFreezeLeft:"ui-state-default",barHandleFreezeTop:"ui-state-default",barMenuTop:"ui-state-default",tdActive:"ui-state-active",tdHighlighted:"ui-state-highlight",control:"ui-widget-header ui-corner-top",controlTextBox:"ui-widget-content",fullScreen:"ui-widget-content ui-corner-all",inPlaceEdit:"ui-state-highlight",menu:"ui-widget-header",menuFixed:"",menuUl:"ui-widget-header",menuLi:"ui-widget-header",menuHover:"ui-state-highlight",pane:"ui-widget-content",parent:"ui-widget-content ui-corner-all",table:"ui-widget-content",tab:"ui-widget-header",tabActive:"ui-state-highlight",barResizer:"ui-state-highlight",barFreezer:"ui-state-highlight",barFreezeIndicator:"ui-state-highlight"};w.bootstrapClasses={autoFiller:"btn-info",bar:"bg-primary",barHighlight:"label-info",barHandleFreezeLeft:"bg-warning",barHandleFreezeTop:"bg-warning",barMenuTop:"bg-warning",tdActive:"active",tdHighlighted:"bg-info",control:"bg-primary",controlTextBox:"form-control",fullScreen:"",inPlaceEdit:"form-control",menu:"panel panel-default",menuFixed:"nav navbar-nav",menuUl:"panel-info",menuLi:"active",menuHover:"bg-primary active",pane:"well",parent:"panel panel-default",table:"table table-bordered table-condensed",tab:"btn-default btn-xs",tabActive:"active",barResizer:"bg-info",barFreezer:"bg-warning",barFreezeIndicator:"bg-warning"};w.customClasses={autoFiller:"",bar:"",barHighlight:"",barHandleFreezeLeft:"",barHandleFreezeTop:"",barMenuTop:"",tdActive:"",tdHighlighted:"",control:"",controlTextBox:"",fullScreen:"",inPlaceEdit:"",menu:"",menuFixed:"",menuUl:"",menuLi:"",menuHover:"",pane:"",parent:"",table:"",tab:"",tabActive:"",barResizer:"",barFreezer:"",barFreezeIndicator:""};return w})(jQuery);k.Highlighter=(function(v,w,x){var y=function(A,C,z,B){this.cssClass=A;this.cssClassBars=C;this.cssClassTabs=z;this.callBack=B||function(){};this.last=x([]);this.lastTop=x([]);this.lastLeft=x([]);this.lastTab=x([]);this.start={row:0,col:0};this.end={row:0,col:0}};y.prototype={set:function(B){if(B.parentNode!==undefined){B=[B]}var z,A=this.last;if(A&&A.length>0){z=A.length-1;do{A[z].isHighlighted=false}while(z-->0)}if(B.length>0){z=B.length-1;do{if(!B[z].isHighlighted){B[z].isHighlighted=true;if(!B[z].className.match(this.cssClass)){B[z].className+=" "+this.cssClass}}}while(z-->0)}this.clear(A);this.last=B;this.callBack();return this},is:function(){return this.last.length>0},clear:function(A){if(this.is()){A=A||this.last;if(A&&A.length){var z=A.length-1;do{if(!A[z].isHighlighted){A[z].className=A[z].className.replace(this.cssClass,"");A[z].isHighlighted=false}}while(z-->0)}}this.last=x([]);return this},setBar:function(z,A){switch(z){case"top":this.lastTop.removeClass(this.cssClassBars);this.lastTop=x(A).addClass(this.cssClassBars);break;case"left":this.lastLeft.removeClass(this.cssClassBars);this.lastLeft=x(A).addClass(this.cssClassBars);break}return this},clearBar:function(){this.lastTop.removeClass(this.cssClassBars);this.lastTop=x([]);this.lastLeft.removeClass(this.cssClassBars);this.lastLeft=x([]);return this},setTab:function(z){this.clearTab();this.lastTab=z.addClass(this.cssClassTabs);return this},clearTab:function(){this.lastTab.removeClass(this.cssClassTabs);return this},setStart:function(z){this.start=z;return this},setEnd:function(z){this.end=z;return this}};return y})(l,f,jQuery);k.ColumnAdder=(function(){function v(){this.qty=-1;this.addedFinishedFn=null;this.createBarFn=null;this.createCellFn=null}v.prototype={setQty:function(y,x){var w=d.sheet.max;if(w){if(w>x.cols&&w<=x.cols+y){this.qty=w-x.cols}else{if(w&&w<=x.cols+y){return false}}}else{this.qty=y}return true},setAddedFinishedFn:function(w){this.addedFinishedFn=w},setCreateBarFn:function(w){this.createBarFn=w},setCreateCellFn:function(w){this.createCellFn=w},createCells:function(B,E,A){var z=(A?0:1),w=E.rows||1,y=B+this.qty,D,x=B,C;for(;x<y;x++){C=this.createBarFn(x+z);for(D=1;D<=w;D++){this.createCellFn(D,x+z,C)}}if(this.addedFinishedFn!==null){this.addedFinishedFn({row:0,col:this.qty})}}};return v})();k.RowAdder=(function(){function v(){this.qty=-1;this.addedFinishedFn=null;this.createBar=null;this.createCell=null;this.hidden=null}v.prototype={setQty:function(z,x,y){var w=d.sheet.max;if(w){if(w>x.rows&&w<=x.rows+z){this.qty=w-x.rows}else{if(w&&w<=x.rows+z){return false}}}else{this.qty=z}return true},setAddedFinishedFn:function(w){this.addedFinishedFn=w},setCreateBarFn:function(w){this.createBar=w},setCreateCellFn:function(w){this.createCell=w},setHidden:function(w){this.hidden=w||[]},createCells:function(C,F,B){var A=(B?0:1),w=C+this.qty,z=F.cols||1,D,x,E=C,y;for(;E<w;E++){x=this.hidden.indexOf(E+A)>-1;D=this.createBar(E+A,x);for(y=1;y<=z;y++){this.createCell(E+A,y,D,x)}}if(this.addedFinishedFn!==null){this.addedFinishedFn({row:this.qty,col:0})}}};return v})();(function(y){var x=undefined;function w(A,z){this.parent=A;this.maximumVisible=z;this.detachedAbove=[];this.detachedBelow=[];this.aboveChanged=false;this.belowChanged=false;this.hasInitialDetach=false}function v(E,B){var C=E.parent,A=C.children,D=E.detachedAbove.length,z;if(B<D){return}while((z=(D+(A.length-1)))>B){E.detachedBelow.unshift(C.lastChild);C.removeChild(C.lastChild)}}w.prototype={detachAboveBefore:function(C){var B,D=this.parent,A=D.children,z=this.detachedAbove;this.aboveChanged=false;while(z.length-1<C){B=A[1];if(B===x){break}z.push(B);D.removeChild(B);this.aboveChanged=true}return this},detachBelowAfter:function(B){if(!this.hasInitialDetach){this.hasInitialDetach=true;v(this,B)}var A,D=this.parent,z=this.detachedAbove.length,C=D.children;this.belowChanged=false;while(z+C.length>B){this.detachedBelow.unshift(A=D.lastChild);D.removeChild(A);this.belowChanged=true}return this},attachAboveAfter:function(A){var D=this.parent,E=l.createDocumentFragment(),C,z=this.detachedAbove,B;this.aboveChanged=false;while((B=z.length-1)>=A){C=z.pop();E.insertBefore(C,E.firstChild);this.aboveChanged=true}if(this.aboveChanged){D.insertBefore(E,D.children[1])}return this},attachBelowBefore:function(B){if(!this.hasInitialDetach){this.hasInitialDetach=true;v(this,B)}var D,C=this.parent,z=this.detachedBelow,G=l.createDocumentFragment(),F=G.children,E=this.detachedAbove.length+C.children.length,A;this.belowChanged=false;while((A=E+(F.length-1))<B&&this.detachedBelow.length>0){if(z.length<1){break}D=z.shift();G.appendChild(D);this.belowChanged=true}if(this.belowChanged){C.appendChild(G)}return this},isAboveActive:function(){return this.detachedAbove.length>0},isBelowActive:function(){return this.detachedBelow.length>0}};y.Detacher=w})(k);k.StyleUpdater=(function(v){function w(x){var y=this.styleElement=v.createElement("style");y.styleUpdater=this;this._update=x}w.prototype={setStyle:null,getStyle:null,nthCss:function(x,D,z,B,A){var C=[],y=z.length;A=A||"{display: none;}";do{if(z[y]>B){C.unshift(D+" "+x+":nth-child("+(z[y]+1)+")")}}while(y--);if(C.length){return C.join(",")+A}return""},repeat:function(z,y){var x="";while(y>0){if(y&1){x+=z}y>>=1;z+=z}return x},update:function(){return this._update.apply(this,arguments)}};if(v.createElement("style").styleSheet){w.prototype.setStyle=function(y){var z=this.styleElement,x=z.styleSheet;x.disabled=false;if(!x.disabled){x.cssText=y}};w.prototype.getStyle=function(){var y=this.styleElement,x=y.styleSheet;x.disabled=false;if(!x.disabled){return x.cssText}return""}}else{w.prototype.setStyle=function(x){this.styleElement.innerHTML=x};w.prototype.getStyle=function(){return this.styleElement.innerHTML}}return w})(l);k.JSONLoader=(function(x,v,w){function y(z){if(z!==undefined){this.json=z;this.count=z.length}else{this.json=[];this.count=0}this.cellIds={};this.jS=null;this.handler=null}y.prototype={bindJS:function(z){this.jS=z;return this},bindHandler:function(z){this.handler=z;return this},size:function(C){var B={cols:0,rows:0},A=this.json,E,D,F,z;if((E=A[C])===undefined){return B}if((D=E.rows)===undefined){return B}if((F=D[0])===undefined){return B}if((z=F.columns)===undefined){return B}return{rows:D.length,cols:z.length}},getWidth:function(z,D){var B=this.json,F=B[z]||{},A=F.metadata||{},E=A.widths||[],C=E[D]||k.defaultColumnWidth;return C},getHeight:function(A,F){var B=this.json,D=B[A]||{},C=D.rows||[],E=C[F]||{},z=E.height||k.defaultRowHeight;return z},isHidden:function(z){var B=this.json,C=B[z]||{},A=C.metadata||{};return A.hidden===true},setMetadata:function(z,C){var B=this.json,E=B[z]||{},D=E.metadata||(E.metadata={});var A;for(A in C){if(C.hasOwnProperty(A)){D[A]=C[A]}}return this},setupCell:function(A,F,C){var E=v.createElement("td"),z=this.jitCell(A,F,C),D,B;if(z===null){return z}D=z.loadedFrom;if(D===null){return null}if(z.hasOwnProperty("formula")){E.setAttribute("data-formula",z.formula||"");if(D.hasOwnProperty("cache")){if(D.cache!==null&&D.cache!==""){E.innerHTML=D.cache}}}else{if(D.cellType!==undefined){E.setAttribute("data-celltype",D.cellType);z.cellType=D.cellType;if(D.hasOwnProperty("cache")){E.innerHTML=D.cache}}else{E.innerHTML=z.value}}if(D["class"]!==undefined){E.className=D["class"]}if(D.style!==undefined){E.setAttribute("style",D.style)}if(D.rowspan!==undefined){E.setAttribute("rowspan",D.rowspan)}if(D.colspan!==undefined){E.setAttribute("colspan",D.colspan)}if(D.uneditable!==undefined){E.setAttribute("data-uneditable",D.uneditable)}if(D.id!==undefined){E.setAttribute("id",D.id);z.id=D.id}E.jSCell=z;z.td=E;z.sheetIndex=A;z.rowIndex=F;z.columnIndex=C;return z},getCell:function(A,G,C){var B=this.json,E,D,F,z;if((E=B[A])===undefined){return null}if((D=E.rows)===undefined){return null}if((F=D[G-1])===undefined){return null}if((z=F.columns[C-1])===undefined){return null}return z},jitCell:function(G,J,V){var H=this.getCell(G,J,V);if(H===null){return null}if(H.getCell!==undefined){return H.getCell()}var U,T,N,S,P,L,z,B,Q,X,O,K,F,W,D,C,E,M,R,A,I;N=H.id;P=H.value;L=H.cache;z=H.formula;B=H.parsedFormula;Q=H.cellType;X=H.uneditable;K=H.dependencies;W=(N!==undefined&&N!==null);D=(P!==undefined&&P!==null);C=(L!==undefined&&L!==null&&(L+"").length>0);E=(z!==undefined&&z!==null&&z!=="");M=(B!==undefined&&B!==null);R=(Q!==undefined&&Q!==null);A=(X!==undefined&&X!==null);I=(K!==undefined&&K!==null);U=new k.Cell(G,null,this.jS,this.handler);U.rowIndex=J;U.columnIndex=V;U.loadedFrom=H;U.loader=this;if(W){U.id=N}if(E){U.formula=z}if(M){U.parsedFormula=B}if(R){U.cellType=Q}if(A){U.uneditable=X}if(D){U.value=new w(P)}else{U.value=new w()}if(C){U.value.html=L;U.needsUpdated=false}else{U.needsUpdated=(E||R||U.hasOperator.test(P))}if(I){S=K.length;for(T=0;T<S;T++){F=K[T];O=this.jitCell(F.s,F.r,F.c);if(O!==null){U.dependencies.push(O)}}}U.value.cell=U;H.getCell=function(){return U};return U},jitCellById:function(z){if(this.cellIds[z]!==undefined){return this.cellIds[z].requestCell()}var F=this,H=this.json,G=H.length-1,D,E,J,I,C,B,A;if(G<0){return null}do{D=H[G];J=D.rows;E=J.length-1;do{I=J[E];B=I.columns;C=B.length-1;do{A=B[C];if(typeof A.id=="string"){this.cellIds[z]={cell:A,sheetIndex:G,rowIndex:E,columnIndex:C,requestCell:function(){return F.jitCell(this.sheetIndex,this.rowIndex,this.columnIndex)}}}}while(C-->0)}while(E-->0)}while(G-->0);if(this.cellIds[z]!==undefined){return this.cellIds[z].requestCell()}return this.cellIds[z]=null},title:function(z){var A=this.json,B;if((B=A[z])===undefined){return""}return B.title||""},hiddenRows:function(C){var E=this.json[C].metadata||{},B=E.hiddenRows||[],A=B.length,z=[],D=0;for(;D<A;D++){z.push(B[D])}return z},hiddenColumns:function(B){var D=this.json[B].metadata||{},E=D.hiddenColumns||[],A=E.length,z=[],C=0;for(;C<A;C++){z.push(E[C])}return z},hasSpreadsheetAtIndex:function(z){return(this.json[z]!==undefined)},getSpreadsheetIndexByTitle:function(D){var B=this.json,z=this.count,A=0,C;D=D.toLowerCase();for(;A<z;A++){if(B[A]!==undefined){C=B[A].title;if(C!==undefined&&C!==null&&C.toLowerCase()==D){return A}}}return -1},addSpreadsheet:function(A,z){if(z===undefined){this.json.push(A)}else{this.json.splice(z,0,A)}this.count=this.json.length},getCellAttribute:function(z,A){return z[A]},setCellAttribute:function(z,A,B){z[A]=B},setCellAttributes:function(z,A){var B;for(B in A){if(A.hasOwnProperty(B)){z[B]=A[B]}}return this},setDependencies:function(A){if(A.dependencies.length>y.maxStoredDependencies){delete A.loadedFrom.dependencies;return this}var D=0,F=A.loadedFrom,E=A.dependencies,C,z=E.length,B=F.dependencies=[];for(;D<z;D++){C=E[D];B.push({s:C.sheetIndex,r:C.rowIndex,c:C.columnIndex})}return this},addDependency:function(z,A){var B=z.loadedFrom;if(B.dependencies===undefined){B.dependencies=[]}B.dependencies.push({s:A.sheetIndex,r:A.rowIndex,c:A.columnIndex});return this},cycleCells:function(F,E){var G=this.json,C,I,A,z,H,D,B;if((C=G[F])===undefined){return}if((D=(I=C.rows).length)<1){return}if(I[0].columns.length<1){return}D--;do{H=I[D];A=H.columns;B=A.length-1;do{z=A[B];E.call(z,F,D+1,B+1)}while(B-->0)}while(D-->0);return this},cycleCellsAll:function(B){var A=this.json,z=A.length-1;if(z<0){return}do{this.cycleCells(z,B)}while(z-->0);return this},toTables:function(){var T=this.json,S=this.count,I=x([]),E,K,F,B,C,M,L,O,z,V,H,N,U,J,D,A,G,R=0,Q,P;for(;R<S;R++){E=T[R];U=x(v.createElement("table"));if(E.title){U.attr("title",E.title||"")}I=I.add(U);K=E.rows;for(Q=0;Q<K.length;Q++){F=K[Q];if(N=(F.height+"").replace("px","")){A=x(v.createElement("tr")).attr("height",N).css("height",N+"px").appendTo(U)}B=F.columns;for(P=0;P<B.length;P++){C=B[P];G=x(v.createElement("td")).appendTo(A);if(C["class"]){G.attr("class",C["class"]||"")}if(C.style){G.attr("style",C.style||"")}if(C.formula){G.attr("data-formula",(C.formula?"="+C.formula:""))}if(C.cellType){G.attr("data-celltype",C.cellType||"")}if(C.value){G.html(C.value||"")}if(C.uneditable){G.html(C.uneditable||"")}if(C.rowspan){G.attr("rowspan",C.rowspan||"")}if(C.colspan){G.attr("colspan",C.colspan||"")}if(C.id){G.attr("id",C.id||"")}if(C.cache){G.html(C.cache)}}}if(M=E.metadata){if(L=M.widths){J=x(v.createElement("colgroup")).prependTo(U);for(P=0;P<L.length;P++){O=(L[P]+"").replace("px","");D=x(v.createElement("col")).attr("width",O).css("width",O+"px").appendTo(J)}}if(z=M.frozenAt){if(z.row){U.attr("data-frozenatrow",z.row)}if(z.col){U.attr("data-frozenatcol",z.col)}}if(V=M.hiddenRows){U.attr("data-hiddenrows",V.join(","))}if(H=M.hiddenColumns){U.attr("data-hiddencolumns",H.join(","))}}}return I},fromSheet:function(D){D=(D==undefined?false:D);var L=[],I=this.jS,R=1*I.i,N,E=I.spreadsheets.length-1,S,G,H,C,J,Q,B,z,O,K,M,P,F,A;if(E<0){return L}do{P=false;I.i=E;I.evt.cellEditDone();N=I.obj.pane();S={title:(I.obj.table().attr("title")||""),rows:[],metadata:{widths:[],frozenAt:{row:N.actionUI.frozenAt.row,col:N.actionUI.frozenAt.col}}};L.unshift(S);G=I.spreadsheets[E];H=G.length-1;do{F=G[H][1].td[0].parentNode;A=F.style.height;Q={columns:[],height:(A?A.replace("px",""):I.s.colMargin)};C=G[H].length-1;do{z=G[H][C];B={};O=z.td[0].attributes;if(D||P||O["class"]||z.formula||z.value||O.style){P=true;K=(O["class"]?x.trim((O["class"].value||"").replace(I.cl.uiCellActive,"").replace(I.cl.uiCellHighlighted,"")):"");M=z.td[0].parentNode;Q.columns.unshift(B);if(!Q.height){Q.height=(M.style.height?M.style.height.replace("px",""):I.s.colMargin)}if(z.formula){B.formula=z.formula}if(z.cellType){B.cellType=z.cellType}if(z.value){B.value=z.value}if(z.uneditable){B.uneditable=z.uneditable}if(z.cache){B.cache=z.cache}if(z.id){B.id=z.id}if(O.style&&O.style.value){B.style=O.style.value}if(K.length){B["class"]=K}if(O.rowspan){B.rowspan=O.rowspan.value}if(O.colspan){B.colspan=O.colspan.value}if(H*1==1){S.metadata.widths.unshift(x(I.col(null,C)).css("width").replace("px",""))}}}while(C-->1);if(P){S.rows.unshift(Q)}}while(H-->1)}while(E--);I.i=R;return this.json=L},type:y,typeName:"Sheet.JSONLoader",clearCaching:function(){var I=this.json,B,J,K,C,D,H=0,G,F,E=I.length,z,A;for(;H<E;H++){B=I[H];K=B.rows;z=K.length;for(G=0;G<z;G++){J=K[G];D=J.columns;A=D.length;for(F=0;F<A;F++){C=D[F];delete C.cache;delete C.dependencies;delete C.parsedFormula}}}return this},download:function(G){G=G||500;var M=f.open(),F,L,N=this.json,D=0,K=N.length-1,A;if(M!==undefined){F=M.document;F.write('<html>	<head id="head"></head>	<body>		<div id="entry">		</div>	</body></html>');L=x(F.getElementById("entry"));while(D<=K){A=N[D];if(A.rows.length>G){var J={title:A.title,metadata:A.metadata,rows:[]},E=[],I=0,P,O=A.rows,H=O.length,C=1,z=0,B=function(R,Q){L.append(v.createElement("br"));L.append(x(v.createElement("a")).attr("download",A.title+"-part"+Q+".json").attr("href",URL.createObjectURL(new Blob([JSON.stringify(R)],{type:"application/json"}))).text(A.title+" - part "+Q))};B(J,C);while(I<H){if(z===G){z=0;C++;B(E,C);E=[]}E.push(O[I]);z++;I++}if(E.length>0){C++;B(E,C)}}else{L.append(v.createElement("br")).append(x(v.createElement("a")).attr("download",A.title+".json").attr("href",URL.createObjectURL(new Blob([JSON.stringify(A)],{type:"application/json"}))).text(A.title))}D++}F.close();M.focus()}}};y.maxStoredDependencies=100;return y})(jQuery,l,p);k.XMLLoader=(function(w,v){function x(y){if(y!==undefined){this.xml=w.parseXML(y);this.spreadsheets=this.xml.getElementsByTagName("spreadsheets")[0].getElementsByTagName("spreadsheet");this.count=this.xml.length}else{this.xml=null;this.spreadsheets=null;this.count=0}}x.prototype={size:function(A){var y=this.xml[A],B=y.rows,C=B[0],z=C.columns;return{rows:B.length,cols:z.length}},setWidth:function(G,D,B){var C=this.spreadsheets,F=C[G],E=F.getElementsByTagName("metadata")[0]||{},z=E.getElementsByTagName("width")||[],A=z[D],y=(A.textContent||A.text);B.style.width=y+"px"},setRowHeight:function(z,F,D){var B=this.spreadsheets,A,C,E,y;if((A=B[z])===undefined){return}if((C=A.getElementsByTagName("rows")[0].getElementsByTagName("row"))===undefined){return}if((E=C[F])===undefined){return}if((y=E.attributes.height.nodeValue)===undefined){return}D.style.height=y+"px"},setupCell:function(G,B,A,y,C){var z=this.spreadsheets,F,H,D,E;if((F=z[G])===undefined){return false}if((H=F.getElementsByTagName("rows")[0].getElementsByTagName("row")[B-1])===undefined){return false}if((D=H.getElementsByTagName("columns")[0].getElementsByTagName("column")[A-1])===undefined){return false}y.cellType=D.attributes.cellType.nodeValue||"";if((E=D.jitCell)!==undefined){y.html=E.html;y.state=E.state;y.cellType=E.cellType;y.value=E.value;y.uneditable=E.uneditable;y.sheet=E.sheet;y.dependencies=E.dependencies}if(D.attributes.formula){y.formula=D.attributes.formula.nodeValue||"";C.setAttribute("data-formula",D.attributes.formula.nodeValue||"")}else{C.innerHTML=y.value=D.attributes.value.nodeValue||""}C.className=D.attributes["class"].nodeValue||"";C.setAttribute("style",D.attributes.style.nodeValue||"");if(D.attributes.rowspan){C.setAttribute("rowspan",D.attributes.rowspan.nodeValue||"")}if(D.attributes.colspan){C.setAttribute("colspan",D.attributes.colspan.nodeValue||"")}return true},getCell:function(y,A,z){return null},jitCell:function(z,E,C){var B=this.spreadsheets,A,D,y;if((A=B[z])===undefined){return false}if((D=A.getElementsByTagName("rows")[0].getElementsByTagName("row")[E-1])===undefined){return false}if((y=D.getElementsByTagName("columns")[0].getElementsByTagName("column")[C-1])===undefined){return false}return{td:{cellIndex:C,parentNode:{rowIndex:E},html:function(){}},html:[],state:[],cellType:y.attributes.cellType.nodeValue||"",formula:y.attributes.formula.nodeValue||"",value:y.attributes.value.nodeValue||"",type:"cell",sheet:z,id:null}},title:function(z){var A=this.spreadsheets,y;if((y=A[z])===undefined){return""}return(y.attributes.title?y.attributes.title.nodeValue:"")},getSpreadsheetIndexByTitle:function(y){},addSpreadsheet:function(y,z){if(z===undefined){this.spreadsheets.append.push(jsonSpreadsheet)}else{this.json.splice(z,0,jsonSpreadsheet)}this.count=this.json.length},setCellAttribute:function(y,z,A){},toTables:function(){var F=this.xml,J=w([]),D=F.getElementsByTagName("spreadsheets")[0].getElementsByTagName("spreadsheet"),G,N,H,B,E,W,Q,ac,P,M,O,T,R;for(var Z=0;Z<D.length;Z++){G=D[Z];var ab=w(v.createElement("table")).attr("title",(G.attributes.title?G.attributes.title.nodeValue:"")),L=w(v.createElement("colgroup")).appendTo(ab),z=w(v.createElement("tbody")).appendTo(ab);J=J.add(ab);N=G.getElementsByTagName("rows")[0].getElementsByTagName("row");Q=G.getElementsByTagName("metadata")[0];for(var X=0;X<N.length;X++){H=N[X];var A=w(v.createElement("tr")).appendTo(z);if(R=H.attributes.height){R=(R.nodeValue||"").replace("px","");A.css("height",R).attr("height",R+"px")}B=H.getElementsByTagName("columns")[0].getElementsByTagName("column");for(var V=0;V<B.length;V++){E=B[V];var I=w(v.createElement("td")).appendTo(A),y=E.getElementsByTagName("formula")[0],Y=E.getElementsByTagName("cellType")[0],U=E.getElementsByTagName("value")[0],aa=E.getElementsByTagName("style")[0],K=E.getElementsByTagName("class")[0],ad=E.getElementsByTagName("rowspan")[0],C=E.getElementsByTagName("colspan")[0],S=E.getElementsByTagName("id")[0];if(y){I.attr("data-formula","="+(y.textContent||y.text))}if(Y){I.attr("data-celltype",Y.textContent||Y.text)}if(U){I.html(U.textContent||U.text)}if(aa){I.attr("style",aa.textContent||aa.text)}if(K){I.attr("class",K.textContent||K.text)}if(ad){I.attr("rowspan",ad.textContent||ad.text)}if(C){I.attr("colspan",C.textContent||C.text)}if(S){I.attr("id",S.textContent||S.text)}}}O=Q.getElementsByTagName("width");for(var X=0;X<O.length;X++){T=(O[X].textContent||O[X].text).replace("px","");w(v.createElement("col")).attr("width",T).css("width",T+"px").appendTo(L)}ac=Q.getElementsByTagName("frozenAt")[0];if(ac){M=ac.getElementsByTagName("col")[0];P=ac.getElementsByTagName("row")[0];if(M){ab.attr("data-frozenatcol",(M.textContent||M.text)*1)}if(P){ab.attr("data-frozenatrow",(P.textContent||P.text)*1)}}}return J},fromSheet:function(K,E,F){E=(E==undefined?false:E);var N="",U=1*K.i,G=K.spreadsheets.length-1,z,I,J,D,L,S,T,B,A,Q,M,O,y,R,P,H,C;if(G<0){return N}do{R=false;K.i=G;K.evt.cellEditDone();y=w.extend({},K.obj.pane().actionUI.frozenAt);P=[];I=K.spreadsheets[G];J=I.length-1;S="";do{B="";D=I[J].length-1;do{T="";A=I[J][D];Q=A.td[0].attributes;M=(Q["class"]?w.trim((Q["class"].value||"").replace(K.cl.uiCellActive,"").replace(K.cl.uiCellHighlighted,"")):"");if(E||R||M||A.formula||A.value||Q.style){R=true;T+="<column>";if(A.formula){T+="<formula>"+A.formula+"</formula>"}if(A.cellType){T+="<cellType>"+A.cellType+"</cellType>"}if(A.value){T+="<value>"+A.value+"</value>"}if(Q.style){T+="<style>"+Q.style.value+"</style>"}if(M){T+="<class>"+M+"</class>"}if(Q.rowspan){T+="<rowspan>"+Q.rowspan.value+"</rowspan>"}if(Q.colspan){T+="<colspan>"+Q.colspan.value+"</colspan>"}if(Q.id){T+="<id>"+Q.id.value+"</id>"}T+="</column>";B=T+B;if(J*1==1){P[D]="<width>"+w(K.col(null,D)).css("width").replace("px","")+"</width>"}}}while(D-->1);if(B){H=I[J][1].td[0].parentNode;C=H.style.height;S='<row height="'+(C?C.replace("px",""):K.s.colMargin)+'"><columns>'+B+"</columns></row>"+S}}while(J-->1);z='<spreadsheet title="'+(K.obj.table().attr("title")||"")+'"><rows>'+S+"</rows><metadata>"+(y.row||y.col?"<frozenAt>"+(y.row?"<row>"+y.row+"</row>":"")+(y.col?"<col>"+y.col+"</col>":"")+"</frozenAt>":"")+"<widths>"+P.join("")+"</widths></metadata></spreadsheet>";N=z+N}while(G--);K.i=U;N='<?xml version="1.0" encoding="UTF-8"?><spreadsheets xmlns="http://www.w3.org/1999/xhtml">'+N+"</spreadsheets>";if(F!==true){this.xml=w.parseXML(N)}return N},type:x,typeName:"Sheet.XMLLoader"};return x})(jQuery,l);d.fn.extend({sheet:function(w){var x=isNaN,v=d.sheet.events;d(this).each(function(){var B=d(this),D=d.extend({},d.sheet.defaults,w||{}),C=this.jS;D.useStack=(f.thaw===undefined?false:D.useStack);D.useMultiThreads=(f.operative===undefined?false:D.useMultiThreads);if(C){var z=B.children().detach();C.kill();B.html(z);for(var A in v){if(v.hasOwnProperty(A)){B.unbind(v[A])}}}D.parent=B;if((this.className||"").match(/\bnot-editable\b/i)!=null){D.editable=false}for(var y in v){if(v.hasOwnProperty(y)){B.bind(v[y],D[v[y]])}}if(!d.sheet.instance.length){d.sheet.instance=[]}this.jS=C=d.sheet.createInstance(D,d.sheet.instance.length);d.sheet.instance.push(C)});return this},disableSelectionSpecial:function(){this.each(function(){this.onselectstart=function(){return false};this.unselectable="on";this.style["-moz-user-select"]="none"});return this},getSheet:function(){var v=this[0],w=(v.jS||{});return w},getCellValue:function(w,B,x,A){var y=this[0],z=(y.jS||{}),v;if(z.getCell){v=z.getCell(w,B,x);if(v!==null){v.updateValue(A)}}return this},setCellValue:function(z,y,A,D,C){var x=this[0],v=(x.jS||{}),B;D=(D||0);if(v.getCell&&(B=v.getCell(D,y,A))){try{if((z+"").charAt(0)=="="){B.valueOverride=B.value="";B.formula=z.substring(1)}else{B.value=z;B.valueOverride=B.formula=""}B.updateValue(C)}catch(w){}}return this},setCellFormula:function(x,z,A,D,C){var y=this[0],v=(y.jS||{}),B;D=(D||0);if(v.getCell){try{B=v.getCell(D,z,A);if(B!==null){B.formula=x;B.valueOverride=B.value="";B.updateValue(C)}}catch(w){}}return this},isSheetFullScreen:function(){var v=this[0],w=(v.jS||{});if(w.obj){return w.obj.fullScreen().is(":visible")}return false},serializeCellInputs:function(w){var x=this[0],y=(x.jS||{}),v=y.obj.tables().find(":input");if(w){return v.serializeArray()}else{return v.serialize()}},viewSource:function(v){var w="";d(this).each(function(){if(v){w+=d(this).toPrettySource()}else{w+=d(this).toCompactSource()}});d.printSource(w);return w},toCompactSource:function(){var z=this[0];var w="";if(z.nodeType==1){w+="<"+z.tagName.toLowerCase();var B=z.attributes.length;for(var y=0;y<B;y++){var x=z.attributes[y].name,A=z.getAttribute(x);if(A){if(x=="contentEditable"&&A=="inherit"){continue}if(typeof(A)=="string"){w+=" "+x+'="'+A.replace(/"/g,"'")+'"'}else{if(x=="style"&&A.cssText){w+=' style="'+A.cssText+'"'}}}}if(z.tagName=="COL"){w+="/>"}else{w+=">";var v="";d(z.childNodes).each(function(){v+=d(this).toCompactSource()});w+=v;w+="</"+z.tagName.toLowerCase()+">"}}else{if(z.nodeType==3){w+=z.data.replace(/^\s*(.*)\s*$/g,"$1")}}return w},toPrettySource:function(A){var z=this[0],C,y;A=A||"";var w="";if(z.nodeType==1){w+="\n"+A+"<"+z.tagName.toLowerCase();C=z.attributes.length;for(y=0;y<C;y++){var x=z.attributes[y].name,B=z.getAttribute(x);if(B){if(x=="contentEditable"&&B=="inherit"){continue}if(typeof(B)=="string"){w+=" "+x+'="'+d.trim(B.replace(/"/g,"'"))+'"'}else{if(x=="style"&&B.cssText){w+=' style="'+d.trim(B.cssText)+'"'}}}}if(z.childNodes.length<=0){if(z.tagName=="COL"){w+="/>"}else{w+="></"+z.tagName.toLowerCase()+">"}}else{w+=">";var v="";C=z.childNodes.length;for(y=0;y<C;y++){v+=d(z.childNodes[y]).toPrettySource(A+"  ")}w+=v;if(v.indexOf("\n")>=0){w+="\n"+A}w+="</"+z.tagName.toLowerCase()+">"}}else{if(z.nodeType==3){w+=z.data.replace(/^\s*(.*)\s*$/g,"$1")}}return w}});d.sheet={defaults:{editable:true,editableNames:true,barMenus:true,freezableCells:true,allowToggleState:true,menuLeft:null,menuRight:null,newColumnWidth:120,title:null,calcOff:false,lockFormulas:false,parent:null,colMargin:20,boxModelCorrection:2,formulaFunctions:{},formulaVariables:{},cellSelectModel:k.excelSelectModel,autoAddCells:true,resizableCells:true,resizableSheet:true,autoFiller:true,minSize:{rows:1,cols:1},error:function(v){return v.error},endOfNumber:false,frozenAt:[],contextmenuTop:{"Insert column after":function(v){v.controlFactory.addColumn(v.colLast);return false},"Insert column before":function(v){v.controlFactory.addColumn(v.colLast,true);return false},"Add column to end":function(v){v.controlFactory.addColumn();return false},"Delete this column":function(v){v.deleteColumn();return false},"Hide column":function(v){v.toggleHideColumn();return false},"Show all columns":function(v){v.columnShowAll()},"Toggle freeze columns to here":function(x){var v=x.getTdLocation(x.obj.tdActive()).col,w=x.obj.pane().actionUI;w.frozenAt.col=(w.frozenAt.col==v?0:v)}},contextmenuLeft:{"Insert row after":function(v){v.controlFactory.addRow(v.rowLast);return false},"Insert row before":function(v){v.controlFactory.addRow(v.rowLast,true);return false},"Add row to end":function(v){v.controlFactory.addRow();return false},"Delete this row":function(v){v.deleteRow();return false},"Hide row":function(v){v.toggleHideRow();return false},"Show all rows":function(v){v.rowShowAll()},"Toggle freeze rows to here":function(w){var x=w.getTdLocation(w.obj.tdActive()).row,v=w.obj.pane().actionUI;v.frozenAt.row=(v.frozenAt.row==x?0:x)}},contextmenuCell:{"Insert row after":function(v){v.controlFactory.addRow(v.rowLast);return false},"Insert row before":function(v){v.controlFactory.addRow(v.rowLast,true);return false},"Add row to end":function(v){v.controlFactory.addRow();return false},"Delete this row":function(v){v.deleteRow();return false},line2:"line","Insert column after":function(v){v.controlFactory.addColumn(v.colLast);return false},"Insert column before":function(v){v.controlFactory.addColumn(v.colLast,true);return false},"Add column to end":function(v){v.controlFactory.addColumn();return false},"Delete this column":function(v){v.deleteColumn();return false},line3:"line","Add spreadsheet":function(v){v.addSheet()},"Delete spreadsheet":function(v){v.deleteSheet()}},hiddenRows:[],hiddenColumns:[],alert:function(v){alert(v)},prompt:function(w,x,v){x(prompt(w,v))},confirm:function(x,v,w){if(confirm(x)){v()}else{if(w){w()}}},initCalcRows:1,initCalcCols:10,initScrollRows:0,initScrollCols:0,loader:null,useStack:true,useMultiThreads:true},instance:[],dependencies:{coreCss:{css:"jquery.sheet.css"},jQueryUI:{script:"jquery-ui/jquery-ui.min.js",thirdParty:true},jQueryUIThemeRoller:{css:"jquery-ui/themes/smoothness/jquery-ui.min.css",thirdParty:true},globalize:{script:"globalize/lib/globalize.js",thirdParty:true},nearest:{script:"jquery-nearest/src/jquery.nearest.min.js",thirdParty:true},mousewheel:{script:"MouseWheel/MouseWheel.js",thirdParty:true},operative:{script:"operative/dist/operative.js",thirdParty:true}},optional:{advancedFn:{script:"plugins/jquery.sheet.advancedfn.js"},financeFn:{script:"plugins/jquery.sheet.financefn.js"},colorPicker:{css:"really-simple-color-picker/colorPicker.css",script:"really-simple-color-picker/jquery.colorPicker.min.js",thirdParty:true},elastic:{script:"jquery-elastic/jquery.elastic.source.js",thirdParty:true},globalizeCultures:{script:"globalize/lib/cultures/globalize.cultures.js",thirdParty:true},raphael:{script:"raphael/raphael-min.js",thirdParty:true,async:false},gRaphael:{script:"graphael/g.raphael.js",thirdParty:true,async:false},gRaphaelBar:{script:"graphael/g.bar.js",thirdParty:true,async:false},gRaphaelDot:{script:"graphael/g.dot.js",thirdParty:true,async:false},gRaphaelLine:{script:"graphael/g.line.js",thirdParty:true,async:false},gRaphaelPie:{script:"graphael/g.pie.js",thirdParty:true,async:false},thaw:{script:"thaw.js/thaw.js",thirdParty:true},undoManager:{script:"Javascript-Undo-Manager/js/undomanager.js",thirdParty:true},zeroClipboard:{script:"zeroclipboard/dist/ZeroClipboard.min.js",thirdParty:true}},events:["sheetAddRow","sheetAddColumn","sheetSwitch","sheetRename","sheetTabSortStart","sheetTabSortUpdate","sheetCellEdit","sheetCellEdited","sheetCalculation","sheetAdd","sheetDelete","sheetDeleteRow","sheetDeleteColumn","sheetOpen","sheetAllOpened","sheetSave","sheetFullScreen","sheetFormulaKeydown"],preLoad:function(A,y){A=A||"";y=d.extend({skip:["globalizeCultures"],thirdPartyDirectory:"bower_components/"},y);var z=l.getElementsByTagName("script")[0],x=z.parentNode,w=function(){var B;if(this.script!==undefined){B=l.createElement("script");B.async=this.hasOwnProperty("async")?this.async:true;B.src=A+(this.thirdParty?y.thirdPartyDirectory:"")+this.script;x.insertBefore(B,z)}if(this.css!==undefined){B=l.createElement("link");B.rel="stylesheet";B.type="text/css";B.href=A+(this.thirdParty?y.thirdPartyDirectory:"")+this.css;x.insertBefore(B,z)}};for(var v in y.skip){if(this.dependencies[y.skip[v]]){delete this.dependencies[y.skip[v]]}if(this.optional[y.skip[v]]){delete this.optional[y.skip[v]]}}d.each(this.dependencies,function(){w.call(this)});d.each(this.optional,function(){w.call(this)})},createInstance:function(G,D){var J=this,M=function(P,I){var O=I.parentNode;if(O.lastchild==I){O.appendChild(P)}else{O.insertBefore(P,I.nextSibling)}},H=d(f),N=d(l),E=l.body,L=d(E),B=function(){},F=undefined,w=g,K=isNaN,A=NaN,y=f.thaw,x=(G.loader!==null),C={version:"4.x",i:0,I:D,sheetCount:0,spreadsheets:[],controls:{autoFiller:[],bar:{helper:[],corner:[],x:{controls:[],handleFreeze:[],menu:[],menuParent:[],parent:[],th:[],ths:function(){var O=[],Q=0,P=this.th[C.i],I=P.length;for(;Q<I;Q++){O.push(P[Q])}return O}},y:{controls:[],handleFreeze:[],menu:[],parent:[],th:[],ths:function(){var O=[],Q=0,P=this.th[C.i],I=P.length;for(;Q<I;Q++){O.push(P[Q])}return O}}},barMenuLeft:[],barMenuTop:[],barLeft:[],barTop:[],barTopParent:[],chart:[],tdMenu:[],cellsEdited:[],enclosure:[],enclosures:null,formula:null,fullScreen:null,header:null,inPlaceEdit:[],inputs:[],label:null,menuLeft:[],menuRight:[],menus:[],pane:[],panes:null,scrolls:null,sheetAdder:null,table:[],tables:null,tab:[],tabContainer:null,tabs:null,title:null,toggleHide:{x:[],y:[]},ui:null},obj:{autoFiller:function(){return C.controls.autoFiller[C.i]||d([])},barCorner:function(){return C.controls.bar.corner[C.i]||d([])},barHelper:function(){return C.controls.bar.helper[C.i]||(C.controls.bar.helper[C.i]=d([]))},barLeft:function(I){return(C.controls.bar.y.th[C.i]&&C.controls.bar.y.th[C.i][I]?C.controls.bar.y.th[C.i][I]:[])},barLeftControls:function(){return C.controls.bar.y.controls[C.i]||d([])},barLefts:function(){return C.controls.bar.y.ths()},barHandleFreezeLeft:function(){return C.controls.bar.y.handleFreeze[C.i]||d([])},barMenuLeft:function(){return C.controls.bar.y.menu[C.i]||d([])},barTop:function(I){return(C.controls.bar.x.th[C.i]&&C.controls.bar.x.th[C.i][I]?C.controls.bar.x.th[C.i][I]:[])},barTopControls:function(){return C.controls.bar.x.controls[C.i]||d([])},barTops:function(){return C.controls.bar.x.ths()},barTopParent:function(){return C.controls.bar.x.parent[C.i]||d([])},barHandleFreezeTop:function(){return C.controls.bar.x.handleFreeze[C.i]||d([])},barMenuParentTop:function(){return C.controls.bar.x.menuParent[C.i]||d([])},barMenuTop:function(){return C.controls.bar.x.menu[C.i]||d([])},tdActive:function(){return C.cellLast.td||null},tdMenu:function(){return C.controls.tdMenu[C.i]||d([])},cellsEdited:function(){return(C.controls.cellsEdited!==F?C.controls.cellsEdited:C.controls.cellsEdited=[])},chart:function(){return C.controls.chart[C.i]||d([])},enclosure:function(){return C.controls.enclosure[C.i]||d([])},enclosures:function(){return C.controls.enclosures||d([])},formula:function(){return C.controls.formula||d([])},fullScreen:function(){return C.controls.fullScreen||d([])},header:function(){return C.controls.header||d([])},highlighted:function(){return C.highlighter.last||d([])},menuRight:function(){return C.controls.menuRight[C.i]||d([])},inPlaceEdit:function(){return C.controls.inPlaceEdit[C.i]||d([])},inputs:function(){return C.controls.inputs[C.i]||d([])},label:function(){return C.controls.label||d([])},menus:function(){return C.controls.menus[C.i]||d([])},menuLeft:function(){return C.controls.menuLeft[C.i]||d([])},pane:function(){return C.controls.pane[C.i]||{}},panes:function(){return C.controls.panes||d([])},parent:function(){return G.parent},scrolls:function(){return C.controls.scrolls||d([])},sheetAdder:function(){return C.controls.sheetAdder||d([])},table:function(){return C.controls.table[C.i]||d([])},tables:function(){return C.controls.tables||d([])},tab:function(){return C.controls.tab[C.i]||d([])},tabs:function(){return C.controls.tabs||d([])},tabContainer:function(){return C.controls.tabContainer||d([])},title:function(){return C.controls.title||d([])}},id:"jS_"+D+"_",cl:{autoFiller:"jSAutoFiller",autoFillerHandle:"jSAutoFillerHandle",autoFillerCover:"jSAutoFillerCover",barCorner:"jSBarCorner",barController:"jSBarController",barControllerChild:"jSBarControllerChild",barHelper:"jSBarHelper",barLeft:"jSBarLeft",barHandleFreezeLeft:"jSBarHandleFreezeLeft",barTop:"jSBarTop",barTopMenuButton:"jSBarTopMenuButton",barHandleFreezeTop:"jSBarHandleFreezeTop",barTopParent:"jSBarTopParent",chart:"jSChart",formula:"jSFormula",formulaParent:"jSFormulaParent",header:"jSHeader",fullScreen:"jSFullScreen",inPlaceEdit:"jSInPlaceEdit",menu:"jSMenu",menuFixed:"jSMenuFixed",parent:"jSParent",scroll:"jSScroll",sheetAdder:"jSSheetAdder",table:"jS",label:"jSLoc",pane:"jSEditPane",tab:"jSTab",tabContainer:"jSTabContainer",tabContainerScrollable:"jSTabContainerScrollable",tdMenu:"jSTdMenu",title:"jSTitle",enclosure:"jSEnclosure",ui:"jSUI"},msg:{addRowMulti:"How many rows would you like to add?",addColumnMulti:"How many columns would you like to add?",cellFind:"What are you looking for in this spreadsheet?",cellNoFind:"No results found.",dragToFreezeCol:"Drag to freeze column",dragToFreezeRow:"Drag to freeze row",addSheet:"Add a spreadsheet",openSheet:"Are you sure you want to open a different sheet?  All unsaved changes will be lost.",toggleHideRow:"No row selected.",toggleHideColumn:"No column selected.",loopDetected:"Loop Detected",newSheetTitle:"What would you like the sheet's title to be?",notFoundColumn:"Column not found",notFoundRow:"Row not found",notFoundSheet:"Sheet not found",setCellRef:"Enter the name you would like to reference the cell by.",sheetTitleDefault:"Spreadsheet {index}",maxRowsBrowserLimitation:"You've reached the maximum amount of rows this browser supports. Try using Chrome, FireFox, or Internet Explorer 9+",maxColsBrowserLimitation:"You've reached the maximum amount of columns this browser supports. Try using Chrome, FireFox, or Internet Explorer 9+",maxSizeBrowserLimitationOnOpen:"The spreadsheet you are loading is larger than the maximum size of cells this browser supports. Try using Chrome, Firefox, or Internet Explorer 9+. You can an proceed, but the spreadsheet may not work as intended.",cellLoading:"Loading..."},kill:function(){if(!C){return false}d(l).unbind("keydown");this.obj.fullScreen().remove();(this.obj.inPlaceEdit().destroy||B)();G.parent.trigger("sheetKill").removeClass(C.theme.parent).html("");delete G.parent[0].jS;this.obj.menus().remove();var I=d.sheet.events.length;for(var O=0;O<I;O++){G.parent.unbind(d.sheet.events[O])}d.sheet.instance.splice(D,1);return true},trigger:function(I,O){O=O||[];return G.parent.triggerHandler(I,[C].concat(O))},spreadsheetsToArray:function(I){if(I||C.spreadsheets.length==0){C.cycleCellsAll(function(P,Q,O){C.createCell(P,Q,O)})}return C.spreadsheets},spreadsheetToArray:function(O,I){I=(I?I:C.i);if(!C.spreadsheets[I]){C.cycleCells(function(Q,R,P){C.createCell(Q,R,P)})}return C.spreadsheets[I]},createCell:function(S,V,X,ac){var P,T,W,aa,ae,Z,Q,R,O,U,ag,af,I,ab,ad,ah,Y;if((P=C.spreadsheets[S])===F){P=C.spreadsheets[S]=[]}if((T=P[V])===F){T=P[V]=[]}if((ae=C.controls.tables[S])===F){return null}if((R=ae.tBody)===F){return null}if((O=R.children[V])===F){return null}if((U=O.children[X])===F){return null}W=T[X]=U.jSCell=new k.Cell(S,U,C,C.cellHandler);I=U.getAttribute("data-formula");ab=U.getAttribute("data-celltype");ah=U.getAttribute("data-uneditable");Y=U.getAttribute("id");if(I!==null){W.formula=I}if(ab!==null){W.cellType=ab;ad=true}if(ah!==null){W.uneditable=ah}if(Y!==null){W.id=Y}aa=U.textContent||U.innerText;switch(typeof(aa)){case"object":break;case"undefined":aa=new p();break;case"number":W.value=new s(aa);break;case"boolean":W.value=new t(aa);break;case"string":default:W.value=new p(aa);break}W.value.cell=W;W.calcCount=ac||0;W.needsUpdated=W.formula.length>0||ad;if(W.formula.length>0&&W.formula.charAt(0)=="="){W.formula=W.formula.substring(1)}Z=ae.colGroup;if((Q=Z.children[X])===F){Q=l.createElement("col");Q.setAttribute("style","width:"+C.s.newColumnWidth+"px;");Z.appendChild(Q)}if((af=C.controls.bar.y.th[S])===F){af=C.controls.bar.y.th[S]=[]}if(af[V]===F){af[V]=O.children[0]}if((ag=C.controls.bar.x.th[S])===F){ag=C.controls.bar.x.th[S]=[]}if(ag[X]!==F){ag[X]=R.children[0].children[X]}return W},getCell:function(P,S,Q){var O,R,I;if((O=C.spreadsheets[P])===F||(R=O[S])===F||(I=R[Q])===F){if(G.loader!==null){I=G.loader.jitCell(P,S,Q)}}if(I===F||I===null){return null}I.sheetIndex=P;I.rowIndex=S;I.columnIndex=Q;return I},getCellById:function(R,O,S){var Q=G.loader!==null,I,P;if(typeof O==="function"){P=-1;S=O}else{P=O;if(typeof P==="sting"){P=G.loader.getSpreadsheetIndexByTitle(P)}}if(Q){I=G.loader.jitCellById(R,P);if(S!==F&&I!==null){S.call(I);return this}return I}return null},getCells:function(I,T){var P=0,Q=I.length,O=Q-1,R,V,S,U=[];for(;P<Q;P++){R=I[P];if(typeof R==="string"){S=C.getCellById(R)}else{V=R;S=C.getCell(V.sheet,V.rowIndex,V.columnIndex)}if(S!==null){U.push(S)}}return U},updateCells:function(I,U){var P=0,Q=I.length,O=Q-1,R,V,T,S=[];for(;P<Q;P++){R=I[P];if(typeof R==="string"){T=C.getCellById(R)}else{V=R;T=C.getCell(V.sheet,V.rowIndex,V.columnIndex)}if(T!==null){if(U!==F){(function(W,X){W.updateValue(function(Y){O--;S[X]=Y;if(O<0){U.apply(C,S)}})})(T,P)}}else{O--}}},nav:false,setNav:function(P){var I=d.sheet.instance;for(var O=0;O<I.length;O++){(I[O]||{}).nav=false}C.nav=P},controlFactory:{addRowMulti:function(Q,T,P,I,S){var O=(S?"row-init":"row");function R(U){if(U){if(!K(U)){C.controlFactory.addCells(Q,P,parseInt(U),O,I);C.trigger("sheetAddRow",[Q,P,U])}}}if(!T){G.prompt(C.msg.addRowMulti,R)}else{R(T)}},addColumnMulti:function(Q,T,P,I,S){var O=(S?"col-init":"col");function R(U){if(U){if(!K(U)){C.controlFactory.addCells(Q,P,parseInt(U),O,I);C.trigger("sheetAddColumn",[Q,P,U])}}}if(!T){G.prompt(C.msg.addColumnMulti,R)}else{R(T)}},rowAdder:new k.RowAdder(),columnAdder:new k.ColumnAdder(),addCells:function(am,at,ab,S,ae){if(ab<1){return false}C.autoFillerHide();C.setDirty(true);C.setChanged(true);C.obj.barHelper().remove();var T,ak=C.obj.pane(),aq=ak.table,Z=ak.actionUI,W=aq.tBody,an=aq.colGroup,ad=false,aj=C.obj.tdActive(),Y=C.spreadsheets[C.i]||(C.spreadsheets[C.i]=[]),al,X,ah=C.cl.barLeft+" "+C.theme.bar,ar=C.cl.barTop+" "+C.theme.bar,aa,ac=(G.loader!==null?G.loader:null),Q=(ac!==null?function(av,au){return ac.getWidth(av,au)}:function(){return G.newColumnWidth}),ag=(ac!==null?function(au,av){return ac.getHeight(au,av)}:function(){return G.colMargin}),V=function(av,ay,aw,au){var ax=l.createElement("td");return new k.Cell(C.i,ax,C,C.cellHandler)},ai=(ac!==null?ac.setupCell:V),R=C.controls.bar.x.th[C.i]||(C.controls.bar.x.th[C.i]=[]),P=C.controls.bar.y.th[C.i]||(C.controls.bar.y.th[C.i]=[]),af=ak.size(),ap=aq.size(),I=l.createDocumentFragment(),O,U=Z.yDetacher,ao=false;ab=ab||1;S=S||"col";switch(S){case"row-init":case"row":O=Z.maximumVisibleRows;if(am===F||am===null){am=Y.length-1;ad=true}if(S==="row-init"&&am===Y.length-1){ad=true}if(am>af.rows){am=af.rows;ad=true}T=am;if(T>ap.rows){T=ap.rows}else{if(am===0){at=false}}if(ad){ao=U.isBelowActive();if(ao){am+=U.detachedBelow.length-1}}aa={row:am,col:0};al=this.rowAdder;if(al.setQty(ab,ap)===false){if(!C.isBusy()){G.alert(C.msg.maxRowsBrowserLimitation)}return}al.setCreateBarFn(function(ax,av){var au=l.createElement("tr"),aw=l.createElement("th");aw.className=ah;aw.entity="left";aw.type="bar";aw.style.height=ag(C.i,ax)+"px";aw.innerHTML=aw.label=ax;au.appendChild(aw);if(!av){if(ao){U.detachedBelow.push(au)}else{if(W.children.length+I.children.length<Z.maximumVisibleRows){I.appendChild(au);if(I.children.length===O){ao=true}}else{U.detachedBelow.push(au)}}}if(Y.length===0){P[ax]=aw;Y[ax]=[]}else{P.splice(ax,0,aw);Y.splice(ax,0,[])}return au});al.setCreateCellFn(function(aA,ay,av,aw){var au=ai.call(ac,C.i,aA,ay,C),az,ax=Y[aA];if(au===null){au=V(C.i,aA,ay,C)}az=au.td;az.jSCell=au;if(ax.length===0){ax[ay]=au}else{ax.splice(ay,0,au)}if(!aw){au.updateValue()}av.insertBefore(az,av.children[ay])});al.setHidden(G.hiddenRows[C.i]);al.setAddedFinishedFn(function(au){W.insertBefore(I,at?W.children[T]:W.children[T].nextSibling);X=au});break;case"col":case"col-init":if(am===F||am===null){am=ap.cols;ad=true}if(S==="col-init"){ad=true}if(am>af.cols){am=af.cols;ad=true}T=am;if(T>ap.cols){T=ap.cols}else{if(am===0){at=false}}aa={row:0,col:am};al=this.columnAdder;if(al.setQty(ab,ap)===false){if(!C.isBusy()){G.alert(C.msg.maxColsBrowserLimitation)}return}al.setCreateBarFn(function(ay){var aw=W.children[0],ax=l.createElement("col"),az=l.createElement("th"),av,au=W.children[1];ax.style.width=Q(C.i,ay)+"px";az.entity="top";az.type="bar";az.innerHTML=az.label=h.columnLabelString(ay);az.className=ar;if(au===F){av=l.createElement("th");av.setAttribute("class",ah);av.entity="left";av.type="bar";au=l.createElement("tr");au.style.height=ag(C.i,ay)+"px";au.appendChild(av);W.appendChild(au);av.innerHTML=au.rowIndex;P.splice(0,0,av)}an.insertBefore(ax,an.children[ay]);aw.insertBefore(az,aw.children[ay]);if(R.length===0){R[ay]=az}else{R.splice(ay,0,az)}return{bar:az,col:ax,barParent:aw}});al.setCreateCellFn(function(aA,ay,aw){var av=ai.call(ac,C.i,aA,ay,C),az,au,ax=Y[aA];if(av===null){av=V(C.i,aA,ay,C)}az=av.td;if(ax===F){Y[aA]=ax=[];au=W.children[aA]}else{au=ax[1].td.parentNode}if(ax.length===0){ax[ay]=av}else{ax.splice(ay,0,av)}av.updateValue();au.insertBefore(az,au.children[ay])});al.setAddedFinishedFn(function(au){C.refreshColumnLabels(am);X=au});break}al.createCells(am,ap,at);if(!ae&&ad!=true){C.offsetFormulas(aa,X,at)}if(ak.inPlaceEdit){ak.inPlaceEdit.goToTd()}if(aj&&aj[0]&&aj[0].cellIndex&&aj[0].parentNode){C.colLast=aj[0].cellIndex;C.rowLast=aj[0].parentNode.rowIndex}return true},addRow:function(O,I){C.controlFactory.addCells(O,I,1,"row");C.trigger("sheetAddRow",[O,I,1])},addColumn:function(O,I){C.controlFactory.addCells(O,I,1,"col");C.trigger("sheetAddColumn",[O,I,1])},barLeft:function(Q){var R=Q.tBody.children,P,O=R.length-1,I=C.controls.bar.y.th[C.i]=[];if(O>0){do{P=l.createElement("th");I[O]=P;R[O].insertBefore(P,R[O].children[0])}while(O-->1)}},barTop:function(X){var O=X.colGroup,W=O.children,R,P=X.tBody.children[0],T=l.createElement("col"),U=l.createElement("th"),S=l.createElement("tr"),Q=0,V=C.controls.bar.x.th[C.i]=[];if(P===F){O.innerHTML=""}else{Q=P.children.length;while(W.length>Q){O.removeChild(W[W.length-1])}}T.style.width=T.style.minWidth=G.colMargin+"px";O.insertBefore(T,O.children[0]);S.appendChild(U);S.className=C.cl.barTopParent;X.tBody.insertBefore(S,X.tBody.children[0]);X.barTopParent=S;X.corner=U;U.col=T;C.controls.barTopParent[C.i]=d(S);R=g.min(Q,G.initCalcCols);if(R>0){do{var I=l.createElement("th");V[R]=I;if(!W[R]){W[R]=l.createElement("col");O.insertBefore(W[R],T.nextSibling)}W[R].bar=I;I.col=W[R];S.insertBefore(I,U.nextSibling)}while(R-->1)}X.barTop=C.controls.barTopParent[C.i].children();return S},barHandleFreeze:{top:function(P){if(C.isBusy()){return false}var I=C.obj.pane().actionUI,Z=I.frozenAt,V=I.scrolledArea;if(!(V.col<=(Z.col+1))){return false}C.obj.barHelper().remove();var aa=P.table,Y=aa.tBody,Q=Y.children[0],S=Q.children,U=d(S[Z.col+1]),X=U.position(),W,R=d(P).offset(),T=l.createElement("div"),O=P.freezeHandleTop=d(T).appendTo(P).addClass(C.theme.barHandleFreezeTop+" "+C.cl.barHelper+" "+C.cl.barHandleFreezeTop).height(U.height()).css("left",(X.left-T.clientWidth)+"px").attr("title",C.msg.dragToFreezeCol);C.controls.bar.helper[C.i]=C.obj.barHelper().add(T);C.controls.bar.x.handleFreeze[C.i]=O;C.draggable(O,{axis:"x",start:function(){C.setBusy(true);W=d(l.createElement("div")).appendTo(P).css("position","absolute").addClass(C.theme.barFreezeIndicator+" "+C.cl.barHelper).height(P.table.corner.clientHeight).fadeTo(0,0.33)},drag:function(){var ab=C.nearest(O,S).prev();if(ab.length&&ab.position){W.width(ab.position().left+ab.width())}},stop:function(ad,ab){W.remove();C.setBusy(false);C.setDirty(true);var ac=C.nearest(O,S);C.obj.barHelper().remove();V.col=I.frozenAt.col=C.getTdLocation(ac[0]).col-1;C.autoFillerHide()},containment:[R.left,R.top,w.min(R.left+P.table.clientWidth,R.left+P.clientWidth-f.scrollBarSize.width),R.top]});return true},left:function(P){if(C.isBusy()){return false}var P=C.obj.pane(),I=P.actionUI,Y=I.frozenAt,U=I.scrolledArea;if(!(U.row<=(Y.row+1))){return false}C.obj.barHelper().remove();var Z=P.table,X=Z.tBody,T=d(X.children[Y.row+1].children[0]),W=T.position(),V,Q=d(P).offset(),S=l.createElement("div"),R=X.children,O=P.freezeHandleLeft=d(S).appendTo(P).addClass(C.theme.barHandleFreezeLeft+" "+C.cl.barHelper+" "+C.cl.barHandleFreezeLeft).width(T.width()).css("top",(W.top-S.clientHeight+1)+"px").attr("title",C.msg.dragToFreezeRow);C.controls.bar.helper[C.i]=C.obj.barHelper().add(S);C.controls.bar.y.handleFreeze[C.i]=O;C.draggable(O,{axis:"y",start:function(){C.setBusy(true);V=d(l.createElement("div")).appendTo(P).css("position","absolute").addClass(C.theme.barFreezeIndicator+" "+C.cl.barHelper).width(S.clientWidth).fadeTo(0,0.33)},drag:function(){var aa=C.nearest(O,R).prev();if(aa.length&&aa.position){V.height(aa.position().top+aa.height())}},stop:function(ac,aa){V.remove();C.setBusy(false);C.setDirty(true);var ab=C.nearest(O,R);C.obj.barHelper().remove();U.row=I.frozenAt.row=w.max(C.getTdLocation(ab.children(0)[0]).row-1,0);C.autoFillerHide()},containment:[Q.left,Q.top,Q.left,w.min(Q.top+P.table.clientHeight,Q.top+P.clientHeight-f.scrollBarSize.height)]});return true},corner:function(){}},menu:function(P,I){var S,O=d([]),R=C.theme.menuHover;switch(P){case"top":S=d(l.createElement("div")).addClass(C.theme.menu+" "+C.cl.tdMenu);C.controls.bar.x.menu[C.i]=S;break;case"left":S=d(l.createElement("div")).addClass(C.theme.menu+" "+C.cl.tdMenu);C.controls.bar.y.menu[C.i]=S;break;case"cell":S=d(l.createElement("div")).addClass(C.theme.menu+" "+C.cl.tdMenu);C.controls.tdMenu[C.i]=S;break}C.controls.menus[C.i]=C.obj.menus().add(S);S.mouseleave(function(){S.hide()}).bind("contextmenu",function(){return false}).appendTo(L).hide().disableSelectionSpecial();for(var Q in I){if(I[Q]){if(d.isFunction(I[Q])){O.pushStack(d(l.createElement("div")).text(Q).data("msg",Q).click(function(){I[d(this).data("msg")].call(this,C);S.hide();return false}).appendTo(S).hover(function(){O.removeClass(R);d(this).addClass(R)},function(){d(this).removeClass(R)}))}else{if(I[Q]=="line"){d(l.createElement("hr")).appendTo(S)}}}}return S},barMenu:{top:function(P,I,O){if(C.isBusy()){return false}var R=C.obj.barMenuTop().hide();if(!R.length){R=C.controlFactory.menu("top",G.contextmenuTop)}C.obj.menus().hide();if(!O){R.css("left",(P.pageX-5)+"px").css("top",(P.pageY-5)+"px").show();return R}var Q=C.obj.barMenuParentTop().hide();if(!Q.length){Q=d(l.createElement("div")).addClass(C.theme.barMenuTop+" "+C.cl.barHelper+" "+C.cl.barTopMenuButton).append(d(l.createElement("span")).addClass("ui-icon ui-icon-triangle-1-s")).mousedown(function(S){Q.parent().mousedown().mouseup();var T=Q.offset();R.css("left",(S.pageX-5)+"px").css("top",(S.pageY-5)+"px").show()}).blur(function(){if(R){R.hide()}});Q.get(0).destroy=function(){Q.remove();C.controls.bar.x.menuParent[C.i]=null};C.controls.bar.x.menuParent[C.i]=Q}Q.prependTo(O).show()},left:function(O,I){if(C.isBusy()){return false}C.obj.barMenuLeft().hide();if(I){C.obj.barHandleFreezeLeft().remove()}var P;P=C.obj.barMenuLeft();if(!P.length){P=C.controlFactory.menu("left",G.contextmenuLeft)}C.obj.menus().hide();P.css("left",(O.pageX-5)+"px").css("top",(O.pageY-5)+"px").show();return true},corner:function(){}},tdMenu:function(I){if(C.isBusy()){return false}C.obj.tdMenu().hide();var O=C.obj.tdMenu();if(!O.length){O=C.controlFactory.menu("cell",G.contextmenuCell)}C.obj.menus().hide();O.css("left",(I.pageX-5)+"px").css("top",(I.pageY-5)+"px").show();return true},header:function(){C.obj.header().remove();C.obj.sheetAdder().remove();C.obj.tabContainer().remove();var V=l.createElement("div"),P=l.createElement("table"),S=l.createElement("tr"),Y,Q,Z=l.createElement("td"),aa,R,O,W,I;V.appendChild(P);P.appendChild(S);V.className=C.cl.header+" "+C.theme.control;C.controls.header=d(V);if(G.title){if(d.isFunction(G.title)){G.title=C.title(C,D)}Z.className=C.cl.title;C.controls.title=d(Z).html(G.title)}else{d(Z).hide()}S.appendChild(Z);function X(ac){if(d.isFunction(ac)){ac=d(ac.call(C))}else{ac=d(ac)}if(ac.is("ul")){ac.find("ul").hide().addClass(C.theme.menuUl);ac.find("li").addClass(C.theme.menuLi).hover(function(){d(this).find("ul:first").hide().show()},function(){d(this).find("ul:first").hide()})}return ac}if(C.isSheetEditable()){if(G.menuLeft){R=l.createElement("td");R.className=C.cl.menu+" "+C.cl.menuFixed+" "+C.theme.menuFixed;S.insertBefore(R,Z);C.controls.menuLeft[C.i]=d(R).append(X(G.menuLeft)).children().addClass(C.theme.menuFixed);C.controls.menuLeft[C.i].find("img").load(function(){C.sheetSyncSize()})}if(G.menuRight){O=l.createElement("td");O.className=C.cl.menu+" "+C.cl.menuFixed;S.appendChild(O);C.controls.menuRight[C.i]=d(O).append(X(G.menuRight)).children().addClass(C.theme.menuFixed);C.controls.menuRight[C.i].find("img").load(function(){C.sheetSyncSize()})}aa=l.createElement("td");aa.className=C.cl.label+" "+C.theme.control;C.controls.label=d(aa);W=l.createElement("textarea");W.className=C.cl.formula+" "+C.theme.controlTextBox;W.onkeydown=C.evt.formula.keydown;W.onkeyup=function(){C.obj.inPlaceEdit().value=this.value};W.onchange=function(){C.obj.inPlaceEdit().value=this.value};W.onpaste=C.evt.pasteOverCells;W.onfocus=function(){C.setNav(false)};W.onfocusout=function(){C.setNav(true)};W.onblur=function(){C.setNav(true)};C.controls.formula=d(W);var U=l.createElement("span");U.appendChild(W);Y=l.createElement("table");Q=l.createElement("tr");Y.appendChild(Q);V.appendChild(Y);I=l.createElement("td");I.className=C.cl.formulaParent;I.appendChild(U);Q.appendChild(aa);Q.appendChild(I);Q.appendChild(l.createElement("td"));C.resizableSheet(d(U),{minHeight:C.controls.formula.height(),maxHeight:78,handles:"s",resize:function(ad,ac){C.controls.formula.height(ac.size.height)},stop:function(){C.sheetSyncSize()}});var ab=d.sheet.instance;for(var T=0;T<ab.length;T++){(ab||{}).nav=false}C.setNav(true);d(l).keydown(C.evt.document.keydown)}return V},ui:function(){var I=l.createElement("div");I.setAttribute("class",C.cl.ui);C.obj.ui=I;return I},sheetAdder:function(){var I=l.createElement("span");if(C.isSheetEditable()){I.setAttribute("class",C.cl.sheetAdder+" "+C.cl.tab+" "+C.theme.tab);I.setAttribute("title",C.msg.addSheet);I.innerHTML="+";I.onmousedown=function(){C.addSheet();return false};I.i=-1}return C.controls.sheetAdder=d(I)},tabContainer:function(){var I=l.createElement("span"),O;I.setAttribute("class",C.cl.tabContainer);I.onmousedown=function(Q){Q=Q||f.event;var P=(Q.target||Q.srcElement).i;if(P>=0){C.trigger("sheetSwitch",[P])}return false};I.ondblclick=function(Q){Q=Q||f.event;var P=(Q.target||Q.srcElement).i;if(P>=0){C.trigger("sheetRename",[P])}return false};if(C.isSheetEditable()&&d.fn.sortable){return C.controls.tabContainer=d(I).sortable({placeholder:"ui-state-highlight",axis:"x",forceHelperSize:true,forcePlaceholderSize:true,opacity:0.6,start:function(Q,P){O=P.item.index();C.trigger("sheetTabSortStart",[Q,P])},update:function(Q,P){C.trigger("sheetTabSortUpdate",[Q,P,O])}})}return C.controls.tabContainer=d(I)},sheetUI:function(X,Y,R){C.i=R;C.tuneTableForSheetUse(Y);C.readOnly[R]=(Y.className||"").match(/\breadonly\b/i)!=null;var T=Y.tBody.children.length>0,S=C.controlFactory.enclosure(Y),Q=C.s,O=Q.hiddenRows[R],W=Q.hiddenColumns[R],P=S.pane,I=d(P),U=function(ac){ac=ac||f.event;if(C.isBusy()){return false}if(C.isBar(ac.target)){var aa=ac.target.entity,ab=C.getBarIndex[aa](ac.target);if(ab<0){return false}if(C.evt.barInteraction.first==C.evt.barInteraction.last){C.controlFactory.barMenu[aa](ac,ab)}}else{C.controlFactory.tdMenu(ac)}return false};X.appendChild(S);C.controlFactory.barTop(Y);C.controlFactory.barLeft(Y);P.appendChild(Y);if(C.isSheetEditable()){C.controlFactory.autoFiller(P)}if(C.isSheetEditable()){var V=C.obj.formula(),Z="";I.mousedown(function(aa){C.setNav(true);if(C.isBusy()){return false}if(C.isCell(aa.target)){if(aa.button==2){U.call(this,aa);C.evt.cellOnMouseDown(aa);return true}C.evt.cellOnMouseDown(aa);return false}if(C.isBar(aa.target)){if(aa.button==2){U.call(this,aa)}Z=aa.target.entity;C.evt.barInteraction.select(aa.target);return false}return true});P.onmouseup=function(){Z=""};P.onmouseover=function(ae){ae=ae||f.event;var ad=ae.target||ae.srcElement;if(C.isBusy()){return false}if(!C.isBar(ad)){return false}var ac=d(ad),aa=ad.entity,ab=C.getBarIndex[aa](ad);if(ab<0){return false}if(C.evt.barInteraction.selecting&&aa==Z){C.evt.barInteraction.last=ab;C.cellSetActiveBar(aa,C.evt.barInteraction.first,C.evt.barInteraction.last)}else{C.resizeBar[aa](ac,ab,P,Y);if(C.isSheetEditable()){C.controlFactory.barHandleFreeze[aa](P);if(aa=="top"){C.controlFactory.barMenu[aa](ae,ab,ac)}}}return true};P.ondblclick=C.evt.cellOnDblClick;I.bind("contextmenu",U).disableSelectionSpecial().bind("cellEdit",C.evt.cellEdit)}C.createSpreadsheet(Y,R);if(Q.loader!==null){O=Q.loader.hiddenRows(R);W=Q.loader.hiddenColumns(R)}else{if(O===F||O.length<1){O=Y.getAttribute("data-hiddenrows");if(O!==null){O=c.toNumbers(O.split(","))}}if(W===F||W.length<1){W=Y.getAttribute("data-hiddencolumns");if(W!==null){W=c.toNumbers(W.split(","))}}}if(Q.hiddenRows[R]===F){Q.hiddenRows[R]=[]}if(Q.hiddenColumns[R]===F){Q.hiddenColumns[R]=[]}S.actionUI.hide(O,W);Q.hiddenRows[R]=O;Q.hiddenColumns[R]=W;C.checkMinSize(Y);C.controlFactory.tab();C.setChanged(true)},enclosure:function(ab){var W=l.createElement("div"),S=d(W),I=new k.ActionUI(W,ab,C.cl.scroll,C.s.frozenAt[C.i],d.sheet.max),aa=I.scrollUI,P=I.pane,Z=ab.tBody,ac=Z.children,R=ab.colGroup.children,V,U=0,X=0,Q,O,Y,T;ab.size=function(){return C.tableSize(ab)};P.size=function(){return C.sheetSize(ab)};P.scrollToX=function(){if(T){return}Y=false;Q=aa.scrollLeft;if(U!==Q){U=Q;Y=I.scrollToPixelX(Q)}};P.scrollToY=function(){T=false;O=aa.scrollTop;if(X!==O){T=I.scrollToPixelY(O,X>O);X=O}};P.updateX=function(){if(T){return}if(Y){C.calcVisibleCol(I)}};P.updateY=function(){if(T){C.calcVisibleRow(I);C.updateYBarWidthToCorner(I)}};P.finishScroll=function(){if(Y||T){C.obj.barHelper().remove();C.autoFillerGoToTd();if(P.inPlaceEdit){P.inPlaceEdit.goToTd()}}};V=[P.updateY,P.scrollToY,P.updateX,P.scrollToX,P.finishScroll];aa.onscroll=function(){this.scrollTop=0;this.scrollLeft=0;aa.onscroll=function(){if(C.isBusy()){return}y(V)}};aa.onmousedown=function(){C.obj.barHelper().remove()};W.actionUI=P.actionUI=I;W.scrollUI=P.scrollUI=aa;W.appendChild(aa);aa.scrollTop=0;aa.scrollLeft=0;P.setAttribute("class",C.cl.pane+" "+C.theme.pane);W.appendChild(P);W.setAttribute("class",C.cl.enclosure);W.pane=P;W.table=ab;P.table=ab;P.enclosure=W;P.$enclosure=S;ab.pane=P;ab.enclosure=W;ab.$enclosure=S;C.controls.pane[C.i]=P;C.controls.panes=C.obj.panes().add(P);C.controls.enclosure[C.i]=S;C.controls.enclosures=C.obj.enclosures().add(W);return W},tab:function(){var I=l.createElement("span"),O=C.controls.tab[C.i]=d(I).appendTo(C.obj.tabContainer());I.setAttribute("class",C.cl.tab+" "+C.theme.tab);C.sheetTab(true,function(P){I.innerHTML=P});I.i=C.i;C.controls.tabs=C.obj.tabs().add(O);return I},customTab:function(P){var I=l.createElement("span"),O=d(I).appendTo(C.obj.tabContainer());I.setAttribute("class",C.cl.tab+" "+C.theme.tab);I.innerHTML=P;return O},inPlaceEdit:function(T,O){T=T||C.obj.tdActive();if(T===null){T=C.rowTds(null,1)[1];C.cellEdit(T)}if(T===null){return}(C.obj.inPlaceEdit().destroy||B)();var S=C.obj.formula(),P=S.val(),I,R,Q=C.obj.pane();if(!T.isHighlighted){return}I=l.createElement("textarea");R=d(I);Q.inPlaceEdit=I;I.i=C.i;I.className=C.cl.inPlaceEdit+" "+C.theme.inPlaceEdit;I.td=T;I.goToTd=function(){this.offset=d(T).position();if(!this.offset.left&&!this.offset.right){d(I).hide()}else{this.setAttribute("style","left:"+(this.offset.left-1)+"px;top:"+(this.offset.top-1)+"px;width:"+this.td.clientWidth+"px;height:"+this.td.clientHeight+"px;min-width:"+this.td.clientWidth+"px;min-height:"+this.td.clientHeight+"px;")}};I.goToTd();I.onkeydown=C.evt.inPlaceEdit.keydown;I.onchange=I.onkeyup=function(){S[0].value=I.value};I.onfocus=function(){C.setNav(false)};I.onblur=I.onfocusout=function(){C.setNav(true)};I.onpaste=C.evt.pasteOverCells;I.destroy=function(){Q.inPlaceEdit=null;C.cellLast.isEdit=(I.value!=P);I.parentNode.removeChild(I);C.controls.inPlaceEdit[I.i]=false};Q.appendChild(I);I.onfocus();C.controls.inPlaceEdit[C.i]=I;R.focus().val("").val(S[0].value);if(O){R.select()}if(d.fn.elastic){d(I).elastic()}},autoFiller:function(Q){if(!G.autoFiller){return false}var O=l.createElement("div"),I=l.createElement("div"),P=l.createElement("div");O.i=C.i;O.className=C.cl.autoFiller+" "+C.theme.autoFiller;I.className=C.cl.autoFillerHandle;P.className=C.cl.autoFillerCover;O.onmousedown=function(){var S=C.obj.tdActive();if(S){var R=C.getTdLocation(S);C.cellSetActive(S,R,true,C.autoFillerNotGroup,function(){var U=C.highlighted(),T=C.getTdLocation(U.last());C.fillUpOrDown(T.row<R.row||T.col<R.col);C.autoFillerGoToTd(S);C.autoFillerNotGroup=false})}return false};Q.autoFiller=C.controls.autoFiller[C.i]=d(O);Q.appendChild(O);return true}},autoFillerNotGroup:true,tsv:new TSV(),updateCellsAfterPasteToFormula:function(W){var V=0,U=C.obj.formula(),Y=new a();W=W||U.val();var T={row:C.cellLast.row,col:C.cellLast.col},O=U.val(),Q=O;if((T.row==0&&T.col==0)||O.length===0){return false}var Z=C.tsv.parse(O);if(!d.isArray(Z)){U.val(Z);C.fillUpOrDown(false,Z);return true}for(var S=0;S<Z.length;S++){C.cellLast.isEdit=true;var I=Z[S];for(var R=0;R<I.length;R++){V++;var P=C.getTd(-1,S+T.row,R+T.col);if(P===null){continue}P.row=T.row;P.col=T.col;if(P.length){if(!C.spreadsheets[C.i]||!C.spreadsheets[C.i][S+T.row]||!C.spreadsheets[C.i][S+T.row][R+T.col]){continue}var X=C.spreadsheets[C.i][S+T.row][R+T.col];if(X){G.parent.one("sheetPreCalculation",function(){if((I[R]+"").charAt(0)=="="){X.formula=I[R].substring(1);X.value="";P.setAttribute("data-formula",I[R])}else{X.formula="";X.value=I[R];P.removeData("formula")}});C.resolveCell(X);if(S==0&&R==0){Q=I[R]}}}}}if(O!=Q){U.val(Q)}C.fillUpOrDown(false,Q);C.evt.cellEditDone(true);return true},evt:{inPlaceEdit:{enter:function(I){if(I.shiftKey){return true}return C.evt.cellSetActiveFromKeyCode(I,true)},tab:function(I){if(I.shiftKey){return true}return C.evt.cellSetActiveFromKeyCode(I,true)},keydown:function(I){I=I||f.event;C.trigger("sheetFormulaKeydown",[true]);switch(I.keyCode){case r.ENTER:return C.evt.inPlaceEdit.enter(I);break;case r.TAB:return C.evt.inPlaceEdit.tab(I);break;case r.ESCAPE:C.evt.cellEditAbandon();return false;break}}},formula:{keydown:function(I){I=I||f.event;if(C.readOnly[C.i]){return false}if(C.cellLast.row<0||C.cellLast.col<0){return false}C.trigger("sheetFormulaKeydown",[false]);switch(I.keyCode){case r.C:if(I.ctrlKey){return C.evt.document.copy(I)}case r.X:if(I.ctrlKey){return C.evt.document.cut(I)}case r.Y:if(I.ctrlKey){C.evt.document.redo(I);return false}break;case r.Z:if(I.ctrlKey){C.evt.document.undo(I);return false}break;case r.ESCAPE:C.evt.cellEditAbandon();return true;break;case r.ENTER:C.evt.cellSetActiveFromKeyCode(I,true);return false;break;case r.UNKNOWN:return false}C.cellLast.isEdit=true},If:function(O,I){if(O){d(C.obj.tdActive()).dblclick();return true}return false}},document:{enter:function(I){if(!C.cellLast.isEdit&&!I.ctrlKey){d(C.obj.tdActive()).dblclick()}return false},tab:function(I){C.evt.cellSetActiveFromKeyCode(I)},findCell:function(I){if(I.ctrlKey){C.cellFind();return false}return true},redo:function(I){if(I.ctrlKey&&!C.cellLast.isEdit){C.undo.manager.redo();return false}return true},undo:function(I){if(I.ctrlKey&&!C.cellLast.isEdit){C.undo.manager.undo();return false}return true},copy:function(R,O){var Q=C.highlighted(true),S=C.obj.formula(),P=S.val(),I=C.toTsv(Q,O);S.val(I).focus().select();N.one("keyup",function(){if(O){S.val("")}else{S.val(P)}});return true},cut:function(I){return this.copy(I,true)},pageUpDown:function(I){var Q=C.sheetSize(),U=C.obj.pane(),P=U.clientHeight,R=0,S=0,T,O;if(I){for(O=C.cellLast.row;O>0&&R<P;O--){T=C.getTd(-1,O,1);if(T!==null&&!T.getAttribute("data-hidden")&&d(T).is(":hidden")){d(T).show()}R+=T.parentNode.clientHeight}}else{for(O=C.cellLast.row;O<Q.rows&&R<P;O++){T=C.getTd(-1,O,1);if(T===null){continue}R+=T.parentNode.clientHeight}}C.cellEdit(T);return false},keydown:function(I){I=I||f.event;if(C.readOnly[C.i]){return false}if(C.cellLast.row<0||C.cellLast.col<0){return false}var O=C.cellLast.td;if(C.nav){switch(I.keyCode){case r.DELETE:C.toTsv(null,true);C.obj.formula().val("");break;case r.TAB:C.evt.document.tab(I);break;case r.ENTER:C.evt.cellSetActiveFromKeyCode(I);break;case r.LEFT:case r.UP:case r.RIGHT:case r.DOWN:(I.shiftKey?C.evt.cellSetHighlightFromKeyCode(I):C.evt.cellSetActiveFromKeyCode(I));break;case r.PAGE_UP:C.evt.document.pageUpDown(true);break;case r.PAGE_DOWN:C.evt.document.pageUpDown();break;case r.HOME:case r.END:C.evt.cellSetActiveFromKeyCode(I);break;case r.V:if(I.ctrlKey){return C.evt.formula.If(!C.evt.pasteOverCells(I),I)}else{d(O).trigger("cellEdit");return true}break;case r.Y:if(I.ctrlKey){C.evt.document.redo(I);return false}else{d(O).trigger("cellEdit");return true}break;case r.Z:if(I.ctrlKey){C.evt.document.undo(I);return false}else{d(O).trigger("cellEdit");return true}break;case r.ESCAPE:C.evt.cellEditAbandon();break;case r.F:if(I.ctrlKey){return C.evt.formula.If(C.evt.document.findCell(I),I)}else{d(O).trigger("cellEdit");return true}break;case r.CAPS_LOCK:case r.SHIFT:case r.ALT:break;case r.CONTROL:C.obj.formula().focus().select();return true;break;default:if(C.obj.inPlaceEdit().td!==O){d(O).trigger("cellEdit")}return true;break}return false}}},pasteOverCells:function(O){O=O||f.event;if(O.ctrlKey||O.type=="paste"){var I=function(){C.updateCellsAfterPasteToFormula()};var P=N.one("keyup",function(){I();I=function(){};P.mouseup()}).one("mouseup",function(){I();I=function(){};P.keyup()});C.setDirty(true);C.setChanged(true);return true}return false},cellEditDone:function(I){var O=C.obj.inPlaceEdit(),P=d(O).is(":focus");(C.obj.inPlaceEdit().destroy||B)();if(C.cellLast.isEdit||I){var S=(P?d(O):C.obj.formula()),Q=C.obj.tdActive();if(C.isFormulaEditable(Q)){if(Q&&C.cellLast.row>0&&C.cellLast.col>0){var V=S.val(),W=Q.jSCell,R=0,U=G.loader,T;if(!W.edited){W.edited=true;C.obj.cellsEdited().push(W)}G.parent.one("sheetPreCalculation",function(){W.parsedFormula=null;if(V.charAt(0)=="="){Q.setAttribute("data-formula",V);W.formula=V}else{Q.removeAttribute("data-formula");W.value=V;W.formula="";if((T=W.loadedFrom)!==F){U.setCellAttributes(T,{cache:F,formula:"",value:V})}}W.setNeedsUpdated()});C.resolveCell(W);C.cellLast.isEdit=false;C.trigger("sheetCellEdited",[W])}}}},cellEditAbandon:function(I){(C.obj.inPlaceEdit().destroy||B)();C.highlighter.clearBar().clear();if(!I){C.calc()}C.cellLast.td=null;C.cellLast.row=0;C.cellLast.col=0;C.rowLast=0;C.colLast=0;C.highlighter.start={row:0,col:0};C.highlighter.end={row:0,col:0};C.labelUpdate("",true);C.obj.formula().val("").blur();C.autoFillerHide();return false},cellSetHighlightFromKeyCode:function(R){var Q=C.highlightedLastOrdered(),P=C.sheetSize(),U=C.obj.tdActive(),S=C.getTdLocation(U),T=Q.start,I=Q.end,O=C.highlighter;switch(R.keyCode){case r.UP:if(T.row<S.row){T.row--;T.row=w.max(T.row,1);break}I.row--;I.row=w.max(I.row,1);break;case r.DOWN:if(T.row===T.end){T.row++;T.row=w.min(T.row,P.rows);break}if(T.row<S.row){T.row++;T.row=w.max(T.row,1);break}I.row++;I.row=w.min(I.row,P.rows);break;case r.LEFT:if(T.col<S.col){T.col--;T.col=w.max(T.col,1);break}I.col--;I.col=w.max(I.col,1);break;case r.RIGHT:if(T.col<S.col){T.col++;T.col=w.min(T.col,P.cols);break}I.col++;I.col=w.min(I.col,P.cols);break}C.highlighter.start=T;C.highlighter.end=I;C.cycleCellArea(function(V){O.set(V.td)},T,I);return false},cellSetActiveFromKeyCode:function(R,I){var S={row:C.cellLast.row,col:C.cellLast.col},Q=false,P,O=false;switch(R.keyCode){case r.UP:S.row--;break;case r.DOWN:S.row++;break;case r.LEFT:S.col--;break;case r.RIGHT:S.col++;break;case r.ENTER:S=C.evt.incrementAndStayInGrid(C.highlightedLastOrdered(),S,"row","col",R.shiftKey);Q=true;P=C.highlighted();if(P.length>1){O=true}else{if(!I){S.row+=(R.shiftKey?-1:1)}if(G.autoAddCells&&S.row>C.sheetSize().rows){C.controlFactory.addRow()}}break;case r.TAB:S=C.evt.incrementAndStayInGrid(C.highlightedLastOrdered(),S,"col","row",R.shiftKey);Q=true;P=C.highlighted();if(P.length>1){O=true}else{if(!I){S.col+=(R.shiftKey?-1:1)}if(G.autoAddCells&&S.col>C.sheetSize().cols){C.controlFactory.addColumn()}}break;case r.HOME:S.col=1;break;case r.END:S.col=C.obj.tdActive().parentNode.children.length-2;break}S.col=S.col||1;S.row=S.row||1;if(!C.cellLast.isEdit||Q){var T=C.getTd(-1,S.row,S.col);if(T!==null){C.cellEdit(T,null,O);return false}}return true},incrementAndStayInGrid:function(Q,R,O,I,P){if(P){R[O]--;if(R[O]<Q.start[O]){R[O]=Q.end[O];R[I]--}if(R[I]<Q.start[I]){R[I]=Q.end[I]}}else{R[O]++;if(R[O]>Q.end[O]){R[O]=Q.start[O];R[I]++}if(R[I]>Q.end[I]){R[I]=Q.start[I]}}return R},cellOnMouseDown:function(I){C.obj.formula().blur();if(I.shiftKey){C.getTdRange(I,C.obj.formula().val())}else{C.cellEdit(I.target,true)}},cellOnDblClick:function(I){if(C.isBusy()){return false}C.controlFactory.inPlaceEdit();return true},cellEdit:function(I){if(C.isBusy()){return false}C.controlFactory.inPlaceEdit(null,true);return true},barInteraction:{first:0,last:0,selecting:false,select:function(P){if(!P){return}if(!P.type=="bar"){return}var I=P.entity,O=C.getBarIndex[I](P);if(O<0){return false}C[I+"Last"]=O;C.evt.barInteraction.last=C.evt.barInteraction.first=O;C.cellSetActiveBar(I,C.evt.barInteraction.first,C.evt.barInteraction.last);C.evt.barInteraction.first=C.evt.barInteraction.last=C[I+"Last"]=O;C.evt.barInteraction.selecting=true;N.one("mouseup",function(){C.evt.barInteraction.selecting=false});return false}}},refreshColumnLabels:function(S){S=S||0;var O=C.obj.barMenuParentTop();if((O)&&(O.length)){var R=O.get(0);if(d.isFunction(R.destroy)){R.destroy()}}var I=C.controls.bar.x.th[C.i],Q;if(!I){return}for(var P=g.max(S,0);P<I.length;P++){if(P>0){Q=I[P];Q.innerHTML=Q.label=h.columnLabelString(Q.cellIndex)}}},refreshRowLabels:function(R,I){R=R||0;var O=C.controls.bar.y.th[C.i],Q;if(!O){return}I=I||O.length;for(var P=R;P<I;P++){if(P>0){Q=O[P];Q.innerHTML=Q.label=Q.parentNode.rowIndex}}},isCell:function(I){if(I&&I.jSCell!==F){return true}return false},isBar:function(I){if(I&&I.tagName&&I.tagName=="TH"&&I.type&&I.type=="bar"){return true}return false},readOnly:[],isSheetEditable:function(I){I=I||C.i;return(G.editable==true&&!C.readOnly[I])},isFormulaEditable:function(I){if(G.lockFormulas){if(I.data("formula")!==F){return false}}return true},toggleFullScreen:function(){if(!C){return}C.evt.cellEditDone();var P=C.obj.fullScreen(),S=C.obj.pane();if(P.is(":visible")){H.unbind("jSResize");L.removeClass("bodyNoScroll");G.parent=P[0].origParent;G.parent.prepend(P.children());P.remove();C.sheetSyncSize();if(S.inPlaceEdit){S.inPlaceEdit.goToTd()}C.trigger("sheetFullScreen",[false])}else{L.addClass("bodyNoScroll");var Q=d(G.parent),P=l.createElement("div"),O=d._data(G.parent[0],"events");P.className=C.cl.fullScreen+" "+C.theme.fullScreen+" "+C.cl.parent;P.origParent=Q;G.parent=C.controls.fullScreen=d(P).append(Q.children()).appendTo(L);H.bind("resize",function(){H.trigger("jSResize")}).bind("jSResize",function(){this.w=H.width();this.h=H.height();G.parent.width(this.w).height(this.h);C.sheetSyncSize();if(S.inPlaceEdit){S.inPlaceEdit.goToTd()}}).trigger("jSResize");Q.trigger("sheetFullScreen",[true]);for(var R in O){for(var I=0;I<O[R].length;I++){G.parent.bind(R,O[R][I].handler)}}}},renameSheet:function(I){if(K(I)){return false}if(I>-1){C.sheetTab()}return true},switchSheet:function(I){if(K(I)){return false}if(I==-1){C.addSheet()}else{if(I!=C.i){C.setActiveSheet(I);if(G.loader===null){C.calc(I)}}}return true},tuneTableForSheetUse:function(P){var O=d(P);C.controls.table[C.i]=O.addClass(C.cl.table).addClass(C.theme.table).attr("id",C.id+C.i).attr("border","1px").attr("cellpadding","0").attr("cellspacing","0");P.spreadsheetIndex=C.i;C.formatTable(P);C.sheetDecorateRemove(false,O);C.controls.tables=C.obj.tables().add(P);var Q=O.attr("data-frozenatrow")*1,I=O.attr("data-frozenatcol")*1;if(!C.s.frozenAt[C.i]){C.s.frozenAt[C.i]={row:0,col:0}}if(Q){C.s.frozenAt[C.i].row=Q}if(I){C.s.frozenAt[C.i].col=I}},createSpreadsheet:function(O,I){this.createSpreadsheetForArea(O,I)},createSpreadsheetForArea:function(al,aj,aa,ah,ae,Q){var ad,V=al.tBody,am,ac=(G.loader!==null?G.loader:null),S=G.colMargin+"px",ak=(ac!==null?ac.setRowHeight:function(ao,at,ar){var aq,ap,an=S;if((aq=ar.nextSibling)===F){return an}if((ap=aq.style)===F){return an}if(ap.height!==F){an=ap.height}ar.style.height=an}),ag=al.pane,af=V.children,I,Y=ag.actionUI,T=Y.yDetacher,U,W,R,P,ab,O,X,ai,Z;if(aa===F&&ae===F){al.spreadsheet=C.spreadsheets[aj]=[]}U=al.spreadsheet;aa=aa||0;ah=(ah===F&&G.loader===null?af.length-1:ah||1);ae=ae||0;Q=(Q===F&&G.loader===null?af[0].children.length-1:Q||1);ad=aa;for(;ad<=ah;ad++){W=U[ad];am=ae;if(W===F){if(x){O=(U.length>0?U.length-1:0);ab=ad-O;C.controlFactory.addCells(O,false,(ab>0?ab:1),"row-init");W=U[ad]}else{W=U[ad]=[]}}am=ae;for(;am<=Q;am++){if(ad>0&&am>0){P=W[am];if(P===F){if(x){X=(W.length>0?W.length-1:0);ab=am-X;C.controlFactory.addCells(W.length-1,false,ab>0?ab:1,"col-init");P=W[am]}else{C.createCell(aj,ad,am);P=W[am];P.needsUpdated=true;P.updateValue()}}else{P.updateValue()}}else{I=af[ad];Z=(I!==F?I.children[am]:null);if(Z!==null){if(am==0&&ad>0){Z.type="bar";Z.entity="left";Z.innerHTML=ad;Z.className=C.cl.barLeft+" "+C.cl.barLeft+"_"+C.i+" "+C.theme.bar;if(ak!==F){ak.call(ac,aj,ad,Z)}}if(ad==0&&am>0){Z.type="bar";Z.entity="top";Z.innerHTML=h.columnLabelString(am);Z.className=C.cl.barTop+" "+C.cl.barTop+"_"+C.i+" "+C.theme.bar}if(ad==0&&am==0){Z.type="bar";Z.entity="corner";Z.className=C.theme.bar+" "+C.cl.barCorner;C.controls.bar.corner[C.i]=Z}}}}}},updateYBarWidthToCorner:function(I){var T=I.scrolledArea,Y=I.table,V=Y.tBody,W=Y.corner,S=g.min(G.initCalcRows+T.row,T.row+20,V.lastChild.rowIndex),U=V.children[S],P,X,R,O=20,Q=W.col;if(U===F){return}P=U.children[0];if(P.label===F){return}X=P.label+"";R=f.defaultCharSize.width*X.length;R=(R>O?R:O);if(R!==Q._width||Q._width===F){Q._width=R;Q.style.width=(R)+"px"}},toggleHideRow:function(I){I=I||C.rowLast;if(!I){return}var O=C.obj.pane().actionUI;O.toggleHideRow(I);C.autoFillerGoToTd()},toggleHideRowRange:function(P,O){var I=C.obj.pane().actionUI;I.toggleHideRowRange(P,O);C.autoFillerGoToTd()},toggleHideColumn:function(I){I=I||C.colLast;if(!I){return}var O=C.obj.pane().actionUI;O.toggleHideColumn(I);C.autoFillerGoToTd()},toggleHideColumnRange:function(P,O){var I=C.obj.pane().actionUI;I.toggleHideColumnRange(P,O);C.autoFillerGoToTd()},rowShowAll:function(){C.obj.pane().actionUI.rowShowAll()},columnShowAll:function(){C.obj.pane().actionUI.columnShowAll()},merge:function(T){T=T||C.highlighted();if(!T.length){return}var R=[],I=T[0],Q=T[T.length-1],Y=C.getTdLocation(I),O=C.getTdLocation(Q),aa={},W={},V=0,X=0,S=T.length-1,Z,ab,P,U;if(Y.row){C.setDirty(true);C.setChanged(true);if(Y.row<O.row){aa.row=Y.row;W.row=O.row;P=I}else{aa.row=O.row;W.row=Y.row;P=Q}if(P.getAttribute("rowSpan")||P.getAttribute("colSpan")){return false}if(Y.col<O.col){aa.col=Y.col;W.col=O.col}else{aa.col=O.col;W.col=Y.col}X=(W.row-aa.row)+1;V=(W.col-aa.col)+1;U=C.getTdLocation(P);do{ab=T[S];Z=ab.jSCell;if(Z.formula||Z.value){R.unshift(Z.formula?"("+Z.formula.substring(1)+")":Z.value)}G.parent.one("sheetPreCalculation",function(){if(ab.cellIndex!=U.col||ab.parentNode.rowIndex!=U.row){Z.formula=null;Z.value="";Z.defer=P.jSCell;ab.removeAttribute("data-formula");ab.removeAttribute("data-celltype");ab.innerHTML="";ab.style.display="none";ab.colSpan=V-(ab.cellIndex-P.cellIndex);ab.rowSpan=X-(ab.parentNode.rowIndex-P.parentNode.rowIndex)}});C.resolveCell(Z)}while(S--);P.jSCell.value=R.join(" ");P.jSCell.formula=(P.jSCell.formula?R.join(" "):"");P.style.display="";P.setAttribute("rowSpan",X);P.setAttribute("colSpan",V);C.resolveCell(P.jSCell);C.evt.cellEditDone();C.autoFillerGoToTd(P);C.cellSetActive(P,U)}return true},unmerge:function(O){O=O||C.highlighted();if(!O){return}var S=C.getTdLocation(O),T=new a(),V=w.max(O.getAttribute("rowSpan")*1,1)-1,I=w.max(O.getAttribute("colSpan")*1,1)-1,R=V+S.row,P,U,Q=[];if(V==0&&I==0){return false}do{P=S.col+I;do{U=C.getTd(-1,R,P);if(U===null){continue}U.style.display="";U.removeAttribute("colSpan");U.removeAttribute("rowSpan");U.jSCell.defer=null;C.resolveCell(U.jSCell,T);Q.push(U)}while(P-->S.col)}while(R-->S.row);C.evt.cellEditDone();C.autoFillerGoToTd(O);C.cellSetActive(O,S);C.highlighter.set(Q);return true},fillUpOrDown:function(U,V,X){C.evt.cellEditDone();X=X||C.highlighted(true);if(X.length<1){return false}var R=C.obj.tdActive();if(X.length<1){return false}var S=C.getTdLocation(X[0].td),Y=C.getTdLocation(X[X.length-1].td),I=C.getTdLocation(R),P={row:0,col:0},O=V||R.jSCell.value,W=false,Q=X.length-1,T=function(){};V=V||R.jSCell.value;if(Q>=0){if(V.charAt&&V.charAt(0)=="="){if(Q>=0){do{if(!U){P.row=I.row-Y.row;P.col=I.col-Y.col}else{P.row=I.row-S.row;P.col=I.col-S.col}O=C.reparseFormula(V,P);G.parent.one("sheetPreCalculation",function(){X[Q].formula=O;X[Q].value="";X[Q].td.setAttribute("data-formula",O)});C.resolveCell(X[Q])}while(Q--);return true}}else{if((W=!K(O))||O.length>0){if(W&&O!=""){O*=1;if(U){O-=X.length-1}T=function(){O++}}}do{G.parent.one("sheetPreCalculation",function(){X[Q].formula="";X[Q].value=O+"";X[Q].td.removeAttribute("data-formula")});C.resolveCell(X[Q]);T()}while(Q--);return true}}return false},toTsv:function(X,Q,V){X=X||C.highlighted(true);if(X.type){X=[X]}V=V||function(aa,Z){if(Q){G.parent.one("sheetPreCalculation",function(){Z.formula="";Z.value=""});C.resolveCell(Z)}};var T=[],W,S,O={},P=X.length-1,Y,I;if(P>=0){W=C.getTdLocation(X[0].td);S=C.getTdLocation(X[X.length-1].td);O.row=w.min(W.row,S.row);O.col=w.min(W.col,S.col);do{var R=C.getTdLocation(X[P].td),U=(X[P].formula?"="+X[P].formula:X[P].value);Y=w.abs(R.row-O.row);I=w.abs(R.col-O.col);if(!T[Y]){T[Y]=[]}if((U+="").match(/\n/)){U='"'+U+'"'}T[Y][I]=(U||"");V.call(X[P].td,R,X[P])}while(P-->0);P=T.length-1;do{T[P]=T[P].join("\t")}while(P-->0);return T.join("\n")}return""},offsetFormulas:function(T,S,P,R){var O=C.sheetSize(),Q={first:{row:1,col:1},last:{row:O.rows,col:O.cols}},I=[];C.cycleCells(function(){var U=this;if(this.formula&&typeof this.formula=="string"&&C.isFormulaEditable(this.td)){this.formula=C.reparseFormula(this.formula,S,T,P,R);this.td.setAttribute("data-formula","="+this.formula)}I.push(function(){C.resolveCell(U,true)})},Q.first,Q.last);while(I.length){I.pop()()}C.evt.cellEditDone()},reparseFormula:function(R,Q,P,I,O){return R.replace(h.regEx.cell,function(T,U,Y,Z){if(U=="SHEET"){return T}Q=Q||{loc:0,row:0};var S={row:Y*1,col:h.columnLabelIndex(U)},X,W,V={row:Y,col:U,use:false};if(P){if(O){if(I){if(S.col&&S.col==P.col-1){V.col="#REF!";V.use=true}if(S.row&&S.row==P.row-1){V.row="#REF!";V.use=true}if(S.col>=P.col){X=true}if(S.row>=P.row){W=true}}else{if(P.col&&S.col==P.col){V.col="#REF!";V.use=true}if(P.row&&S.row==P.row){V.row="#REF!";V.use=true}if(P.col&&S.col>P.col){X=true}if(P.row&&S.row>P.row){W=true}}if(V.use){return V.col+V.row}if(X){S.col+=Q.col;return C.makeFormula(S)}if(W){S.row+=Q.row;return C.makeFormula(S)}}else{if(I){if(P.col&&S.col>=P.col){X=true}if(P.row&&S.row>=P.row){W=true}}else{if(P.col&&S.col>P.col){X=true}if(P.row&&S.row>P.row){W=true}}if(X){S.col+=Q.col;return C.makeFormula(S)}if(W){S.row+=Q.row;return C.makeFormula(S)}}}else{return C.makeFormula(S,Q)}return T})},makeFormula:function(O,I){I=d.extend({row:0,col:0},I);O.col+=I.col;O.row+=I.row;if(O.col<0){O.col=0}if(O.row<0){O.row=0}return h.parseCellName(O.col,O.row)},cycleCells:function(R,U,P,O){O=O||C.i;U=U||{row:1,col:1};if(!P){var W=C.sheetSize();P={row:W.rows,col:W.cols}}var I=C.spreadsheets[O],Q=P.row,T,V,S;if(Q<U.row){return}do{T=P.col;V=I[Q];do{S=V[T];R.call(S,O,Q,T)}while(T-->U.col)}while(Q-->U.row)},cycleCellsAll:function(Q){var R=C.i,P,O,I;for(P=0;P<=C.sheetCount;P++){C.i=P;O=C.sheetSize();I={row:O.rows,col:O.cols};C.cycleCells(Q,{row:0,col:0},I,P)}C.i=R},cycleCellArea:function(V,Z,S,R,W){var I={start:{},end:{}},U,Y,aa,X,Q=C.i,O={cell:[],td:[]},T=C.spreadsheets[Q],P=(W?"unshift":"push");if(R){I.start=Z;I.end=S}else{I.start.row=w.max(w.min(Z.row,S.row),1);I.start.col=w.max(w.min(Z.col,S.col),1);I.end.row=w.max(Z.row,S.row,1);I.end.col=w.max(Z.col,S.col,1)}U=I.end.row;do{Y=I.end.col;aa=T[U]||null;do{if(aa){X=aa[Y]||null;if(X){O.cell[P](X);O.td[P](X.td)}}}while(Y-->I.start.col)}while(U-->I.start.row);if(V){V(O)}},formatTable:function(aa){var Y=G.newColumnWidth+"px",T=G.colMargin+"px",O=aa.children,R=O.length-1,Q,P,W,I,U,Z,S,X=(G.loader!==null?G.loader:null),V=(X!==null?X.getWidth:function(ab,ac){return G.newColumnWidth});if(R>-1){do{switch(O[R].nodeName){case"TBODY":Z=true;W=O[R];break;case"COLGROUP":S=true;I=O[R];break}}while(R--)}else{}if(!W){W=l.createElement("tbody");if(O.length>0){do{W.appendChild(O[0])}while(O.length)}}if(!I||I.children.length<1){I=l.createElement("colgroup");aa.appendChild(I);aa.appendChild(W);if(W.children.length>0){U=W.children[0];for(R=0,Q=g.min(U.children.length,G.initCalcCols);R<Q;R++){P=l.createElement("col");P.style.width=V(C.i,R)+"px";I.appendChild(P)}for(R=0,Q=g.min(W.children.length,G.initCalcRows);R<Q;R++){W.children[R].style.height=T}}}aa.tBody=W;aa.colGroup=I;aa.removeAttribute("width");aa.style.width=""},checkMinSize:function(R){var P=C.tableSize(R),S=G.minSize.rows||0,I=G.minSize.cols||0,Q=C.obj.pane().actionUI,O=Q.frozenAt;S=g.max((O.row>S?O.row+1:S),1,G.initScrollRows);I=g.max((O.col>I?O.col+1:I),1,G.initScrollCols);if(P.cols<I){I-=P.cols;if(Q.hiddenColumns.length>0){I+=c.indexOfNearestLessThan(Q.hiddenColumns,I)+1}C.controlFactory.addColumnMulti(null,I,false,true,true)}P=C.tableSize(R);if(P.rows<S){S-=P.rows;C.controlFactory.addRowMulti(null,S,false,true,true)}},theme:null,highlighter:null,resizable:function(O,I){if(!O.data("resizable")){O.resizable(I)}},busy:[],setBusy:function(I){if(I){C.busy.push(I)}else{C.busy.pop()}},isBusy:function(){return(C.busy.length>0)},draggable:function(O,I){if(!O.data("jSdraggable")){O.data("jSdraggable",true).draggable(I)}},nearest:function(O,I){return d(O).nearest(I)},resizeBar:{top:function(S,P,U,O){C.obj.barTopControls().remove();var Q=l.createElement("div"),T=d(Q).addClass(C.cl.barController+" "+C.theme.barResizer).width(S.width()).prependTo(S),I,R;C.controls.bar.x.controls[C.i]=C.obj.barTopControls().add(T);C.resizableCells(T,{handles:"e",start:function(W,V){C.autoFillerHide();C.setBusy(true);I=C.col(O,P);if(U.freezeHandleTop){U.freezeHandleTop.remove()}I.removeAttribute("width")},resize:function(W,V){I.style.width=V.size.width+"px";if(U.inPlaceEdit){U.inPlaceEdit.goToTd()}},stop:function(W,V){C.setBusy(false);if(U.inPlaceEdit){U.inPlaceEdit.goToTd()}C.followMe();C.setDirty(true)},minWidth:32});R=Q.children[0];R.style.height=S.outerHeight()+"px";R.style.position="absolute"},left:function(Q,T,P,X){C.obj.barLeftControls().remove();var S=Q.offset(),Y=l.createElement("div"),V=d(Y).addClass(C.cl.barController+" "+C.theme.barResizer).prependTo(Q).offset({top:S.top,left:S.left}),W=Q[0],R=Q.next()[0],Z=R.parentNode,O=l.createElement("div"),I=d(O).addClass(C.cl.barControllerChild).height(Q.height()).prependTo(V),U;C.controls.bar.y.controls[C.i]=C.obj.barLeftControls().add(V);C.resizableCells(I,{handles:"s",start:function(){C.autoFillerHide();C.setBusy(true);if(P.freezeHandleLeft){P.freezeHandleLeft.remove()}Z.removeAttribute("height");W.removeAttribute("height");R.removeAttribute("height")},resize:function(ab,aa){Y.style.height=R.style.height=W.style.height=Z.style.height=aa.size.height+"px";if(P.inPlaceEdit){P.inPlaceEdit.goToTd()}},stop:function(ab,aa){C.setBusy(false);if(P.inPlaceEdit){P.inPlaceEdit.goToTd()}C.followMe();C.setDirty(true)},minHeight:15});U=O.children[0];U.style.width=Q.outerWidth()+"px";U.style.position="absolute"},corner:function(){}},sheetDecorateRemove:function(O,I){I=I||C.obj.tables();I=(O?I.clone():I);I.find("td."+C.theme.tdActive).removeClass(C.theme.tdActive);I.find("td."+C.theme.tdHighlighted).removeClass(C.theme.tdHighlighted);return I},labelUpdate:function(O,I){if(!I){O=h.parseCellName(O.col,O.row);if(O){C.obj.label().text(O)}}else{C.obj.label().text(O)}},cellEdit:function(S,Q,P){C.autoFillerNotGroup=true;C.evt.cellEditDone();if(S===null){return}var R=C.getTdLocation(S),I=S.jSCell,O;if(I===F||I===null){return}if(I.uneditable){return}C.trigger("sheetCellEdit",[I]);if(S!==C.cellLast.td){C.followMe(S)}else{C.autoFillerGoToTd(S)}C.labelUpdate(R);if(I.formula.length>0){O="="+I.formula}else{O=I.value}C.obj.formula().val(O).blur();C.cellSetActive(S,R,Q,false,null,P)},cellSetActive:function(R,T,O,V,S,P){T=T||C.getTdLocation(R);if(T.col!=F){C.cellLast.td=R;C.cellLast.row=C.rowLast=T.row;C.cellLast.col=C.colLast=T.col;if(!P){C.highlighter.set(R).setStart(T).setEnd(T)}if(R===null){return}C.highlighter.setBar("left",R.parentNode.firstChild).setBar("top",R.parentNode.parentNode.children[0].children[R.cellIndex]);var U,W;switch(G.cellSelectModel){case k.excelSelectModel:case k.googleDriveSelectModel:U=function(){};W=function(){};break;case k.openOfficeSelectModel:U=function(X){if(C.isCell(X)){C.cellEdit(X)}};W=function(){};break}if(O){var I={},Q=C.obj.pane();I.last=T;Q.onmousemove=function(af){af=af||f.event;var ag=af.target||af.srcElement;if(C.isBusy()){return false}var X=C.highlighter.end=C.getTdLocation(ag),ah=true,ai=C.highlighter;if(X.col<1||X.row<1||X.col==A||X.row==A){return false}if(V){ah=false;if(T.col==X.col||T.row==X.row){ah=true}}if((I.last.col!=X.col||I.last.row!=X.row)&&ah){U(ag);C.cycleCellArea(function(ak){ai.set(ak.td)},T,X,false,true)}C.followMe(ag);var aa=af.clientY,ab=af.clientX,ac=Q.$enclosure.offset(),aj=C.getTdLocation(ag),ad=aj.row,Z=aj.col,Y=false,ae;if(K(ad)||K(Z)){return false}if(aa>ac.top){Y=true;ad--}if(ab>ac.left){Y=true;Z--}if(Y){if(ad<1||Z<1){return false}ae=C.spreadsheets[C.i][ad][Z];C.followMe(ae.td,true)}I.last=X;return true};l.onmouseup=function(){Q.onmousemove=null;Q.onmousemove=null;Q.onmouseup=null;l.onmouseup=null;if(S){S()}}}}},colLast:0,rowLast:0,cellLast:{td:[],row:0,col:0,isEdit:false},highlightedLastOrdered:function(){var O=this.highlighter,I={start:{},end:{}};I.start.row=g.min(O.start.row,O.end.row);I.start.col=g.min(O.start.col,O.end.col);I.end.row=g.max(O.start.row,O.end.row);I.end.col=g.max(O.start.col,O.end.col);return I},cellStyleToggle:function(T,S,Q){Q=Q||C.highlighted();if(Q.length<1){return false}C.setDirty(true);var U,R,P=Q.length-1,I=C.obj.cellsEdited(),O;if(P>=0){O=Q[0].className.match(T);do{U=Q[P];R=d(U);if(S){R.removeClass(S)}if(O){R.removeClass(T)}else{R.addClass(T)}if(!U.jSCell.edited){U.jSCell.edited=true;I.push(U.jSCell)}}while(P--);return true}return false},cellTypeToggle:function(R,P){P=P||C.highlighted(true);if(P.length<1){return}var Q=P.length-1,O=P[Q].cellType==R,I;if(Q>=0){do{I=P[Q];if(O){I.cellType=null}else{I.cellType=R}I.updateValue()}while(Q--)}},fontReSize:function(S,R){R=R||C.highlighted();if(R.length<1){return false}var O=0;switch(S){case"up":O=1;break;case"down":O=-1;break}var U,T,Q=R.length-1,P,I=C.obj.cellsEdited();if(Q>=0){do{U=R[Q];T=d(U);P=(T.css("font-size")+"").replace("px","")*1;T.css("font-size",((P||10)+O)+"px");if(!U.jSCell.edited){U.jSCell.edited=true;I.push(U.jSCell)}}while(Q--);return true}return false},cellHandler:null,calc:function(P,R){P=(P===F?C.i:P);if(C.readOnly[P]||C.isChanged(P)===false&&!R){return false}var O=G.loader,I;if(O!==null){O.cycleCells(P,function(S,U,T){I=O.jitCell(S,U,T);I.updateValue()})}else{var Q=C.spreadsheetToArray(null,P);h.calc(P,Q);C.trigger("sheetCalculation",[{which:"spreadsheet",sheet:Q,index:P}])}C.setChanged(false);return true},calcAll:function(P){var O=0,I;if(G.loader!==null){I=G.loader.count;for(;O<I;O++){C.calc(O,P)}}else{I=C.spreadsheets.length;for(;O<I;O++){C.calc(O,P)}}},calcVisiblePos:{row:-1,col:-1},calcVisibleInit:function(Z){Z=Z||C.i;var O=C.spreadsheetToArray(null,Z)||[],R=g.min,S=G.initCalcRows,I=G.initCalcCols,W=1,P=R(O.length-1,S),aa,T,Y,V={row:-1,col:-1},U=[],X=function(){this.cell.rowIndex=this.rowIndex;this.cell.columnIndex=this.columnIndex;this.cell.updateValue()},Q=function(){U.length=0;C.trigger("sheetCalculation",[{which:"spreadsheet",sheet:O,index:Z}])};V.row=P;for(;W<=P;W++){if(W>0&&(aa=O[W])!==F){Y=V.col=R(aa.length-1,I);T=1;for(;T<=Y;T++){U.push({cell:aa[T],rowIndex:W,columnIndex:T})}}}y(U,{each:X,done:Q});this.calcVisiblePos=V;C.setChanged(false)},calcVisibleRow:function(I,V){V=V||C.i;var R=C.spreadsheets[V],T=G.initCalcRows,W=I.table,S=I.pane,U,Q,O=this.calcVisiblePos,P=function(){var Y=[],aa=S.size(),Z=W.size(),ac,ab,X;if(Z.rows<T&&R.length<=aa.rows&&O.row<=(aa.rows+1)){ac=O.row;O.row++;U=1;Q=O.col;for(;U<=Q;U++){ab=R[ac];X=ab!==F?ab[U]:F;Y.push({row:ab,cell:X,rowIndex:ac,columnIndex:U})}y(Y,{each:function(){if(this.row===F||(this.row=R[this.rowIndex])===F){if(R[this.rowIndex]===F){C.createSpreadsheetForArea(I.table,V,this.rowIndex,this.rowIndex,this.columnIndex,this.columnIndex);this.row=R[this.rowIndex]}}else{if((this.cell=this.row[this.columnIndex])===F){C.createCell(C.i,this.rowIndex,this.columnIndex);this.cell=this.row[this.columnIndex]}}},done:function(){P()}})}};O.row=O.row>=0?O.row:T;P();C.setChanged(false)},calcVisibleCol:function(I,ac){ac=ac||C.i;var S=C.spreadsheetToArray(null,ac)||[],P=I.scrolledArea,O=I.pane.size(),V=G.initCalcRows,Q=G.initCalcCols,R=g.max((P.row+V)-1,I.foldArea.row),U=g.max((P.col+Q)-1,I.foldArea.col),Y,ad,ab,aa,T=this.calcVisiblePos,W={row:T.row,col:T.col},X=[],Z=function(){if(this.row===F||this.cell===F){C.createSpreadsheetForArea(I.table,ac,this.rowIndex,this.rowIndex,this.colIndex,this.colIndex);this.row=S[this.rowIndex]}if(this.row===F){return}aa=this.row[this.colIndex];if(aa===F){return}aa.updateValue()};R=R<O.rows?R:O.rows;U=U<O.cols?U:O.cols;Y=R;if(Y>0&&U>0){do{ab=U;ad=S[Y];X.push({row:ad,cell:ad!==F?ad[ab]:F,rowIndex:Y,colIndex:ab})}while(Y-->1)}this.calcVisiblePos=W;y(X,{each:Z});C.trigger("sheetCalculation",[{which:"spreadsheet",sheet:S,index:ac}]);C.setChanged(false)},resolveCell:function(I,O){var P=!I.needsUpdated;if(!O){C.undo.createCells([I],function(Q){C.trigger("sheetPreCalculation",[{which:"cell",cell:I}]);C.setDirty(true);C.setChanged(true);I.updateValue(function(){C.trigger("sheetCalculation",[{which:"cell",cell:I}]);if(P){I.updateDependencies()}});return Q})}else{C.trigger("sheetPreCalculation",[{which:"cell",cell:I}]);C.setDirty(true);C.setChanged(true);I.updateValue(function(){C.trigger("sheetCalculation",[{which:"cell",cell:I}]);if(P){I.updateDependencies()}})}},addSheet:function(I){I=I||{rows:25,cols:10};C.evt.cellEditAbandon();C.setDirty(true);C.controlFactory.sheetUI(C.obj.ui,d.sheet.makeTable(I),C.sheetCount);C.setActiveSheet(C.sheetCount);C.sheetCount++;C.sheetSyncSize();var O=C.obj.pane();if(O.inPlaceEdit){O.inPlaceEdit.goToTd()}C.trigger("sheetAdd",[C.i])},insertSheet:null,deleteSheet:function(O){var R=O||C.i,Q=C.controls.enclosures.toArray(),I;Q.splice(R,1);C.obj.barHelper().remove();C.obj.enclosure().remove();C.controls.enclosures=d(Q);C.obj.menus().remove();C.obj.tabContainer().children().eq(C.i).remove();C.spreadsheets.splice(R,1);C.controls.autoFiller.splice(R,1);C.controls.bar.helper.splice(R,1);C.controls.bar.corner.splice(R,1);C.controls.bar.x.controls.splice(R,1);C.controls.bar.x.handleFreeze.splice(R,1);C.controls.bar.x.controls.splice(R,1);C.controls.bar.x.menu.splice(R,1);if(C.controls.bar.x.menuParent&&C.controls.bar.x.menuParent[R]){C.controls.bar.x.menuParent.splice(R,1)}C.controls.bar.x.parent.splice(R,1);C.controls.bar.x.th.splice(R,1);C.controls.bar.y.controls.splice(R,1);C.controls.bar.y.handleFreeze.splice(R,1);C.controls.bar.y.controls.splice(R,1);C.controls.bar.y.menu.splice(R,1);if(C.controls.bar.y.menuParent&&C.controls.bar.y.menuParent[R]){C.controls.bar.y.menuParent.splice(R,1)}C.controls.bar.y.parent.splice(R,1);C.controls.bar.y.th.splice(R,1);C.controls.barMenuLeft.splice(R,1);C.controls.barMenuTop.splice(R,1);C.controls.barLeft.splice(R,1);C.controls.barTop.splice(R,1);C.controls.barTopParent.splice(R,1);C.controls.chart.splice(R,1);C.controls.tdMenu.splice(R,1);C.controls.enclosure.splice(R,1);C.controls.fullScreen=null;C.controls.inPlaceEdit.splice(R,1);C.controls.menus.splice(R,1);C.controls.menuLeft.splice(R,1);C.controls.menuRight.splice(R,1);C.controls.pane.splice(R,1);C.controls.tables.splice(R,1);C.controls.table.splice(R,1);for(I=R+1;I<C.controls.tab.length;++I){var P=C.controls.tab[I].get(0);P.i--}C.controls.tab.splice(R,1);C.controls.toggleHide.x.splice(R,1);C.controls.toggleHide.y.splice(R,1);C.readOnly.splice(R,1);C.i=0;C.sheetCount--;C.sheetCount=w.max(C.sheetCount,0);if(C.sheetCount==0){C.addSheet()}C.setActiveSheet(C.i);C.setDirty(true);C.setChanged(true);C.trigger("sheetDelete",[R])},deleteRow:function(T,S){var R,I,Q,V,X=C.sheetSize(),W,O=C.obj.pane(),U=O.table.tBody,P;if(T){I=Q=T}else{I=w.min(C.highlighter.start.row,C.highlighter.end.row);Q=w.max(C.highlighter.start.row,C.highlighter.end.row)}V=(Q-I)+1;if(I<1||X.cols<2||V>=X.rows){return}R=Q;do{P=C.getTd(-1,R,1);if(P===null){continue}W=P.parentNode;U.removeChild(W)}while(I<R--);C.controls.bar.y.th[C.i].splice(I,V);C.spreadsheets[C.i].splice(I,V);C.refreshRowLabels(I);C.setChanged(true);C.offsetFormulas({row:I,col:0},{row:-V,col:0},false,true);C.setDirty(true);C.evt.cellEditAbandon();if(O.inPlaceEdit){O.inPlaceEdit.goToTd()}C.trigger("sheetDeleteRow",R)},deleteColumn:function(T){var S,I,R,V,X=C.sheetSize(),W,Q,P=C.obj.pane();if(T){I=R=T}else{I=w.min(C.highlighter.start.col,C.highlighter.end.col);R=w.max(C.highlighter.start.col,C.highlighter.end.col)}V=(R-I)+1;if(I<1||X.cols<2||V>=X.cols){return}S=R;C.obj.barHelper().remove();do{var U=C.obj.table(),O=C.col(U[0],S);d(C.obj.barTop(S)).remove();d(O).remove()}while(I<S--);C.controls.bar.x.th[C.i].splice(I,V);Q=C.spreadsheets[C.i].length-V;do{W=C.spreadsheets[C.i][Q].splice(I,V);while(W.length>0){d(W.pop().td).remove()}}while(Q-->1);C.refreshColumnLabels(I);C.setChanged(true);C.offsetFormulas({row:0,col:I},{row:0,col:-V},false,true);C.setDirty(true);C.evt.cellEditAbandon();if(P.inPlaceEdit){P.inPlaceEdit.goToTd()}C.trigger("sheetDeleteColumn",S)},sheetTab:function(O,Q){var I="",P;if(O){P=C.obj.table();I=P.attr("title")||C.msg.sheetTitleDefault.replace(/[{]index[}]/gi,C.i+1);if(Q){P.attr("title",I);Q(I)}return I}else{if(C.isSheetEditable()&&G.editableNames){G.prompt(C.msg.newSheetTitle,function(R){if(!R){I=C.obj.table().attr("title");R=(I?I:C.msg.sheetTitleDefault.replace(/[{]index[}]/gi,C.i+1))}else{C.setDirty(true);C.obj.table().attr("title",R);C.obj.tab().html(R);I=R}if(Q){Q(d(l.createElement("div")).text(I).html())}},C.sheetTab(true));return null}}},followMe:function(Q,I){Q=Q||C.obj.tdActive();if(Q===null){return}var P=C.obj.pane(),O=P.actionUI;C.setBusy(true);O.putTdInView(Q);C.setBusy(false);if(!I){C.autoFillerGoToTd(Q)}},autoFillerGoToTd:function(Q,O,I){if(!G.autoFiller){return}if(Q===F){Q=C.obj.tdActive()}if(Q&&Q.type=="cell"){O=O||Q.clientHeight;I=I||Q.clientWidth;if(!Q.offsetHeight||!Q.offsetWidth||!Q.clientHeight||!Q.clientWidth){C.autoFillerHide();return}var P=d(Q).position();C.obj.autoFiller().show().css("top",((P.top+(O||Q.clientHeight)-3)+"px")).css("left",((P.left+(I||Q.clientWidth)-3)+"px"))}},autoFillerHide:function(){if(!G.autoFiller){return}C.obj.autoFiller().hide()},setActiveSheet:function(Q,I){if(I!==F){Q=I.i}else{Q=Q||0}if(C.cellLast.row>0||C.cellLast.col>0){C.evt.cellEditDone();C.obj.formula().val("")}var P=C.obj.enclosures(),O=P.length-1,R,S;C.autoFillerHide();if(O>0){do{if(Q!=O){R=P[O];R._scrollLeft=R._scrollLeft||R.scrollUI.scrollLeft;R._scrollTop=R._scrollTop||R.scrollUI.scrollTop;R.style.display="none"}}while(O-->0)}C.i=Q;if(I!==F){R=I.enclosure}else{R=C.controls.enclosure[Q][0]}R.style.display="";C.highlighter.setTab(C.obj.tab());C.readOnly[Q]=(R.table.className||"").match(/\breadonly\b/i)!=null;S=R.pane;if(S.inPlaceEdit){S.inPlaceEdit.goToTd()}R.scrollUI.scrollLeft=R._scrollLeft||R.scrollUI.scrollLeft;R.scrollUI.scrollTop=R._scrollTop||R.scrollUI.scrollTop;R._scrollLeft=R._scrollTop=null;R.scrollUI.onscroll()},getSpreadsheetIndexByTitle:function(S){if(G.loader!==null){var R=G.loader.getSpreadsheetIndexByTitle(S);return R}var P=C.obj.tables(),I=P.length,Q,O=0;for(;O<I;O++){Q=P[O];if(Q.getAttribute("title")==S){return Q.spreadsheetIndex}}return null},openSheet:function(O){var P=O.length-1,I=function(){C.setBusy(true);var W=C.controlFactory.header(),V=C.controlFactory.ui(),Q=C.controlFactory.sheetAdder(),S=C.controlFactory.tabContainer(),U,T={sizeCheck:function(X){if(d.sheet.max){var Y=C.tableSize(X.table);if(Y.rows>d.sheet.max||Y.cols>d.sheet.max){C.trigger("sheetMaxSize",[X.table,X.i]);G.confirm(C.msg.maxSizeBrowserLimitationOnOpen,function(){X.load()})}else{X.load()}}else{X.load()}},initChildren:function(Z,Y,X){C.controlFactory.sheetUI(Z,Y,X);C.trigger("sheetOpened",[X])},done:function(X){C.sheetSyncSize();C.setActiveSheet(0);C.setDirty(false);C.setBusy(false);while(X.length>0){C.calcVisibleInit(C.i=X.pop())}C.trigger("sheetAllOpened")},lastIndex:P},R;W.ui=V;W.tabContainer=S;V.header=W;V.sheetAdder=Q;V.tabContainer=S;S.header=W;S.ui=V;G.parent.append(W).append(V).append(Q).append(S);C.resizableSheet(G.parent,{minWidth:G.parent.width()*0.1,minHeight:G.parent.height()*0.1,start:function(){C.setBusy(true);C.obj.enclosure().hide();V.sheetAdder.hide();V.tabContainer.hide()},stop:function(){C.obj.enclosure().show();V.sheetAdder.show();V.tabContainer.show();C.setBusy(false);C.sheetSyncSize();var X=C.obj.pane();if(X.inPlaceEdit){X.inPlaceEdit.goToTd()}}});if(G.loader===null){for(U=0;U<O.length;U++){new k.SpreadsheetUI(U,V,O[U],T);C.sheetCount++}}else{C.insertSheet=function(ab,X,aa,Z){C.sheetCount++;ab=ab||null;Z=Z||l.createElement("table");aa=aa!==F?aa:true;X=X||C.sheetCount-1;if(ab!==null){loader.addSpreadsheet(ab)}if(!Z.hasAttribute("title")){Z.setAttribute("title",loader.title(X))}var ac=function(){C.obj.enclosure().hide();C.setBusy(true);var ad=new k.SpreadsheetUI(X,V,Z,T);C.setActiveSheet(-1,ad);C.calcVisibleInit(X);C.setBusy(false);C.sheetSyncSize()},Y;if(aa){ac();return}Y=C.controlFactory.customTab(Z.getAttribute("title")).mousedown(function(){ac();C.obj.tab().insertBefore(this);d(this).remove();return false});if(G.loader.isHidden(X)){Y.hide()}};R=new k.SpreadsheetUI(0,V,O[0],T);C.sheetCount++;if(O.length>1){for(U=1;U<O.length;U++){C.insertSheet(null,U,false,O[U])}C.i=0;R.loaded()}}};if(C.isDirty){G.confirm(C.msg.openSheet,I)}else{I()}},newSheet:function(){G.parent.html(d.sheet.makeTable()).sheet(G)},sheetSyncSize:function(){var X=G.parent,T=X[0],Z=T.clientHeight,U=T.clientWidth,Y=C.obj.tabContainer(),aa=Y[0],I=aa.style,ad=f.scrollBarSize.width,O,ac,W,V,R=C.obj.ui.style,S,ae,Q,ab,P;if(!Z){Z=400;X.height(Z)}else{if(Z<200){Z=200;X.height(Z)}}P=aa.scrollLeft;I.width="";O=aa.clientWidth;ac=(U-(G.colMargin+ad));W=(U-G.colMargin*2)+"px";V=((G.colMargin+ad)+"px");if(O>ac){I.height=V;Y.addClass(C.cl.tabContainerScrollable);Z-=ad}else{I.height=null;Y.removeClass(C.cl.tabContainerScrollable)}I.width=W;aa.scrollLeft=P;Z-=C.obj.header().outerHeight()+G.boxModelCorrection;Z-=aa.clientHeight+G.boxModelCorrection;S=(Z-f.scrollBarSize.height-G.boxModelCorrection)+"px";ae=(U-f.scrollBarSize.width)+"px";Q=(Z+"px");ab=(U+"px");C.obj.panes().each(function(){var ah=this.style,ag=this.actionUI.scrollUI.style,af=this.enclosure.style;ah.height=S;ah.width=ae;af.height=ag.height=Q;af.width=ag.width=ab});R.height=Q;R.width=ab},showSheets:function(){C.obj.tabContainer().children().each(function(I){d(this).show();if(G.loader!==null){G.loader.setMetadata(I,{hidden:false})}})},showSheet:function(I){C.obj.tabContainer().children().eq(I).show();if(G.loader!==null){G.loader.setMetadata(I,{hidden:false})}},hideSheet:function(I){C.obj.tabContainer().children().eq(I).hide();if(G.loader!==null){G.loader.setMetadata(I,{hidden:true})}},cellChangeStyle:function(P,Q,I){I=I||C.highlighted(true);if(I.length<1){return false}C.setDirty(this);var O=I.length-1;if(O>=0){C.undo.createCells(I,function(R){do{R[O].td.css(P,Q)}while(O--);return R});return true}return false},cellFind:function(I){function O(Q){var P=C.obj.table().children("tbody").children("tr");if(Q){var R=P.children('td:contains("'+Q+'")');if(R.length<1){R=P.children('td:contains("'+Q.toLowerCase()+'")')}if(R.length<1){R=P.children('td:contains("'+Q.toUpperCase()+'")')}R=R.eq(0);if(R.length>0){C.cellEdit(R)}else{G.alert(C.msg.cellNoFind)}}}if(!I){G.prompt(C.msg.cellFind,O)}else{O(I)}},cellSetActiveBar:function(W,P,R){var ab=C.sheetSize(),T=w.min(P,R),Y=w.max(P,R),I={},X={},aa=function(ac){switch(G.cellSelectModel){case k.openOfficeSelectModel:this.row=(ac?I.row:X.row);this.col=(ac?I.col:X.col);this.td=C.getTd(-1,this.row,this.col);if(this.td!==null&&this.td!==C.cellLast.td){C.cellEdit(this.td,false,true)}break;default:this.row=(ac?X.row:I.row);this.col=(ac?X.col:I.col);this.td=C.getTd(-1,this.row,this.col);if(this.td!==null&&this.td!==C.cellLast.td){C.cellEdit(this.td,false,true)}break}},S=[],U=C.obj.pane().actionUI.scrolledArea,V=C.obj.table(),O,Z,Q;switch(W){case"top":I.row=U.row;I.col=T;X.row=U.row;X.col=Y;C.highlighter.start.row=1;C.highlighter.start.col=T;C.highlighter.end.row=ab.rows;C.highlighter.end.col=Y;O=Y;do{S.push(C.col(V[0],O))}while(O-->T);break;case"left":I.row=T;I.col=U.col;X.row=Y;X.col=U.col;C.highlighter.start.row=T;C.highlighter.start.col=1;C.highlighter.end.row=Y;C.highlighter.end.col=ab.cols;Z=Y;do{Q=C.getTd(-1,Z,1);if(Q===null){continue}S.push(Q.parentNode)}while(Z-->T);break;case"corner":I.row=1;I.col=1;X.col=ab.cols;X.row=ab.rows;S.push(V[0]);break}new aa(P>R);C.highlighter.set(S)},getTdRange:function(Q,V,T,U){C.cellLast.isEdit=true;var O=function(X){if(X.first.col>X.last.col||X.first.row>X.last.row){return{first:h.parseCellName(X.last.col,X.last.row),last:h.parseCellName(X.first.col,X.first.row)}}else{return{first:h.parseCellName(X.first.col,X.first.row),last:h.parseCellName(X.last.col,X.last.row)}}},S=function(aa){var X=O(aa),Z=V+"";Z=(Z.match(/=/)?Z:"="+Z);if(T||Z.charAt(Z.length-1)!="("){Z=Z+(T?T:"")+"("}var ab,Y="";if(X.first!=X.last){ab=X.first+":"+X.last}else{ab=X.first}if(Z.charAt(Z.length-1)=="("){Y=")"}return Z+ab+Y},I="",P,R,W;if(Q){P={first:C.getTdLocation([Q.target])};R=C.obj.table().mousemove(function(X){P.last=C.getTdLocation([X.target]);I=S(P);if(!U){C.obj.formula().val(I);C.obj.inPlaceEdit().val(I)}});N.one("mouseup",function(){R.unbind("mousemove");return I})}else{W=C.highlighted().not(C.obj.tdActive());if(W.length){P={first:C.getTdLocation(W.first()),last:C.getTdLocation(W.last())};I=S(P);if(!U){C.obj.formula().val(I);C.obj.inPlaceEdit().val(I)}return I}else{return""}}return""},getTd:function(R,T,O){var P=(R>-1?C.obj.tables()[R]:C.obj.table()[0]),I,Q,S;if(!P||!(I=P.tBody)||!(Q=I.children[T])||!(S=Q.children[O])){return null}return S},getTdLocation:function(Q){var I={col:0,row:0},O=0,P=C.obj.pane();if(Q===F||Q===null){return I}if(Q.parentNode===F||(Q.parentNode.rowIndex+O)<0){return I}return{col:Q.cellIndex,row:Q.parentNode.rowIndex+O}},getBarIndex:{left:function(I){I=I||{};if(!I.parentNode||K(I.parentNode.rowIndex)){return -1}else{return I.parentNode.rowIndex}},top:function(I){I=I||{};if(K(I.cellIndex)){return -1}else{return I.cellIndex}},corner:function(){return 0}},time:{now:new a(),last:new a(),diff:function(){return w.abs(w.ceil(this.last.getTime()-this.now.getTime())/1000).toFixed(5)},set:function(){this.last=this.now;this.now=new a()},get:function(){return this.now.getHours()+":"+this.now.getMinutes()+":"+this.now.getSeconds()}},changed:[],isChanged:function(I){return C.changed[I||C.i]},setChanged:function(I){C.changed[C.i]=I},isDirty:false,setDirty:function(I){C.dirty=I},appendToFormula:function(I){var P=C.obj.formula(),O=P.val();if(O.charAt(0)!="="){O="="+O}P.val(O+I)},undo:{manager:(f.UndoManager?new UndoManager():{undo:B,redo:B,register:B}),cells:[],id:-1,createCells:function(I,O,R){if(R===F){C.undo.id++;R=C.undo.id}var P=(new k.CellRange(I)).clone().cells,Q=(O!==F?(new k.CellRange(O(I)).clone()).cells:P);P.id=R;Q.id=R;C.undo.manager.add({undo:function(){C.undo.removeCells(P,R)},redo:function(){C.undo.createCells(Q,null,R)}});if(R!==C.undo.id){C.undo.draw(Q)}return true},removeCells:function(O,Q){var P=0,I=-1;if(O.id===Q){I=P}if(I!==-1){C.undo.cells.splice(I,1)}C.undo.draw(O)},draw:function(P){var O,S,R,I,Q;for(O=0;O<P.length;O++){R=P[O];Q=C.getTdLocation(R.td);I=C.spreadsheets[R.sheetIndex][Q.row][Q.col];I.value=R.value;I.formula=R.formula;S=I.td=R.td;I.dependencies=R.dependencies;I.needsUpdated=R.needsUpdated;I.calcCount=R.calcCount;I.sheetIndex=R.sheetIndex;I.rowIndex=Q.row;I.columnIndex=Q.col;I.state=R.state;I.jS=R.jS;S.setAttribute("style",R.style);S.setAttribute("class",R.cl);I.setNeedsUpdated();I.updateValue()}}},cols:function(I){I=I||C.obj.table()[0];if(!I){return[]}if(!I.colGroup){return[]}if(!I.colGroup.children){return[]}return I.colGroup.children},tables:function(W,R){W=W||C.obj.tables();var V=[],P=W.length-1,O,Y,U,I,Z,Q,X,S,T;do{Y=(R?l.body.removeChild(W[P]):W[P].cloneNode(true));if((I=Y.children[0])&&(Z=I.children[0])){I.removeChild(Z)}if(U=Y.children[1]){S=U.children;X=S[0];U.removeChild(X);O=S.length-1;do{T=S[O];Q=T.children[0];T.removeChild(Q)}while(O-->0)}V[P]=Y}while(P-->0);return C.sheetDecorateRemove(false,d(V))},col:function(O,I){O=O||C.obj.table()[0];var P=C.cols(O);if(I===F){I=P.length-1}return P[I]},rowTds:function(O,I){O=O||C.obj.table();var P=C.rows(O);if(!P.length){return[]}if(I==F){I=P.length-1}if(!P[I]){return[]}if(!P[I].children){return[]}return P[I].children},rows:function(I){I=I||C.obj.table()[0];if(I===F){return[]}if(I.tBody===F){return[]}if(I.tBody.children===F){return[]}return I.tBody.children},highlighted:function(O){var Q=C.highlighter.last||d([]),R=[],I,P;if(!(I=Q)||!Q.length||!(I=I[0])||!I.tagName){return O?R:d(R)}switch(I.tagName){case"TD":P=Q.length-1;do{R.unshift(O?Q[P].jSCell:Q[P])}while(P-->0);break;case"TR":P=Q.length-1;do{if(Q[P].tds){R=R.concat(O?Q[P].jSCells:Q[P].tds)}}while(P-->0);break;case"COL":Q=Q.filter("col");P=Q.length-1;do{if(Q[P].tds){R=R.concat(O?Q[P].jSCells:Q[P].tds)}}while(P-->0);break;case"TABLE":R=(O?I.jSCells:I.tds);break}return O?R:d(R)},sheetSize:function(P){var O,S,I={},Q=G.minSize||{rows:1,cols:1},R;if(G.loader!==null){R=G.loader.size(P.spreadsheetIndex);I.rows=g.max(R.rows,Q.rows);I.cols=g.max(R.cols,Q.cols)}else{P=P||C.obj.table()[0];if((I.cols=G.initScrollCols)>0&&(I.rows=G.initScrollRows)>0){}else{O=C.rowTds(P);S=C.getTdLocation(O[O.length-1]);I.cols=S.col;I.rows=S.row}}return I},sortVerticalSelectAscending:function(){if(confirm("Do you want to extend your selection?")){C.sortVertical();return true}else{C.sortVerticalSingle(false);return true}},sortVerticalSelectDescending:function(){if(confirm("Do you want to extend your selection?")){C.sortVertical();return false}else{C.sortVerticalSingle(true);return false}},sortVertical:function(W){var U=C.highlighted(true),R=U[0].td.parent().prev(),I=U.length,P=new a(),T=true,X=[],Z=[],S,V=0,Y,O,Q;while(V<I){Y=U[V];Q=Y.td;if(!isNaN(Y.value)){O=(new s(Y.value.valueOf()))}else{T=false;O=(new p(Y.value.valueOf()))}O.loc=C.getTdLocation(Q);O.row=Q.parentNode;O.col=Q;O.cell=Y;X.push(O);V++}if(W){if(T==false){X.sort(function(ab,aa){return aa-ab})}else{X.sort();X.reverse()}}else{if(T==true){X.sort(function(ab,aa){return ab-aa})}else{X.sort()}}C.undo.createCells(U);while(S=X.length){O=X.pop();Z=C.spreadsheets[C.i].splice(O.row.rowIndex,1);Y=O.cell;Y.value=O.valueOf();O.row.parentNode.removeChild(O.row);R.after(O.row);O.row.children[0].innerHTML=R[0].rowIndex+S;C.spreadsheets[C.i].splice(R[0].rowIndex+1,0,Z[0]);C.track.call(Y,true)}C.undo.createCells(U)},sortVerticalSingle:function(S){var Q=C.highlighted(true),R=Q.length,P=0,O=[],I;while(P<R){O.push(Q[P].value);P++}if(S){O.sort(function(U,T){return T-U})}else{O.sort(function(U,T){return U-T})}while(Q.length){I=Q.pop();I.value=O[Q.length];I.updateValue()}},sortHorizontalSelectAscending:function(){if(confirm("Do you want to extend your selection?")){C.sortHorizontal();return true}else{C.sortHorizontalSingle(false);return true}},sortHorizontalSelectDescending:function(){if(confirm("Do you want to extend your selection?")){C.sortHorizontal();return false}else{C.sortHorizontalSingle(true);return false}},sortHorizontal:function(W){var U=C.highlighted(true),ac=U[0].td[0],Y=ac.cellIndex,I=ac.table.colGroup,ad=C.sheetSize().rows,O=U.length,Q=new a(),T=true,Z=[],S,V=0,aa,ab,P,X,R;while(V<O){aa=0;ab=U[V];R=ab.td;if(!isNaN(ab.value)){P=new s(ab.value.valueOf())}else{T=false;P=new p(ab.value.valueOf())}P.tds=[];P.loc=C.getTdLocation(R);P.tr=R.parentNode;P.td=R;P.cell=ab;while(aa<=ad){P.tds.push(C.obj.pane().table.children[1].children[aa].children[R.cellIndex]);aa++}Z.push(P);V++}if(W){if(T==false){Z.sort(function(af,ae){return ae-af})}else{Z.sort();Z.reverse()}}else{if(T==true){Z.sort(function(af,ae){return af-ae})}else{Z.sort()}}C.undo.createCells(U);while(Z.length){P=Z.pop();while(P.tds.length>1){R=P.tds.pop();X=R.parentNode;ab=C.spreadsheets[C.i][X.rowIndex].splice(R.cellIndex,1);X.insertBefore(R,X.children[Y]);R.col=I.children[Z.length+R.cellIndex-1];R.barTop=R.col.bar;ab.value=R.jSCell.value;C.spreadsheets[C.i][X.rowIndex].splice(R.cellIndex,0,ab[0]);C.resolveCell(ab,true)}}C.undo.createCells(U)},sortHorizontalSingle:function(S){var Q=C.highlighted(true),R=Q.length,P=0,O=[],I;while(P<R){O.push(Q[P].value);P++}if(S){O.sort(function(U,T){return T-U})}else{O.sort(function(U,T){return U-T})}while(Q.length){I=Q.pop();I.value=O[Q.length];I.updateValue()}},tableSize:function(W,T){var V,P,U,I,R,O=W.pane,X=0,Q=0,S=0;W=W||C.obj.table()[0];if((V=W.tBody)!==F&&(P=V.children)!==F&&(U=P[P.length-1])!==F&&(I=U.children)!==F&&(R=I[I.length-1])!==F){if(T===true){X=U.rowIndex}else{X=U.rowIndex+S}Q=R.cellIndex}else{return{}}return{cols:Q,rows:X}},toggleState:function(I){if(G.allowToggleState){var O=I||C.tables();if(G.editable){C.evt.cellEditAbandon();C.trigger("sheetSave",[O])}C.setDirty(false);C.setChanged(true);G.editable=!G.editable;C.kill();G.parent.html(O).sheet(G);G=null}},setCellRef:function(P){function O(R){if(R){C.s.formulaVariables[R]=I.updateValue()}}var Q=C.obj.tdActive(),I=Q.jSCell;if(P){O(P)}else{G.prompt(C.msg.setCellRef,O)}},formulaParser:null,print:function(I,O){I=I||C.i;var Q=f.open(),P;if(Q!==F){P=Q.document;P.write('<html>	<head id="head"></head>	<body>		<div id="entry" class="'+C.cl.parent+'" style="overflow: show;">		</div>	</body></html>');if(O!==true){d(P.getElementById("head")).append(d("style,link").clone())}d(P.getElementById("entry")).append(C.obj.pane().cloneNode(true));P.close();Q.focus();Q.print()}}},v=[],z;C.setBusy(true);G.parent[0].jS=C;if(!f.console){f.console={log:function(){}}}if(f.scrollBarSize===F){f.scrollBarSize=m()}if(f.defaultCharSize===F){f.defaultCharSize=j()}C.cellHandler=new k.CellHandler(C,h,d.sheet.fn);C.theme=new k.Theme(G.theme);C.highlighter=new k.Highlighter(C.theme.tdHighlighted,C.theme.barHighlight,C.theme.tabActive,function(){C.obj.pane().actionUI.redraw()});G.origHtml=G.parent.children().detach();G.parent.addClass(C.cl.parent);G.parent.bind("sheetSwitch",function(P,O,I){C.switchSheet(I)}).bind("sheetRename",function(P,O,I){C.renameSheet(I)});G.width=(G.width?G.width:G.parent.width());G.height=(G.height?G.height:G.parent.height());if(!d.nearest){C.nearest=B}C.resizableCells=C.resizableSheet=C.resizable;if(!d.ui){C.resizable=C.resizableCells=C.resizableSheet=C.draggable=B}else{if(!G.resizableCells){C.resizableCells=B}if(!G.resizableSheet){C.resizableSheet=B}}if(!d.support.boxModel){G.boxModelCorrection=0}if(!G.barMenus){C.controlFactory.barMenuTop=C.controlFactory.barMenuLeft=B}if(!G.freezableCells){C.controlFactory.barHandleFreeze.top=C.controlFactory.barHandleFreeze.left=B}if(G.calcOff){C.calc=B}if(!f.Raphael){h.chart=B}H.resize(function(){if(C&&!C.isBusy()){G.width=G.parent.width();G.height=G.parent.height();C.sheetSyncSize()}}).unload(function(){var P=k.Cell.threads,O=0,I=P.length;for(;O<I;O++){P[O].terminate()}});if(d.sheet.fn){d.sheet.fn=d.extend(d.sheet.fn,G.formulaFunctions);if(d.sheet.advancedfn){d.sheet.fn=d.extend(d.sheet.fn,d.sheet.advancedfn)}if(d.sheet.financefn){d.sheet.fn=d.extend(d.sheet.fn,d.sheet.financefn)}}G.title=G.title||G.parent.attr("title")||"";C.s=G;G.parent.addClass(C.theme.parent);if(G.origHtml.length){C.openSheet(G.origHtml)}else{if(G.loader!==null){G.loader.bindJS(C).bindHandler(C.cellHandler);while(v.length<G.loader.count){z=l.createElement("table");z.setAttribute("title",G.loader.title(v.length)||C.msg.sheetTitleDefault.replace(/[{]index[}]/gi,v.length+1));v.push(z)}C.openSheet(v)}else{C.openSheet([l.createElement("table")])}}C.setBusy(false);return C},makeTable:function(H,x,v){var F=l;H=H||{rows:25,cols:10};x=x||120;v=v||15;var G=l.createElement("table"),w=l.createElement("colgroup"),E=l.createElement("tbody"),B="width:"+x+"px;",z="height:"+v+"px;",D,y,C,A;C=H.cols;do{y=l.createElement("col");y.setAttribute("style",B);w.appendChild(y)}while(C-->1);C=H.rows;do{D=l.createElement("tr");D.setAttribute("style",z);A=H.cols;do{D.appendChild(l.createElement("td"))}while(A-->1);E.appendChild(D)}while(C-->1);G.appendChild(w);G.appendChild(E);return G},killAll:function(){if(d.sheet){var v=d.sheet.instance;if(v){for(var w=0;w<v.length;w++){if(v[w]&&v[w].kill){v[w].kill()}}d.sheet.instance=[]}}},scrollLocker:function(w){var v=d.sheet.instance;v[w].obj.panes().each(function(x){var y;d(y=this.scrollUI).scroll(function(A){var z=v.length-1,B;if(z>-1){do{B=v[z].controls.enclosure[x][0].scrollUI;if(this!==B){B.scrollLeft=y.scrollLeft;B.scrollTop=y.scrollTop}}while(z--)}})})},switchSheetLocker:function(v){d.each(d.sheet.instance,function(){this.s.parent.bind("sheetSwitch",function(y,x,w){d.each(d.sheet.instance,function(){this.setActiveSheet(w)})})})},I:function(){var v=0;if(this.instance){v=(this.instance.length===0?0:this.instance.length-1)}else{this.instance=[]}return v}};var h=d.sheet.engine={calc:function(y,w,z){w=w||[];var B=w.length-1,A,x,v;if(B>0){do{if(B>0&&w[B]){A=w[B];x=A.length-1;if(x>0){do{v=A[x];v.updateValue()}while(x-->1)}}}while(B-->1)}},parseLocation:function(v,w){return{row:parseInt(w),col:h.columnLabelIndex(v)}},parseSheetLocation:function(w){var v=((w+"").replace(/SHEET/i,"")*1)-1;return isNaN(v)?-1:v},parseCellName:function(v,w){return h.columnLabelString(v)+(w||"")},alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),columnLabels:{},columnLabelIndex:function(v){return this.columnLabels[v.toUpperCase()]},columnIndexes:[],columnLabelString:function(y){if(!this.columnIndexes.length){var A="",z,x,w,v;z=x=w=-1;for(v=1;v<16385;++v){A="";++w;if(w==26){w=0;++x;if(x==26){x=0;++z}}if(z>=0){A+=this.alphabet[z]}if(x>=0){A+=this.alphabet[x]}if(w>=0){A+=this.alphabet[w]}this.columnIndexes[v]=A;this.columnLabels[A]=v}}return this.columnIndexes[y]||""},regEx:{n:/[\$,\s]/g,cell:/(\$?[a-zA-Z]+|[#]REF[!])(\$?[0-9]+|[#]REF[!])/gi,range:/(\$?[a-zA-Z]+)\$?([0-9]+):(\$?[a-zA-Z]+)(\$?[0-9]+)/gi,remoteCell:/\$?(SHEET+)(\$?[0-9]+)[:!](\$?[a-zA-Z]+)(\$?[0-9]+)/gi,remoteCellRange:/\$?(SHEET+)(\$?[0-9]+)[:!](\$?[a-zA-Z]+)(\$?[0-9]+):(\$?[a-zA-Z]+)(\$?[0-9]+)/gi,sheet:/SHEET/i,amp:/&/g,gt:/</g,lt:/>/g,nbsp:/&nbsp;/g},chart:function(x){var A=this.jS,D=l.createElement("div"),z=this.td,C,B=l.body;B.appendChild(D);function y(F,G){if(!F){if(G){F=0}else{F=""}}else{if(G){F=c.toNumbers(F)}else{F=c.flatten(F)}}return F}x=d.extend({x:{legend:"",data:[0]},y:{legend:"",data:[0]},title:"",data:[0],legend:""},x);D.className=A.cl.chart;D.onmousedown=function(){d(z).mousedown()};D.onmousemove=function(){d(z).mousemove();return false};A.controls.chart[A.i]=A.obj.chart().add(D);x.data=y(x.data,true);x.x.data=y(x.x.data,true);x.y.data=y(x.y.data,true);x.legend=y(x.legend);x.x.legend=y(x.x.legend);x.y.legend=y(x.y.legend);x.legend=(x.legend?x.legend:x.data);var w,E,v=Raphael(D);if(z.clientHeight>0){w=g.max(z.clientWidth,100);E=g.max(z.clientHeight,50)}if(x.title){v.text(w/2,10,x.title).attr({"font-size":20})}switch(x.type){case"bar":C=v.barchart(w/8,E/8,w*0.8,E*0.8,x.data,x.legend).hover(function(){this.flag=v.popup(this.bar.x,this.bar.y,this.bar.value||"0").insertBefore(this)},function(){this.flag.animate({opacity:0},300,function(){this.remove()})});break;case"hbar":C=v.hbarchart(w/8,E/8,w*0.8,E*0.8,x.data,x.legend).hover(function(){this.flag=v.popup(this.bar.x,this.bar.y,this.bar.value||"0").insertBefore(this)},function(){this.flag.animate({opacity:0},300,function(){this.remove()})});break;case"line":C=v.linechart(w/8,E/8,w*0.8,E*0.8,x.x.data,x.y.data,{nostroke:false,axis:"0 0 1 1",symbol:"circle",smooth:true}).hoverColumn(function(){this.tags=v.set();if(this.symbols.length){for(var F=0,G=this.y.length;F<G;F++){this.tags.push(v.tag(this.x,this.y[F],this.values[F],160,10).insertBefore(this).attr([{fill:"#fff"},{fill:this.symbols[F].attr("fill")}]))}}},function(){this.tags&&this.tags.remove()});break;case"pie":C=v.piechart(w/2,E/2,(w<E?w:E)/2,x.data,{legend:x.legend}).hover(function(){this.sector.stop();this.sector.scale(1.1,1.1,this.cx,this.cy);if(this.label){this.label[0].stop();this.label[0].attr({r:7.5});this.label[1].attr({"font-weight":800})}},function(){this.sector.animate({transform:"s1 1 "+this.cx+" "+this.cy},500,"bounce");if(this.label){this.label[0].animate({r:5},500,"bounce");this.label[1].attr({"font-weight":400})}});break;case"dot":C=v.dotchart(w/8,E/8,w*0.8,E*0.8,x.x.data,x.y.data,x.data,{symbol:"o",max:10,heat:true,axis:"0 0 1 1",axisxstep:x.x.data.length-1,axisystep:x.y.data.length-1,axisxlabels:(x.x.legend?x.x.legend:x.x.data),axisylabels:(x.y.legend?x.y.legend:x.y.data),axisxtype:" ",axisytype:" "}).hover(function(){this.marker=this.marker||v.tag(this.x,this.y,this.value,0,this.r+2).insertBefore(this);this.marker.show()},function(){this.marker&&this.marker.hide()});break}C.mousedown(function(){d(z).mousedown().mouseup()});B.removeChild(D);return D}};var n=d.sheet.fn={ISNUMBER:function(x){var w;if(!isNaN(x.valueOf())){w=new t(true);w.html="TRUE";return w}w=new t(false);w.html="FALSE";return w},N:function(w){if(w==null){return 0}if(w instanceof a){return w.getTime()}if(typeof(w)=="object"){w=w.toString()}if(typeof(w)=="string"){w=parseFloat(w.replace(h.regEx.n,""))}if(isNaN(w)){return 0}if(typeof(w)=="number"){return w}if(w==true){return 1}return 0},VERSION:function(){return this.jS.version},ABS:function(w){return g.abs(n.N(w))},CEILING:function(w,v){v=v||1;return(parseInt(w/v)*v)+v},EVEN:function(w){w=g.round(w);var x=(w%2==0);if(!x){if(w>0){w++}else{w--}}return w},EXP:function(w){return g.exp(w)},FLOOR:function(x,w){w=w||1;if((x<0&&w>0)||(x>0&&w<0)){var v=new s(0);v.html="#NUM";return v}if(x>=0){return g.floor(x/w)*w}else{return g.ceil(x/w)*w}},INT:function(w){return g.floor(n.N(w))},LN:function(w){return g.log(w)},LOG:function(w,x){x=x||10;return g.log(w)/g.log(x)},LOG10:function(w){return n.LOG(w)},MOD:function(v,z){var w=v%z;if(z<0){w*=-1}return w},ODD:function(w){var y=false;if(w>0){w=g.floor(g.round(w));y=true}else{w=g.ceil(w)}var x=g.abs(w);if((x%2)==0){x++}if(y){return x}else{return -x}},PI:function(){return g.PI},POWER:function(v,w){return g.pow(v,w)},SQRT:function(w){return g.sqrt(w)},RAND:function(){return g.random()},RND:function(){return g.random()},ROUND:function(y,x){var w=g.pow(10,x||0);return g.round(y*w)/w},ROUNDDOWN:function(x,w){var y=(x<0);x=g.abs(x);w=w||0;x=g.floor(x*g.pow(10,w))/g.pow(10,w);return(y?-x:x)},ROUNDUP:function(x,w){var y=(x<0);x=g.abs(x);w=w||0;x=g.ceil(x*g.pow(10,w))/g.pow(10,w);return(y?-x:x)},SUM:function(){var C=0,A=arguments,w,y,B=A.length-1,z,x,D=isNaN;if(B<0){return 0}do{w=A[B];z=w.length-1;do{y=w[z];if(y===null||y===undefined){continue}y=y.valueOf();if(!D(y)){switch(typeof y){case"string":C+=(y*1);break;default:C+=y}}}while(z-->0)}while(B-->0);return C},TRUNC:function(v,w){w=w||0;v=v+"";if(w==0){return v.split(".").shift()}if(v.match(".")){if(w==1){v=v.substr(0,v.length-1)}else{if(w==-1){v=v.split(".").shift();v=v.substr(0,v.length-1)+"0"}}}return v},AVERAGE:function(){return n.SUM.apply(this,arguments)/n.COUNT.apply(this,arguments)},AVG:function(){return n.AVERAGE.apply(this,arguments)},COUNT:function(){var y=0,w=c.toNumbers(arguments),x=w.length-1;if(x<0){return y}do{if(w[x]!==null){y++}}while(x--);return y},COUNTA:function(){var y=0,w=c.flatten(arguments),x=w.length-1;if(x<0){return y}do{if(w[x]){y++}}while(x--);return y},MAX:function(){var x=c.toNumbers(arguments),w=x[0],y=x.length-1;if(y<0){return 0}do{w=(x[y]>w?x[y]:w)}while(y--);return w},MIN:function(){var w=c.toNumbers(arguments),y=w[0],x=w.length-1;if(x<0){return 0}do{y=(w[x]<y?w[x]:y)}while(x--);return y},ASC:function(w){return w.charCodeAt(0)},CHAR:function(w){return p.fromCharCode(w)},CLEAN:function(w){var x=new b("[cG\x1BcLcJcMcIcK\x07\x1B\f\n\r\t\v]","g");return w.replace(x,"")},CODE:function(w){return n.ASC(w)},CONCATENATE:function(){var x=c.flatten(arguments),w="",v=this;jQuery.each(x,function(y){w+=x[y]});return w},DOLLAR:function(y,x,A){x=x||2;A=A||"$";var w=new s(y),z=n.FIXED(y,x,false);if(y>=0){w.html=A+z}else{w.html="("+A+z.slice(1)+")"}return w},FIXED:function(z,y,x){y=(y===undefined?2:y);var A=g.pow(10,y),w,z=g.round(z*A)/A;w=new p(z.toFixed(y));w.html=Globalize.format(z,"n"+y);if(x){w.html=w.html.replace(Globalize.culture().numberFormat[","],"")}return w},LEFT:function(w,x){w=w.valueOf().toString();x=x||1;return w.substring(0,x)},LEN:function(w){if(!w){return 0}return w.length},LOWER:function(w){return w.toLowerCase()},MID:function(y,z,x){if(!y||!z||!x){var w=new s(0);w.html="ERROR";return w}return y.substring(z-1,x+z-1)},REPLACE:function(w,z,x,y){if(!w||!z||!x||!y){var v=new p("");v.html="ERROR";return v}var v=w.split("");v.splice(z-1,x);v.splice(z-1,0,y);return v.join("")},REPT:function(x,z){var w="";for(var y=0;y<z;y++){w+=x}return w},RIGHT:function(w,x){x=x||1;return w.substring(w.length-x,w.length)},SEARCH:function(y,w,z){z=z||0;if(z){w=w.split("");w.splice(0,z-1);w=w.join("")}var x=w.search(y);if(x<0){var v=new p("");v.html="#VALUE!";return v}return z+(z?0:1)+x},SUBSTITUTE:function(y,v,x,z){z=z||0;v=new b(v,"g");var w=1;y=y.replace(v,function(B,D,E,C){var A=B;if(z){if(w>=z){A=x}}else{A=x}w++;return A});return y},TEXT:function(w,v){return w},UPPER:function(w){return w.toUpperCase()},VALUE:function(x){if(jQuery.isNumeric(x)){return x*=1}else{var w=new p("");w.html="#VALUE!";return w}},NOW:function(){var v=new a();v.html=e.toString(v);return v},TODAY:function(){var w=new a(),v=new s(e.toCentury(w)-1);v.html=e.toString(w,"d");return v},WEEKENDING:function(w){var v=new a();v=new a(v.getFullYear(),v.getMonth(),v.getDate()+5-v.getDay()-((w||0)*7));v.html=e.toString(v,"d");return v},WEEKDAY:function(w,x){w=e.get(w);var v=w.getDay();x=(x?x:1);switch(x){case 3:switch(v){case 0:return 7;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6}break;case 2:switch(v){case 0:return 6;case 1:return 0;case 2:return 1;case 3:return 2;case 4:return 3;case 5:return 4;case 6:return 5}break;case 1:v++;break}return v},WEEKNUM:function(v){v=e.get(v);return e.week(v)+1},YEAR:function(v){v=e.get(v);return v.getFullYear()},DAYSFROM:function(w,x,v){return g.floor((new a()-new a(w,(x-1),v))/e.dayDiv)},DAYS:function(z,x){var w=e.get(z),v=e.get(x),y=1000*60*60*24;return g.round(g.abs(w.getTime()-v.getTime())/y)},DAY:function(v){v=e.get(v);return v.getDate()},DAYS360:function(A,x,C){A=e.get(A);x=e.get(x);var v=A.getDate(),z=x.getDate(),y=e.isLastDayOfMonth(A),B=e.isLastDayOfMonth(x),w=e.diffMonths(A,x);if(C){v=g.min(v,30);z=g.min(z,30)}else{if(y){v=30}if(B){if(v<30){w++;z=1}else{z=30}}}return(w*30)+(z-v)},DATE:function(y,z,w){var x=new a(y,z-1,w),v=new s(e.toCentury(x));v.html=e.toString(x,"d");return v},DATEVALUE:function(w){w=e.get(w);var v=new s(e.toCentury(w));v.html=e.toString(w,"d");return v},EDATE:function(x,w){x=e.get(x);x.setMonth(x.getMonth()+w);var v=new s(e.toCentury(x));v.html=e.toString(x,"d");return v},EOMONTH:function(x,w){x=e.get(x);x.setMonth(x.getMonth()+w+1);x=new a(x.getFullYear(),x.getMonth(),0);var v=new s(e.toCentury(x));v.html=e.toString(x,"d");return v},HOUR:function(v){v=i.fromMath(v);return v.hour},MINUTE:function(v){return i.fromMath(v).minute},MONTH:function(v){v=e.get(v);return v.getMonth()+1},SECOND:function(v){return i.fromMath(v).second},TIME:function(v,A,w){w=(w?w:0);A=(A?A:0);v=(v?v:0);if(w&&w>60){var x=(((w/60)+"").split(".")[0])*1;w=w-(x*60);A+=x}if(A&&A>60){var z=(((A/60)+"").split(".")[0])*1;A=A-(z*60);v+=z}var y=(v*60*60*1000)+(A*60*1000)+(w*1000);return y/e.dayDiv},TIMEVALUE:function(v){if(!isNaN(v)){return v}if(/([0]?[1-9]|1[0-2])[:][0-5][0-9]([:][0-5][0-9])?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm)/.test(v)){return i.fromString(v,true)}else{if(/([0]?[0-9]|1[0-9]|2[0-3])[:][0-5][0-9]([:][0-5][0-9])?/.test(v)){return i.fromString(v)}}return 0},WORKDAY:function(w,z,y){var A={1:true,2:true,3:true,4:true,5:true},w=e.get(w),z=(z&&!isNaN(z)?z:0),B=0,x=0,v=w,D;if(y){if(!jQuery.isArray(y)){y=[y]}y=c.flatten(y);var C={};jQuery.each(y,function(E){if(y[E]){C[e.toString(e.get(y[E]),"d")]=true}});y=C}else{y={}}while(x<z){v=new a(v.setDate(v.getDate()+1));if(A[v.getDay()]){if(!y[e.toString(v,"d")]){x++}}B++}D=new s(e.toCentury(v));D.html=e.toString(v,"d");return D},YEARFRAC:function(w,A,z){w=e.get(w);A=e.get(A);if(!w||!A){var v=new p("");v.html="#VALUE!";return v}z=(z?z:0);this.html=[];var y=e.diff(w,A,z),x=e.calcAnnualBasis(w,A,z);return y/x},AND:function(){var w,x=0,v=arguments.length;for(;x<v;x++){w=arguments[x];if(w===undefined||(w.valueOf!==undefined&&w.valueOf()!=true)||w!=true){return n.FALSE()}}return n.TRUE()},FALSE:function(){var v=new t(false);v.html="FALSE";return v},IF:function(z,x,w){var v=z.valueOf(),y;switch(typeof v){case"boolean":if(v===true){return x}else{return w}break;case"number":if(v!==0){return x}else{return w}break;case"string":y=v.toUpperCase();if(y==="TRUE"){return x}else{if(y==="FALSE"){return w}else{if(y.replace(/ /g,"").length>0){return x}}}break}if(v){return x}return x},NOT:function(x){var w;if(!x.valueOf()){w=new t(true);w.html="TRUE"}else{w=new t(false);w.html="FALSE"}return w},OR:function(){var y=arguments,w,z=y.length-1,x;if(z>-1){do{x=y[z].valueOf();if(x){w=new t(true);w.html="TRUE";return w}}while(z--)}w=new t(false);w.html="FALSE";return w},TRUE:function(){var v=new t(true);v.html="TRUE";return v},GREATER:function(x,w){var v;if(x>w){v=new t(true);v.html="TRUE"}else{v=new t(false);v.html="FALSE"}return v},LESS:function(x,w){var v;if(x<w){v=new t(true);v.html="TRUE"}else{v=new t(false);v.html="FALSE"}return v},EQUAL:function(y,x){var v,z,w;if(y===undefined||y===null){y=""}if(x===undefined||x===null){x=""}z=y+"";w=x+"";if(z==w){v=new t(true);v.html="TRUE"}else{v=new t(false);v.html="FALSE"}return v},GREATER_EQUAL:function(x,w){var v;if(x>=w){v=new t(true);v.html="TRUE"}else{v=new t(false);v.html="FALSE"}return v},LESS_EQUAL:function(x,w){var v;if(x<=w){v=new t(true);v.html="TRUE"}else{v=new t(false);v.html="FALSE"}return v},IMG:function(x){var w=new p("");w.html=d(l.createElement("img")).attr("src",x);return w},TRIM:function(w){if(typeof(w)=="string"){w=d.trim(w)}return w},HYPERLINK:function(w,x){x=x||"LINK";var v=new p(x.valueOf()),y=l.createElement("a");y.setAttribute("href",w);y.setAttribute("target","_new");y.innerText=y.textContent=x;v.html=y;return v},DROPDOWN:function(){var G=this,B=this.jS,y=this.td,E,F,A,D,x,H,z=0,C;if(y!==null){d(y).children().detach();A=G.value.html}if(A===undefined||G.needsUpdated||A.length<1){F=c.flatten(arguments);F=c.unique(F);if(this.id!==null){x=this.id+"-dropdown"}else{if(y!==null){x="dropdown"+this.sheetIndex+"_"+this.rowIndex+"_"+this.columnIndex+"_"+B.I}}D=l.createElement("select");D.setAttribute("name",x);D.setAttribute("id",x);D.className="jSDropdown";D.cell=this;D.onmouseup=function(){if(this.cell.td!==null){B.cellEdit(this.cell.td)}};D.onchange=function(){E=new p(this.value);E.html=D;E.cell=G;G.value=E;G.setNeedsUpdated(false);B.resolveCell(G);B.trigger("sheetCellEdited",[G])};C=(F.length<=50?F.length:50);for(;z<C;z++){if(F[z]){var w=l.createElement("option");w.setAttribute("value",F[z]);w.text=w.innerText=F[z];D.appendChild(w)}}if(!B.s.editable){D.setAttribute("disabled",true)}else{B.s.parent.bind("sheetKill",function(){y.innerText=y.textContent=G.value=D.value})}D.value=G.value||F[0]}if(typeof G.value!=="object"){H=new p(G.value)}else{H=G.value}H.html=D;return H},RADIO:function(){var I=this,C=this.jS,z=this.td,H,G,B,D,w,y,x,J;if(z!==null){B=I.value.html;d(z).children().detach()}if(B===undefined||B.length<1||I.needsUpdated){H=c.flatten(arguments);H=c.unique(H);D=[];if(this.id!==null){x=this.id+"-radio"}else{if(z!==null){x="radio"+this.sheetIndex+"_"+this.rowIndex+"_"+this.columnIndex+"_"+C.I}}B=l.createElement("span");B.className="jSRadio";B.onmousedown=function(){if(this.cell.td!==null){C.cellEdit(this.cell.td)}};B.cell=I;for(var A=0;A<(H.length<=25?H.length:25);A++){if(H[A]){var F=l.createElement("input"),E=l.createElement("span");F.setAttribute("type","radio");F.setAttribute("name",x);F.className=x;F.value=H[A];F.onchange=function(){G=new p(this.value);G.html=B;G.cell=I;I.value=G;I.setNeedsUpdated(false);C.resolveCell(I);C.trigger("sheetCellEdited",[I])};D.push(F);if(H[A]==I.value){F.setAttribute("checked","true")}E.textContent=E.innerText=H[A];B.appendChild(F);B.input=F;E.onclick=function(){d(this).prev().click()};B.appendChild(E);B.appendChild(l.createElement("br"))}}w=d(D);if(!C.s.editable){I.value=w.filter(":checked").val();w.attr("disabled",true)}else{C.s.parent.bind("sheetKill",function(){I.value=w.filter(":checked").val();z.textContent=z.innerText=I.value})}}if(typeof I.value!=="object"){J=new p(I.value)}else{J=I.value}J.html=B;return J},CHECKBOX:function(D){if(d.isArray(D)){D=D[0]}var E=this,z=this.jS,x=this.td,y,B,A,w,C,F;if(x!==null){y=E.value.html;d(x).children().detach()}if(y===undefined||y.length<1||E.needsUpdated){if(this.id!==null){w=this.id+"-checkbox"}else{if(x!==null){w="checkbox"+this.sheet+"_"+this.rowIndex+"_"+this.columnIndex+"_"+z.I}}A=l.createElement("input");A.setAttribute("type","checkbox");A.setAttribute("name",w);A.setAttribute("id",w);A.className=w;A.value=D;A.onchange=function(){if(d(this).is(":checked")){C=new p(D)}else{C=new p("")}C.html=y;C.cell=E;E.value=C;E.setNeedsUpdated(false);z.resolveCell(E);z.trigger("sheetCellEdited",[E])};if(!z.s.editable){A.setAttribute("disabled","true")}else{z.s.parent.bind("sheetKill",function(){E.value=(E.value=="true"||d(A).is(":checked")?D:"");if(E.td!==null){E.td.innerText=E.td.textContent=E.cell.value}})}y=l.createElement("span");y.className="jSCheckbox";y.appendChild(A);B=l.createElement("span");B.textContent=B.innerText=D;y.appendChild(B);y.appendChild(l.createElement("br"));y.onmousedown=function(){if(this.cell.td!==null){z.cellEdit(this.cell.td)}};y.cell=E;if(D==E.value||E.value==="true"){A.checked=true}}if(E.value==="true"||d(A).is(":checked")){F=new p(D)}else{F=new p("")}F.html=y;return F},BARCHART:function(w,x,y){var v=new p("");v.html=h.chart.call(this,{type:"bar",data:w,legend:x,title:y});return v},HBARCHART:function(w,x,y){var v=new p("");v.html=h.chart.call(this,{type:"hbar",data:w,legend:x,title:y});return v},LINECHART:function(x,w){var v=new p("");v.html=h.chart.call(this,{type:"line",x:{data:x},y:{data:w},title:""});return v},PIECHART:function(w,x,y){var v=new p("");v.html=h.chart.call(this,{type:"pie",data:w,legend:x,title:y});return v},DOTCHART:function(B,z,w,y,x,A){var v=new p("");v.html=h.chart.call(this,{type:"dot",data:(w?w:B),x:{data:B,legend:y},y:{data:(z?z:B),legend:(x?x:y)},title:A});return v},CELLREF:function(w){return(this.jS.spreadsheets[w]?this.jS.spreadsheets[w]:"Cell Reference Not Found")},CALCTIME:function(y,w){y=y||"";w=w||"";var v=this,x=this.jS;this.jS.s.parent.one("sheetCalculation",function(){x.time.last=x.calcLast;v.td.text(y+x.time.diff()+w)});return""},HLOOKUP:function(B,y,x,D){if(B===undefined){return null}var z=this.jS,C,v,E="",w=0,A=y.length;x=x||1;D=D!==undefined?D:true;if(B!==undefined||((isNaN(B)&&B!="#REF!")||B.length===0)){for(;w<A;w++){if(y[w].toString()==B){C=y[w];break}}}else{c.getClosestNum(B,y,function(G,F){if(D){C=G}else{if(G==B){C=G}}})}if(C!==undefined){v=C.cell;v=z.getCell(v.sheetIndex,x,v.columnIndex);if(v!==null){E=v.updateValue()}else{E=""}}else{E=new p();E.html="#N/A"}return E},VLOOKUP:function(B,y,x,D){if(B===undefined){return null}var z=this.jS,C,v,E,w=0,A=y.length;D=D!==undefined?D:true;if((isNaN(B)&&B!="#REF!")||B.length===0){for(;w<A;w++){if(y[w].toString()==B){C=y[w];break}}}else{c.getClosestNum(B,y,function(G,F){if(D){C=G}else{if(G==B){C=G}}})}if(C!==undefined){v=C.cell;v=z.getCell(v.sheetIndex,v.rowIndex,x);if(v!==null){E=v.value}else{E=""}}else{E=new p();E.html="#N/A"}return E},TRANSPOSE:function(H){var N=0,C=this.jS,B=this.sheetIndex,F=H[0],x=F.cell,y=H[H.length-1],J=y.cell,v=x.rowIndex,A=x.columnIndex,E,O,w,z=[],M,G,D=[],I,L=H.length,K,P=false;for(;N<L;N++){I=H[N];w=I.cell;E=this.rowIndex+(w.columnIndex-A);O=this.columnIndex+(w.rowIndex-v);G=C.getCell(this.sheetIndex,E,O);if(G!==null&&G!==this){if(G.value!=""){P=true}D.push(G);z.push(w)}}if(P){K=new p("");K.html="#REF!";return K}N=0;L=D.length;for(;N<L;N++){G=D[N];if(G!==this){w=z[N];G.defer=w;G.setNeedsUpdated();M=G.updateValue();G.addDependency(this);G.td.innerHTML=M}}return F},THISROWCELL:function(v){var w=this.jS;if(isNaN(v)){v=h.columnLabelIndex(v)}return w.getCell(this.sheetIndex,this.rowIndex,v).updateValue()},THISCOLCELL:function(w){var v=this.jS;return v.getCell(this.sheetIndex,w,this.columnIndex).updateValue()}};var r={BACKSPACE:8,CAPS_LOCK:20,COMMA:188,CONTROL:17,ALT:18,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,C:67,F:70,V:86,X:88,Y:89,Z:90,UNKNOWN:229};var c=f.arrHelpers={math:g,toNumbers:function(v){v=this.flatten(v);var w=v.length-1;if(w<0){return[]}do{if(v[w]){v[w]=d.trim(v[w]);if(isNaN(v[w])){v[w]=0}else{v[w]=v[w]*1}}else{v[w]=0}}while(w--);return v},unique:function(v){var z={},x,w=v.length,y=[];for(x=0;x<w;x+=1){z[v[x]]=v[x]}for(x in z){y.push(z[x])}return y},flatten:function(w){var z=[],y,x=0,v=w.length;for(;x<v;x++){y=w[x];if(y instanceof Array){z=z.concat(this.flatten(y))}else{z=z.concat(y)}}return z},insertAt:function(v,x,w){d(x).each(function(){if(w>-1&&w<=v.length){v.splice(w,0,this)}});return v},indexOfNearestLessThan:function(B,A){if(B.length===0){return -1}var y=B.length-1,v=0,w,x,z=-1;if(B[y]<A){return y}while(v<=y){w=(v+y)>>1;x=B[w];if(x>A){y=w-1}else{if(x<A){z=w;v=w+1}else{z=v;break}}}return z},ofSet:function(E,y){if(E.length===0){return null}var w=E.length-1,B=w,x=E[w],C=E[0],F=0,G,H,D=-1,A,z=-1,v=-1;if(E[w]<y||E[0]>y){return null}else{while(F<=w){G=(F+w)>>1;H=E[G];if(H>y){D=G;w=G-1}else{if(H<y){F=G+1}else{D=w;break}}}}if(D>-1){A=D;while(A<=B){if(E[A]+1===E[A+1]){A++}else{z=E[A];break}}if(z===-1){z=x}A=D;while(A>=0){if(E[A]-1===E[A-1]){A--}else{v=E[A];break}}if(v===-1){v=C}}return{start:v,end:z}},closest:function(A,w,x,v){x=x||0;v=v||A.length-1;var z,y;while(true){z=((x+v)>>1);y=A[z];if((z===v||z===x)&&y!==w){return y}if(y>w){v=z}else{if(y<w){x=z}else{return y}}}},getClosestNum:function(x,v,z){var y=0,w,C,B,A;if(v.length){C=v[0];w=y;for(y;y<v.length;y++){B=g.abs(x-C);A=g.abs(x-v[y]);if(A<B){w=y;C=v[y]}B=null;A=null}if(z){return z(C,w)}return C}return false},levenshtein:(function(){var v=[];return function(F,E){if(F===E){return 0}else{var C=F.length,A=E.length;if(C&&A){var x=0,w=0,D,B,z,y,G=v;while(x<C){G[x]=++x}while(w<A){y=E.charCodeAt(w);D=w;++w;B=w;for(x=0;x<C;++x){z=D+(F.charCodeAt(x)===y?0:1);D=G[x];B=B<D?(B<z?B+1:z):(D<z?D+1:z);G[x]=B}}return B}else{return C+A}}}})(),lSearch:function(w,A){var x=0,y,v=w.length,z=-1,B;for(;x<v;x++){y=w[x];B=new s(this.levenshtein(y,A));B.item=y;if(B<z){z=B}}return(B!==undefined?B.item:null)}};var e={dayDiv:86400000,math:g,toCentury:function(v,w){w=w||86400000;return this.math.round(this.math.abs((new a(1900,0,-1))-v)/w)},get:function(w,x){x=x||86400000;if(w.getMonth){return w}else{if(isNaN(w)){return new a(Globalize.parseDate(w))}else{w*=x;var v=(new a(1900,0,-1))*1;w+=v;w=new a(w);return w}}},week:function(v,x){x=x||86400000;var w=new a(v.getFullYear(),0,1);return this.math.ceil((((v-w)/x)+w.getDay()+1)/7)},toString:function(v,w){if(!w){return Globalize.format(v)}return Globalize.format(v,Globalize.culture().calendar.patterns[w])},diff:function(z,w,y,x){x=x||86400000;switch(y){case 0:return this.days360Nasd(z,w,0,true);case 1:case 2:case 3:var v=this.math.abs(w-z)/x;return v;case 4:return this.days360Euro(z,w)}return 0},diffMonths:function(x,w){var v;v=(w.getFullYear()-x.getFullYear())*12;v-=x.getMonth()+1;v+=w.getMonth()+1;return v},days360:function(x,A,y,w,v,z){return((A-x)*360)+((w-y)*30)+(z-v)},days360Nasd:function(w,z,v,x){var y=w.getDate(),D=w.getMonth(),C=w.getFullYear(),B=z.getDate(),A=z.getMonth(),E=z.getFullYear();if((A==2&&this.isEndOfMonth(B,A,E))&&((D==2&&this.isEndOfMonth(y,D,C))||v==3)){B=30}if(B==31&&(y>=30||v==3)){B=30}if(y==31){y=30}if(x&&D==2&&this.isEndOfMonth(y,D,C)){y=30}return this.days360(C,E,D,A,y,B)},days360Euro:function(C,x){var v=C.getDate(),z=C.getMonth(),y=C.getFullYear(),A=x.getDate(),w=x.getMonth(),B=x.getFullYear();if(v==31){v=30}if(A==31){A=30}return this.days360(y,B,z,w,v,A)},isEndOfMonth:function(v,x,w){return v==(new a(w,x+1,0,23,59,59)).getDate()},isLeapYear:function(v){return new a(v,1,29).getMonth()==1},calcAnnualBasis:function(v,x,B){switch(B){case 0:case 2:case 4:return 360;case 3:return 365;case 1:var w=v.getDate(),D=v.getMonth(),A=v.getFullYear(),y=x.getDate(),z=x.getMonth(),E=x.getFullYear(),F=0;if(A==E){if(this.isLeapYear(A)){F=366}else{F=365}}else{if(((E-1)==A)&&((D>z)||((D==z)&&w>=y))){if(this.isLeapYear(A)){if(D<2||(D==2&&w<=29)){F=366}else{F=365}}else{if(this.isLeapYear(E)){if(z>2||(z==2&&y==29)){F=366}else{F=365}}else{F=365}}}else{for(var C=A;C<=E;C++){if(this.isLeapYear(C)){F+=366}else{F+=365}}F=F/(E-A+1)}}return F}return 0},lastDayOfMonth:function(v){v.setDate(0);return v.getDate()},isLastDayOfMonth:function(v){return(v.getDate()==this.lastDayOfMonth(v))}};var i=f.times={math:g,fromMath:function(x){var v={},w=this;v.hour=((x*24)+"").split(".")[0]*1;v.minute=function(y){y=w.math.round(y*24*100)/100;y=(y+"").split(".");var z=0;if(y[1]){if(y[1].length<2){y[1]+="0"}z=y[1]*0.6}return w.math.round(z)}(x);v.second=function(B){B=w.math.round(B*24*10000)/10000;B=(B+"").split(".");var z=0;if(B[1]){for(var A=0;A<4;A++){if(!B[1].charAt(A)){B[1]+="0"}}var y=((B[1]*0.006)+"").split(".");if(y[1]){if(y[1]&&y[1].length>2){y[1]=y[1].substr(0,2)}return w.math.round(y[1]*0.6)}}return z}(x);return v},fromString:function(x,B){var y=new a(),C=x,v,A,z,w,D;if(B){D=C.substr(-2).toLowerCase();C=C.replace(/(am|pm)/i,"")}C=C.split(":");A=C[0]*1;z=C[1]*1;w=(C[2]?C[2]:0)*1;if(B&&D=="pm"){A+=12}return n.TIME(A,z,w)}};d.extend(g,{log10:function(v){return g.log(v)/2.302585092994046},signum:function(v){return(v/g.abs(v))||v},log1p:function(v){var w=0,z=50;if(v<=-1){return"-INF"}if(v<0||v>1){return g.log(1+v)}for(var y=1;y<z;y++){if((y%2)===0){w-=g.pow(v,y)/y}else{w+=g.pow(v,y)/y}}return w}});var m=function(){var B=l,E=d(l.createElement("p")).css({width:"100%",height:"100%"}),D=d(l.createElement("div")).css({position:"absolute",width:"100px",height:"100px",top:"0",left:"0",visibility:"hidden",overflow:"hidden"}).append(E);d(l.body).append(D);var y=E.width(),A=E.height();D.css("overflow","scroll");var v=E.width(),z=E.height();if(y==v&&D[0].clientWidth){v=D[0].clientWidth}if(A==z&&D[0].clientHeight){z=D[0].clientHeight}D.detach();var C=y-v,x=A-z;return{width:C||15,height:x||15}};var j=function(){var v="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",x=d(l.createElement("span")).html(v).appendTo("body"),w={width:x.width()/v.length,height:x.height()};x.remove();return w};var o=function(v,C,z,w,B){w=w||"#"+g.floor(g.random()*16777215).toString(16);if(z){var A=d([]);A=A.add(o(z.left,z.top,null,w,"top-left"));A=A.add(o(z.right,z.top,null,w,"top-right"));A=A.add(o(z.left,z.bottom,null,w,"bottom-left"));A=A.add(o(z.right,z.bottom,null,w,"bottom-right"));return A}return d('<div style="width: 10px; height: 10px; position: absolute;"></div>').css("top",(C-5)+"px").css("left",(v+5)+"px").css("background-color",w).click(function(){console.log(B||"none")}).appendTo("body")};d.printSource=function(x){var v=win.open();v.document.write("<html><body><xmp>"+x+"\n</xmp></body></html>");v.document.close()};if(!Object.getPrototypeOf){Object.getPrototypeOf=function(v){return v||{}}}if(!Array.prototype.indexOf){d.sheet.max=60;Array.prototype.indexOf=function(x,y){for(var w=(y||0),v=this.length;w<v;w++){if(this[w]===x){return w}}return -1}}return k})(jQuery,document,window,Date,String,Number,Boolean,Math,RegExp,Error);var parser=(function(){var T=function(X,W,Y,V){for(Y=Y||{},V=X.length;V--;Y[X[V]]=W){}return Y},m=[1,5],l=[1,6],k=[1,8],j=[1,9],i=[1,10],h=[1,13],f=[1,11],d=[1,12],c=[1,14],b=[1,15],S=[1,20],R=[1,18],Q=[1,21],P=[1,22],O=[1,17],N=[1,24],M=[1,25],L=[1,26],K=[1,27],J=[1,28],I=[1,29],H=[1,30],G=[1,31],F=[1,32],E=[4,13,14,15,17,18,19,20,21,22,23,35,36],D=[1,35],C=[1,36],A=[1,37],z=[4,13,14,15,17,18,19,20,21,22,23,35,36,38],y=[4,13,14,15,17,18,19,20,21,22,23,35,36,39],x=[4,13,14,15,17,18,19,20,21,22,23,29,35,36],w=[4,14,15,17,18,19,20,35,36],v=[1,71],t=[4,14,17,18,19,35,36],s=[4,14,15,17,18,19,20,21,22,35,36],r=[17,35,36];var B={trace:function q(){},yy:{},symbols_:{error:2,expressions:3,EOF:4,expression:5,variableSequence:6,TIME_AMPM:7,TIME_24:8,number:9,STRING:10,ESCAPED_STRING:11,LETTERS:12,"&":13,"=":14,"+":15,"(":16,")":17,"<":18,">":19,"-":20,"*":21,"/":22,"^":23,E:24,FUNCTION:25,expseq:26,cellRange:27,cell:28,":":29,SHEET:30,"!":31,NUMBER:32,"$":33,REF:34,";":35,",":36,VARIABLE:37,DECIMAL:38,"%":39,"$accept":0,"$end":1},terminals_:{2:"error",4:"EOF",7:"TIME_AMPM",8:"TIME_24",10:"STRING",11:"ESCAPED_STRING",12:"LETTERS",13:"&",14:"=",15:"+",16:"(",17:")",18:"<",19:">",20:"-",21:"*",22:"/",23:"^",24:"E",25:"FUNCTION",29:":",30:"SHEET",31:"!",32:"NUMBER",33:"$",34:"REF",35:";",36:",",37:"VARIABLE",38:"DECIMAL",39:"%"},productions_:[0,[3,1],[3,2],[5,1],[5,1],[5,1],[5,1],[5,1],[5,1],[5,1],[5,3],[5,3],[5,3],[5,3],[5,4],[5,4],[5,4],[5,3],[5,3],[5,3],[5,3],[5,3],[5,3],[5,2],[5,2],[5,1],[5,3],[5,4],[5,1],[27,1],[27,3],[27,3],[27,5],[28,2],[28,3],[28,3],[28,4],[28,1],[28,2],[28,2],[28,2],[28,3],[28,3],[28,3],[28,3],[28,3],[28,3],[28,4],[28,4],[28,4],[26,1],[26,2],[26,2],[26,3],[26,3],[6,1],[6,3],[9,1],[9,3],[9,2]],performAction:function p(X,Z,o,aa,ac,ad,V){var W=ad.length-1;switch(ac){case 1:return null;break;case 2:var Y=aa.types;aa.types=[];return Y;break;case 3:var ab={t:"m",m:"variable",a:[ad[W]]};this.$=aa.types.length;aa.types.push(ab);break;case 4:var ab={t:"m",m:"time",a:[ad[W],true]};this.$=aa.types.length;aa.types.push(ab);break;case 5:var ab={t:"m",m:"time",a:[ad[W]]};this.$=aa.types.length;aa.types.push(ab);break;case 6:var ab={t:"m",m:"number",a:[ad[W]]};this.$=aa.types.length;aa.types.push(ab);break;case 7:var ab={t:"v",v:aa.escape(ad[W].substring(1,ad[W].length-1))};this.$=aa.types.length;aa.types.push(ab);break;case 8:var ab={t:"v",v:aa.escape(ad[W].substring(2,ad[W].length-2))};this.$=aa.types.length;aa.types.push(ab);break;case 9:var ab={t:"v",v:ad[W]};aa.types.push(ab);break;case 10:var ab={t:"m",m:"concatenate",a:[ad[W-2],ad[W]]};this.$=aa.types.length;aa.types.push(ab);break;case 11:var ab={t:"m",m:"callFunction",a:["EQUAL",[ad[W-2],ad[W]]]};this.$=aa.types.length;aa.types.push(ab);break;case 12:var ab={t:"m",m:"performMath",a:["+",ad[W-2],ad[W]]};this.$=aa.types.length;aa.types.push(ab);break;case 13:this.$=ad[W-1];break;case 14:var ab={t:"m",m:"callFunction",a:["LESS_EQUAL",[ad[W-3],ad[W]]]};this.$=aa.types.length;aa.types.push(ab);break;case 15:var ab={t:"m",m:"callFunction",a:["GREATER_EQUAL",[ad[W-3],ad[W]]]};this.$=aa.types.length;aa.types.push(ab);break;case 16:var ab={t:"m",m:"not",a:[ad[W-3],ad[W]]};this.$=aa.types.length;aa.types.push(ab);break;case 17:var ab={t:"m",m:"callFunction",a:["GREATER",[ad[W-2],ad[W]]]};this.$=aa.types.length;aa.types.push(ab);break;case 18:var ab={t:"m",m:"callFunction",a:["LESS",[ad[W-2],ad[W]]]};this.$=aa.types.length;aa.types.push(ab);break;case 19:var ab={t:"m",m:"performMath",a:["-",ad[W-2],ad[W]]};this.$=aa.types.length;aa.types.push(ab);break;case 20:var ab={t:"m",m:"performMath",a:["*",ad[W-2],ad[W]]};this.$=aa.types.length;aa.types.push(ab);break;case 21:var ab={t:"m",m:"performMath",a:["/",ad[W-2],ad[W]]};this.$=aa.types.length;aa.types.push(ab);break;case 22:var ab={t:"m",m:"performMath",a:["^",ad[W-2],ad[W]]};this.$=aa.types.length;aa.types.push(ab);break;case 23:var ab={t:"m",m:"invertNumber",a:[ad[W]]};this.$=aa.types.length;aa.types.push(ab);break;case 24:var ab={t:"m",m:"number",a:[ad[W]]};this.$=aa.types.length;aa.types.push(ab);break;case 25:break;case 26:var ab={t:"m",m:"callFunction",a:[ad[W-2]]};this.$=aa.types.length;aa.types.push(ab);break;case 27:var ab={t:"m",m:"callFunction",a:[ad[W-3],ad[W-1]]};this.$=aa.types.length;aa.types.push(ab);break;case 29:var ab={t:"l",m:"cellValue",a:[ad[W]]};this.$=aa.types.length;aa.types.push(ab);break;case 30:var ab={t:"l",m:"cellRangeValue",a:[ad[W-2],ad[W]]};this.$=aa.types.length;aa.types.push(ab);break;case 31:var ab={t:"l",m:"remoteCellValue",a:[ad[W-2],ad[W]]};this.$=aa.types.length;aa.types.push(ab);break;case 32:var ab={t:"l",m:"remoteCellRangeValue",a:[ad[W-4],ad[W-2],ad[W]]};this.$=aa.types.length;aa.types.push(ab);break;case 33:var ab={t:"cell",c:ad[W-1],r:ad[W]};this.$=aa.types.length;aa.types.push(ab);break;case 34:var ab={t:"cell",c:ad[W-1],r:ad[W]};this.$=aa.types.length;aa.types.push(ab);break;case 35:case 36:var ab={t:"cell",c:ad[W-2],r:ad[W]};this.$=aa.types.length;aa.types.push(ab);break;case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:return"#REF!";break;case 50:this.$=[ad[W]];break;case 53:ad[W-2].push(ad[W]);this.$=ad[W-2];break;case 54:ad[W-2].push(ad[W]);this.$=ad[W-2];break;case 55:this.$=[ad[W]];break;case 56:this.$=(ad[W-2] instanceof Array?ad[W-2]:[ad[W-2]]);this.$.push(ad[W]);break;case 57:this.$=ad[W];break;case 58:this.$=(ad[W-2]+"."+ad[W])*1;break;case 59:this.$=ad[W-1]*0.01;break}},table:[{3:1,4:[1,2],5:3,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:S,32:R,33:Q,34:P,37:O},{1:[3]},{1:[2,1]},{4:[1,23],13:N,14:M,15:L,18:K,19:J,20:I,21:H,22:G,23:F},T(E,[2,3],{38:[1,33]}),T(E,[2,4]),T(E,[2,5]),T(E,[2,6],{39:[1,34]}),T(E,[2,7]),T(E,[2,8]),T(E,[2,9],{32:D,33:C,34:A}),{5:38,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:S,32:R,33:Q,34:P,37:O},{5:39,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:S,32:R,33:Q,34:P,37:O},{5:40,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:S,32:R,33:Q,34:P,37:O},T(E,[2,25]),{16:[1,41]},T(E,[2,28]),T(z,[2,55]),T(y,[2,57],{38:[1,42]}),T(E,[2,29],{29:[1,43]}),{31:[1,44]},{12:[1,45],34:[1,46]},T(x,[2,37],{32:[1,47],33:[1,49],34:[1,48]}),{1:[2,2]},{5:50,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:S,32:R,33:Q,34:P,37:O},{5:51,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:S,32:R,33:Q,34:P,37:O},{5:52,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:S,32:R,33:Q,34:P,37:O},{5:55,6:4,7:m,8:l,9:7,10:k,11:j,12:i,14:[1,53],15:h,16:f,19:[1,54],20:d,24:c,25:b,27:16,28:19,30:S,32:R,33:Q,34:P,37:O},{5:57,6:4,7:m,8:l,9:7,10:k,11:j,12:i,14:[1,56],15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:S,32:R,33:Q,34:P,37:O},{5:58,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:S,32:R,33:Q,34:P,37:O},{5:59,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:S,32:R,33:Q,34:P,37:O},{5:60,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:S,32:R,33:Q,34:P,37:O},{5:61,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:S,32:R,33:Q,34:P,37:O},{37:[1,62]},T(y,[2,59]),T(x,[2,33]),{32:[1,63],34:[1,64]},T(x,[2,39]),{13:N,14:M,15:L,17:[1,65],18:K,19:J,20:I,21:H,22:G,23:F},T(w,[2,23],{13:N,21:H,22:G,23:F}),T(w,[2,24],{13:N,21:H,22:G,23:F}),{5:68,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,17:[1,66],20:d,24:c,25:b,26:67,27:16,28:19,30:S,32:R,33:Q,34:P,37:O},{32:[1,69]},{12:v,28:70,33:Q,34:P},{12:v,28:72,33:Q,34:P},{32:[1,73],33:[1,74],34:[1,75]},{32:[1,76],33:[1,78],34:[1,77]},T(x,[2,38]),T(x,[2,40]),{32:[1,79],34:[1,80]},T([4,17,35,36],[2,10],{13:N,14:M,15:L,18:K,19:J,20:I,21:H,22:G,23:F}),T([4,14,17,35,36],[2,11],{13:N,15:L,18:K,19:J,20:I,21:H,22:G,23:F}),T(w,[2,12],{13:N,21:H,22:G,23:F}),{5:81,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:S,32:R,33:Q,34:P,37:O},{5:82,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:S,32:R,33:Q,34:P,37:O},T(t,[2,18],{13:N,15:L,20:I,21:H,22:G,23:F}),{5:83,6:4,7:m,8:l,9:7,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,27:16,28:19,30:S,32:R,33:Q,34:P,37:O},T(t,[2,17],{13:N,15:L,20:I,21:H,22:G,23:F}),T(w,[2,19],{13:N,21:H,22:G,23:F}),T(s,[2,20],{13:N,23:F}),T(s,[2,21],{13:N,23:F}),T([4,14,15,17,18,19,20,21,22,23,35,36],[2,22],{13:N}),T(z,[2,56]),T(x,[2,35]),T(x,[2,45]),T(E,[2,13]),T(E,[2,26]),{17:[1,84],35:[1,85],36:[1,86]},T(r,[2,50],{13:N,14:M,15:L,18:K,19:J,20:I,21:H,22:G,23:F}),T(y,[2,58]),T(E,[2,30]),{32:D,33:C,34:A},T(E,[2,31],{29:[1,87]}),T(x,[2,34]),{32:[1,88]},T(x,[2,42]),T(x,[2,41]),T(x,[2,43]),{32:[1,89],34:[1,90]},T(x,[2,44]),T(x,[2,46]),T(t,[2,14],{13:N,15:L,20:I,21:H,22:G,23:F}),T(t,[2,16],{13:N,15:L,20:I,21:H,22:G,23:F}),T(t,[2,15],{13:N,15:L,20:I,21:H,22:G,23:F}),T(E,[2,27]),T(r,[2,51],{6:4,9:7,27:16,28:19,5:91,7:m,8:l,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,30:S,32:R,33:Q,34:P,37:O}),T(r,[2,52],{6:4,9:7,27:16,28:19,5:92,7:m,8:l,10:k,11:j,12:i,15:h,16:f,20:d,24:c,25:b,30:S,32:R,33:Q,34:P,37:O}),{12:v,28:93,33:Q,34:P},T(x,[2,36]),T(x,[2,47]),T(x,[2,49]),T(r,[2,53],{13:N,14:M,15:L,18:K,19:J,20:I,21:H,22:G,23:F}),T(r,[2,54],{13:N,14:M,15:L,18:K,19:J,20:I,21:H,22:G,23:F}),T(E,[2,32])],defaultActions:{2:[2,1],23:[2,2]},parseError:function g(V,o){if(o.recoverable){this.trace(V)}else{throw new Error(V)}},parse:function n(ag){var ao=this,ad=[0],an=[],az=[null],ai=[],aB=this.table,W="",ah=0,ax=0,Y=0,af=2,am=1;var Z=ai.slice.call(arguments,1);var o=Object.create(this.lexer);var aA={yy:{}};for(var aw in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,aw)){aA.yy[aw]=this.yy[aw]}}o.setInput(ag,aA.yy);aA.yy.lexer=o;aA.yy.parser=this;if(typeof o.yylloc=="undefined"){o.yylloc={}}var X=o.yylloc;ai.push(X);var aa=o.options&&o.options.ranges;if(typeof aA.yy.parseError==="function"){this.parseError=aA.yy.parseError}else{this.parseError=Object.getPrototypeOf(this).parseError}function al(aE){ad.length=ad.length-2*aE;az.length=az.length-aE;ai.length=ai.length-aE}_token_stack:function ak(){var aE;aE=o.lex()||am;if(typeof aE!=="number"){aE=ao.symbols_[aE]||aE}return aE}var av,aq,ac,au,aD,aj,at={},ap,ay,V,ae;while(true){ac=ad[ad.length-1];if(this.defaultActions[ac]){au=this.defaultActions[ac]}else{if(av===null||typeof av=="undefined"){av=ak()}au=aB[ac]&&aB[ac][av]}_handle_error:if(typeof au==="undefined"||!au.length||!au[0]){var ab;var ar="";function aC(aF){var aE=ad.length-1;var aG=0;for(;;){if((af.toString()) in aB[aF]){return aG}if(aF===0||aE<2){return false}aE-=2;aF=ad[aE];++aG}}if(!Y){ab=aC(ac);ae=[];for(ap in aB[ac]){if(this.terminals_[ap]&&ap>af){ae.push("'"+this.terminals_[ap]+"'")}}if(o.showPosition){ar="Parse error on line "+(ah+1)+":\n"+o.showPosition()+"\nExpecting "+ae.join(", ")+", got '"+(this.terminals_[av]||av)+"'"}else{ar="Parse error on line "+(ah+1)+": Unexpected "+(av==am?"end of input":("'"+(this.terminals_[av]||av)+"'"))}return this.parseError(ar,{text:o.match,token:this.terminals_[av]||av,line:o.yylineno,loc:X,expected:ae,recoverable:(ab!==false)})}else{if(aq!==am){ab=aC(ac)}}if(Y==3){if(av===am||aq===am){throw new Error(ar||"Parsing halted while starting to recover from another error.")}ax=o.yyleng;W=o.yytext;ah=o.yylineno;X=o.yylloc;av=ak()}if(ab===false){throw new Error(ar||"Parsing halted. No suitable error recovery rule available.")}al(ab);aq=(av==af?null:av);av=af;ac=ad[ad.length-1];au=aB[ac]&&aB[ac][af];Y=3}if(au[0] instanceof Array&&au.length>1){throw new Error("Parse Error: multiple actions possible at state: "+ac+", token: "+av)}switch(au[0]){case 1:ad.push(av);az.push(o.yytext);ai.push(o.yylloc);ad.push(au[1]);av=null;if(!aq){ax=o.yyleng;W=o.yytext;ah=o.yylineno;X=o.yylloc;if(Y>0){Y--}}else{av=aq;aq=null}break;case 2:ay=this.productions_[au[1]][1];at.$=az[az.length-ay];at._$={first_line:ai[ai.length-(ay||1)].first_line,last_line:ai[ai.length-1].last_line,first_column:ai[ai.length-(ay||1)].first_column,last_column:ai[ai.length-1].last_column};if(aa){at._$.range=[ai[ai.length-(ay||1)].range[0],ai[ai.length-1].range[1]]}aj=this.performAction.apply(at,[W,ax,ah,aA.yy,au[1],az,ai].concat(Z));if(typeof aj!=="undefined"){return aj}if(ay){ad=ad.slice(0,-1*ay*2);az=az.slice(0,-1*ay);ai=ai.slice(0,-1*ay)}ad.push(this.productions_[au[1]][0]);az.push(at.$);ai.push(at._$);V=aB[ad[ad.length-2]][ad[ad.length-1]];ad.push(V);break;case 3:return true}}return true}};var e=function(W){var X=function(){};X.prototype=B.lexer;var V=function(){this.lexer=new X();this.yy={types:[],escape:function(Y){return Y.replace(/&/gi,"&amp;").replace(/>/gi,"&gt;").replace(/</gi,"&lt;").replace(/\n/g,"\n<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp ").replace(/  /g,"&nbsp; ")},parseError:function(aa,Z){this.done=true;var Y=new String();Y.html="<pre>"+aa+"</pre>";Y.hash=Z;return Y}}};V.prototype=B;var o=new V();return o};if(typeof(window)!=="undefined"){window.Formula=e}else{B.Formula=e}var U=(function(){var W=({EOF:1,parseError:function X(af,ae){if(this.yy.parser){this.yy.parser.parseError(af,ae)}else{throw new Error(af)}},setInput:function(ae,af){this.yy=af||this.yy||{};this._input=new a.InputReader(ae);this._more=this._backtrack=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function(){var af=this._input.ch();this.yytext+=af;this.yyleng++;this.offset++;this.match+=af;var ae=af.match(/(?:\r\n?|\n).*/g);if(ae){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}return af},unput:function(ag){var ae=ag.length;var af=ag.split(/(?:\r\n?|\n)/g);this._input.unCh(ae,ag);this.yytext=this.yytext.substr(0,this.yytext.length-ae);this.offset-=ae;var ai=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);if(af.length-1){this.yylineno-=af.length-1}var ah=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:af?(af.length===ai.length?this.yylloc.first_column:0)+ai[ai.length-af.length].length-af[0].length:this.yylloc.first_column-ae};if(this.options.ranges){this.yylloc.range=[ah[0],ah[0]+this.yyleng-ae]}this.yyleng=this.yytext.length;return this},more:function(){this._more=true;return this},reject:function(){if(this.options.backtrack_lexer){this._backtrack=true}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}return this},less:function(ae){this.unput(this.match.slice(ae))},pastInput:function(){var ae=this._input.toString();var af=ae.substr(0,ae.length-this.match.length);return(af.length>20?"...":"")+af.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var ae=this._input.input.substr(this._input.position,this._input.input.length-1);return(ae.substr(0,20)+(ae.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var ae=this.pastInput();var af=new Array(ae.length+1).join("-");return ae+this.upcomingInput()+"\n"+af+"^"},test_match:function(ai,ag){var aj,ae,ah,af;if(this.options.backtrack_lexer){ah={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,yyleng:this.yyleng,offset:this.offset,_more:this._more,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){ah.yylloc.range=this.yylloc.range.slice(0)}}ae=ai.match(/(?:\r\n?|\n).*/g);if(ae){this.yylineno+=ae.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:ae!==null?ae[ae.length-1].length-ae[ae.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+ai.length};this.yytext+=ai;this.match+=ai;this.matches=ai;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._backtrack=false;this._input.addMatch(ai);aj=this.performAction.call(this,this.yy,this,ag,this.conditionStack[this.conditionStack.length-1]);if(this.done&&!this._input.done){this.done=false}if(aj){return aj}else{if(this._backtrack){for(af in ah){if(ah.hasOwnProperty(af)){this[af]=ah[af]}}return null}}return null},next:function(){if(this.done){return this.EOF}if(this._input.done){this.done=true}var ai,ag,ae,af;if(!this._more){this.yytext="";this.match=""}var aj=this._currentRules();for(var ah=0;ah<aj.length;ah++){ae=this._input.match(this.rules[aj[ah]]);if(ae!==null&&(ag===undefined||ae[0].length>ag.length)){ag=ae[0];af=ah;if(this.options.backtrack_lexer){ai=this.test_match(ae[0],aj[ah]);if(ai!==null){return ai}else{if(this._backtrack){ag=undefined;continue}else{return null}}}else{if(!this.options.flex){break}}}}if(ag!==undefined){ai=this.test_match(ag,aj[af]);if(ai!==null){return ai}return null}if(this._input.done){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function o(){var ae=this.next();if(ae!==null){return ae}else{return this.lex()}},begin:function V(ae){this.conditionStack.push(ae)},popState:function Y(){var ae=this.conditionStack.length-1;if(ae>0){return this.conditionStack.pop()}else{return this.conditionStack[0]}},_currentRules:function ad(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}else{return this.conditions.INITIAL.rules}},topState:function ab(ae){ae=this.conditionStack.length-1-Math.abs(ae||0);if(ae>=0){return this.conditionStack[ae]}else{return"INITIAL"}},pushState:function aa(ae){this.begin(ae)},stateStackSize:function Z(){return this.conditionStack.length},options:{},performAction:function ac(ai,af,ah,ae){var ag=ae;switch(ah){case 0:break;case 1:return 25;break;case 2:return 7;break;case 3:return 8;break;case 4:return 30;break;case 5:af.yytext=af.yytext.substring(1,af.yytext.length-1);return 30;break;case 6:return 10;break;case 7:return 10;break;case 8:return 11;break;case 9:return 11;break;case 10:return 12;break;case 11:return 37;break;case 12:return 37;break;case 13:return 32;break;case 14:return 33;break;case 15:return 13;break;case 16:return" ";break;case 17:return 38;break;case 18:return 29;break;case 19:return 35;break;case 20:return 36;break;case 21:return 21;break;case 22:return 22;break;case 23:return 20;break;case 24:return 15;break;case 25:return 23;break;case 26:return 16;break;case 27:return 17;break;case 28:return 19;break;case 29:return 18;break;case 30:return"PI";break;case 31:return 24;break;case 32:return'"';break;case 33:return"'";break;case 34:return'"';break;case 35:return"'";break;case 36:return"!";break;case 37:return 14;break;case 38:return 39;break;case 39:return 34;break;case 40:return"#";break;case 41:return 4;break}},rules:[/^(?:\s+)/,/^(?:([A-Za-z]{1,})([A-Za-z_0-9]+)?(?=[(]))/,/^(?:([0]?[1-9]|1[0-2])[:][0-5][0-9]([:][0-5][0-9])?[ ]?(AM|am|aM|Am|PM|pm|pM|Pm))/,/^(?:([0]?[0-9]|1[0-9]|2[0-3])[:][0-5][0-9]([:][0-5][0-9])?)/,/^(?:(([A-Za-z0-9]+))(?=[!]))/,/^(?:((['](\\[']|[^'])*['])|(["](\\["]|[^"])*["]))(?=[!]))/,/^(?:((['](\\[']|[^'])*['])))/,/^(?:((["](\\["]|[^"])*["])))/,/^(?:(([\\]['].+?[\\]['])))/,/^(?:(([\\]["].+?[\\]["])))/,/^(?:[A-Z]+(?=[0-9$]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\$)/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:PI\b)/,/^(?:E\b)/,/^(?:")/,/^(?:')/,/^(?:\\")/,/^(?:\\')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:#REF!)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41],inclusive:true}}});return W})();B.lexer=U;function a(){this.yy={}}a.prototype=B;a.InputReader=(function(W,V,Z){var Y=RegExp.prototype.sticky!==undefined,ah,ae,af,aa;function ai(aj){this.done=false;this.input=aj;this.length=aj.length;this.matches=[];this.position=0}if(Y){ai.prototype={addMatch:function ag(aj){this.matches.push(aj);this.position+=aj.length;this.done=(this.position>=this.length)},ch:function o(){var aj=this.input[this.position];this.addMatch(aj);return aj},unCh:function ad(aj){this.position-=aj;this.position=W.max(0,this.position);this.done=(this.position>=this.length)},substring:function ac(ak,aj){ak=(ak!=0?this.position+ak:this.position);aj=(aj!=0?ak+aj:this.length);return this.input.substring(ak,aj)},match:function ab(ak){var aj;ak.lastIndex=this.position;if((aj=ak.exec(this.input))!==null){return aj}return null},toString:function X(){return this.matches.join("")}};ah=Z.rules;af=ah.length;aa=0;for(;aa<af;aa++){ae=ah[aa];ah[aa]=new RegExp(ae.source.substring(1),"y")}}else{ai.prototype={addMatch:function ag(aj){this.input=this.input.slice(aj.length);this.matches.push(aj);this.position+=aj.length;this.done=(this.position>=this.length)},ch:function o(){var aj=this.input[0];this.addMatch(aj);return aj},unCh:function ad(ak,aj){this.position-=ak;this.position=W.max(0,this.position);this.input=aj+this.input;this.done=(this.position>=this.length)},substring:function ac(ak,aj){ak=(ak!=0?this.position+ak:this.position);aj=(aj!=0?ak+aj:this.length);return this.input.substring(ak,aj)},match:function ab(al){var ak,aj=this.input;if((ak=aj.match(al))!==null){return ak}return null},toString:function X(){return this.matches.join("")}}}return ai})(Math,B,U);B.Parser=a;return new a})();if(typeof require!=="undefined"&&typeof exports!=="undefined"){exports.parser=parser;exports.Parser=parser.Parser;exports.parse=function(){return parser.parse.apply(parser,arguments)};exports.main=function commonjsMain(a){if(!a[1]){console.log("Usage: "+a[0]+" FILE");process.exit(1)}var b=require("fs").readFileSync(require("path").normalize(a[1]),"utf8");return exports.parser.parse(b)};if(typeof module!=="undefined"&&require.main===module){exports.main(process.argv.slice(1))}}var parser=(function(){var n=function(x,w,y,t){for(y=y||{},t=x.length;t--;y[x[t]]=w){}return y},l=[1,10],j=[1,11],i=[1,12],h=[1,13],g=[5,7,8,9,10],f=[1,19],c=[1,20],a=[5,7,8,9,10,12,13],s=[1,21],r=[5,7,8,9,10,12,13,14,16];var k={trace:function p(){},yy:{},symbols_:{error:2,grid:3,rows:4,EOF:5,row:6,END_OF_LINE:7,END_OF_LINE_WITH_EMPTY_NEXT_FIRST_COLUMN:8,END_OF_LINE_WITH_NO_COLUMNS:9,END_OF_LINE_WITH_EMPTY_COLUMN:10,string:11,COLUMN_EMPTY:12,COLUMN_STRING:13,CHAR:14,QUOTE_ON:15,QUOTE_OFF:16,"$accept":0,"$end":1},terminals_:{2:"error",5:"EOF",7:"END_OF_LINE",8:"END_OF_LINE_WITH_EMPTY_NEXT_FIRST_COLUMN",9:"END_OF_LINE_WITH_NO_COLUMNS",10:"END_OF_LINE_WITH_EMPTY_COLUMN",12:"COLUMN_EMPTY",13:"COLUMN_STRING",14:"CHAR",15:"QUOTE_ON",16:"QUOTE_OFF"},productions_:[0,[3,2],[3,1],[4,1],[4,1],[4,1],[4,1],[4,1],[4,2],[4,2],[4,2],[4,2],[4,3],[4,3],[4,3],[4,3],[6,1],[6,1],[6,2],[6,3],[6,1],[6,2],[6,3],[11,1],[11,2],[11,3]],performAction:function e(o,w,x,A,z,v,y){var t=v.length-1;switch(z){case 1:return v[t-1];break;case 2:return[[""]];break;case 3:this.$=[v[t]];break;case 4:this.$=[];break;case 5:this.$=[""];break;case 6:this.$=[""];break;case 7:this.$=[""];break;case 8:this.$=v[t-1];break;case 9:v[t-1].push([""]);this.$=v[t-1];break;case 10:v[t-1].push([""]);this.$=v[t-1];break;case 11:v[t-1][v[t-1].length-1].push("");this.$=v[t-1];break;case 12:v[t-2].push(v[t]);this.$=v[t-2];break;case 13:v[t].unshift("");v[t-2].push(v[t]);this.$=v[t-2];break;case 14:v[t-2].push([""]);v[t-2].push(v[t]);this.$=v[t-2];break;case 15:v[t-2][v[t-2].length-1].push("");v[t-2].push(v[t]);this.$=v[t-2];break;case 16:this.$=[v[t].join("")];break;case 17:this.$=[""];break;case 18:v[t-1].push("");this.$=v[t-1];break;case 19:v[t-2].push("");v[t-2].push(v[t].join(""));this.$=v[t-2];break;case 20:break;case 21:break;case 22:v[t-2].push(v[t].join(""));this.$=v[t-2];break;case 23:this.$=[v[t]];break;case 24:v[t-1].push(v[t]);this.$=v[t-1];break;case 25:this.$=v[t-1];break}},table:[{3:1,4:2,5:[1,3],6:4,7:[1,5],8:[1,6],9:[1,7],10:[1,8],11:9,12:l,13:j,14:i,15:h},{1:[3]},{5:[1,14],7:[1,15],8:[1,16],9:[1,17],10:[1,18]},{1:[2,2]},n(g,[2,3],{12:f,13:c}),n(g,[2,4]),n(g,[2,5]),n(g,[2,6]),n(g,[2,7]),n(a,[2,16],{14:s}),n(a,[2,17]),n(a,[2,20]),n(r,[2,23]),{11:22,14:i,15:h},{1:[2,1]},n(g,[2,8],{11:9,6:23,12:l,13:j,14:i,15:h}),n(g,[2,9],{11:9,6:24,12:l,13:j,14:i,15:h}),n(g,[2,10],{11:9,6:25,12:l,13:j,14:i,15:h}),n(g,[2,11],{11:9,6:26,12:l,13:j,14:i,15:h}),n(a,[2,18],{11:27,14:i,15:h}),n(a,[2,21],{11:28,14:i,15:h}),n(r,[2,24]),{14:s,16:[1,29]},n(g,[2,12],{12:f,13:c}),n(g,[2,13],{12:f,13:c}),n(g,[2,14],{12:f,13:c}),n(g,[2,15],{12:f,13:c}),n(a,[2,19],{14:s}),n(a,[2,22],{14:s}),n(r,[2,25])],defaultActions:{3:[2,2],14:[2,1]},parseError:function q(t,o){if(o.recoverable){this.trace(t)}else{throw new Error(t)}},parse:function m(E){var M=this,B=[0],L=[],W=[null],G=[],Y=this.table,v="",F=0,U=0,x=0,D=2,K=1;var y=G.slice.call(arguments,1);var o=Object.create(this.lexer);var X={yy:{}};for(var T in this.yy){if(Object.prototype.hasOwnProperty.call(this.yy,T)){X.yy[T]=this.yy[T]}}o.setInput(E,X.yy);X.yy.lexer=o;X.yy.parser=this;if(typeof o.yylloc=="undefined"){o.yylloc={}}var w=o.yylloc;G.push(w);var z=o.options&&o.options.ranges;if(typeof X.yy.parseError==="function"){this.parseError=X.yy.parseError}else{this.parseError=Object.getPrototypeOf(this).parseError}function J(aa){B.length=B.length-2*aa;W.length=W.length-aa;G.length=G.length-aa}_token_stack:function I(){var aa;aa=o.lex()||K;if(typeof aa!=="number"){aa=M.symbols_[aa]||aa}return aa}var S,O,A,R,Z,H,Q={},N,V,t,C;while(true){A=B[B.length-1];if(this.defaultActions[A]){R=this.defaultActions[A]}else{if(S===null||typeof S=="undefined"){S=I()}R=Y[A]&&Y[A][S]}if(typeof R==="undefined"||!R.length||!R[0]){var P="";C=[];for(N in Y[A]){if(this.terminals_[N]&&N>D){C.push("'"+this.terminals_[N]+"'")}}if(o.showPosition){P="Parse error on line "+(F+1)+":\n"+o.showPosition()+"\nExpecting "+C.join(", ")+", got '"+(this.terminals_[S]||S)+"'"}else{P="Parse error on line "+(F+1)+": Unexpected "+(S==K?"end of input":"'"+(this.terminals_[S]||S)+"'")}this.parseError(P,{text:o.match,token:this.terminals_[S]||S,line:o.yylineno,loc:w,expected:C})}if(R[0] instanceof Array&&R.length>1){throw new Error("Parse Error: multiple actions possible at state: "+A+", token: "+S)}switch(R[0]){case 1:B.push(S);W.push(o.yytext);G.push(o.yylloc);B.push(R[1]);S=null;if(!O){U=o.yyleng;v=o.yytext;F=o.yylineno;w=o.yylloc;if(x>0){x--}}else{S=O;O=null}break;case 2:V=this.productions_[R[1]][1];Q.$=W[W.length-V];Q._$={first_line:G[G.length-(V||1)].first_line,last_line:G[G.length-1].last_line,first_column:G[G.length-(V||1)].first_column,last_column:G[G.length-1].last_column};if(z){Q._$.range=[G[G.length-(V||1)].range[0],G[G.length-1].range[1]]}H=this.performAction.apply(Q,[v,U,F,X.yy,R[1],W,G].concat(y));if(typeof H!=="undefined"){return H}if(V){B=B.slice(0,-1*V*2);W=W.slice(0,-1*V);G=G.slice(0,-1*V)}B.push(this.productions_[R[1]][0]);W.push(Q.$);G.push(Q._$);t=Y[B[B.length-2]][B[B.length-1]];B.push(t);break;case 3:return true}}return true}};if(typeof GLOBAL!=="undefined"){GLOBAL.window=GLOBAL}if(typeof window.TSV==="undefined"){var m=k.parse;k.parse=function(o){var t=this.lexer.setInput;this.lexer.setInput=function(v){t.call(this,v);this.begin("BOF");return this};this.parse=m;return m.call(this,o)};window.TSV=function(t){var w=function(){};w.prototype=k.lexer;var v=function(){this.lexer=new w();this.yy={}};v.prototype=k;var o=new v;o.setObj=function(x){o.yy.obj=x};o.yy.handler=t;return o}}var b=(function(){var v=({EOF:1,parseError:function w(E,D){if(this.yy.parser){this.yy.parser.parseError(E,D)}else{throw new Error(E)}},setInput:function(D,E){this.yy=E||this.yy||{};this._input=D;this._more=this._backtrack=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges){this.yylloc.range=[0,0]}this.offset=0;return this},input:function(){var E=this._input[0];this.yytext+=E;this.yyleng++;this.offset++;this.match+=E;this.matched+=E;var D=E.match(/(?:\r\n?|\n).*/g);if(D){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges){this.yylloc.range[1]++}this._input=this._input.slice(1);return E},unput:function(F){var D=F.length;var E=F.split(/(?:\r\n?|\n)/g);this._input=F+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-D);this.offset-=D;var H=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(E.length-1){this.yylineno-=E.length-1}var G=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:E?(E.length===H.length?this.yylloc.first_column:0)+H[H.length-E.length].length-E[0].length:this.yylloc.first_column-D};if(this.options.ranges){this.yylloc.range=[G[0],G[0]+this.yyleng-D]}this.yyleng=this.yytext.length;return this},more:function(){this._more=true;return this},reject:function(){if(this.options.backtrack_lexer){this._backtrack=true}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}return this},less:function(D){this.unput(this.match.slice(D))},pastInput:function(){var D=this.matched.substr(0,this.matched.length-this.match.length);return(D.length>20?"...":"")+D.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var D=this.match;if(D.length<20){D+=this._input.substr(0,20-D.length)}return(D.substr(0,20)+(D.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var D=this.pastInput();var E=new Array(D.length+1).join("-");return D+this.upcomingInput()+"\n"+E+"^"},test_match:function(H,F){var I,D,G;if(this.options.backtrack_lexer){G={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done};if(this.options.ranges){G.yylloc.range=this.yylloc.range.slice(0)}}D=H[0].match(/(?:\r\n?|\n).*/g);if(D){this.yylineno+=D.length}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:D?D[D.length-1].length-D[D.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+H[0].length};this.yytext+=H[0];this.match+=H[0];this.matches=H;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._backtrack=false;this._input=this._input.slice(H[0].length);this.matched+=H[0];I=this.performAction.call(this,this.yy,this,F,this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input){this.done=false}if(I){return I}else{if(this._backtrack){for(var E in G){this[E]=G[E]}return false}}return false},next:function(){if(this.done){return this.EOF}if(!this._input){this.done=true}var H,F,D,E;if(!this._more){this.yytext="";this.match=""}var I=this._currentRules();for(var G=0;G<I.length;G++){D=this._input.match(this.rules[I[G]]);if(D&&(!F||D[0].length>F[0].length)){F=D;E=G;if(this.options.backtrack_lexer){H=this.test_match(D,I[G]);if(H!==false){return H}else{if(this._backtrack){F=false;continue}else{return false}}}else{if(!this.options.flex){break}}}}if(F){H=this.test_match(F,I[E]);if(H!==false){return H}return false}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function o(){var D=this.next();if(D){return D}else{return this.lex()}},begin:function t(D){this.conditionStack.push(D)},popState:function x(){var D=this.conditionStack.length-1;if(D>0){return this.conditionStack.pop()}else{return this.conditionStack[0]}},_currentRules:function C(){if(this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}else{return this.conditions.INITIAL.rules}},topState:function A(D){D=this.conditionStack.length-1-Math.abs(D||0);if(D>=0){return this.conditionStack[D]}else{return"INITIAL"}},pushState:function z(D){this.begin(D)},stateStackSize:function y(){return this.conditionStack.length},options:{},performAction:function B(H,E,G,D){var F=D;switch(G){case 0:return 14;break;case 1:this.popState();return 16;break;case 2:if(E.yytext==this.quoteChar){this.popState();this.begin("STRING");return 16}else{return 14}break;case 3:this.popState();this.begin("STRING");return 14;break;case 4:this.popState();this.quoteChar=E.yytext.substring(0);this.begin("QUOTE");return 15;break;case 5:this.quoteChar=E.yytext;this.popState();this.begin("QUOTE");return 15;break;case 6:this.begin("PRE_QUOTE");return 13;break;case 7:this.begin("PRE_QUOTE");return 7;break;case 8:return 14;break;case 9:this.popState();return 8;break;case 10:this.popState();return 9;break;case 11:this.popState();return 7;break;case 12:this.popState();return 13;break;case 13:return 14;break;case 14:this.popState();break;case 15:return"BUFFIN";break;case 16:return 9;break;case 17:return 10;break;case 18:return 12;break;case 19:return 7;break;case 20:this.begin("STRING");return 14;break;case 21:return 5;break}},rules:[/^(?:(\n|\\n))/,/^(?:([\'\"])(?=$))/,/^(?:([\'\"]))/,/^(?:(?=(\t)))/,/^(?:([\'\"]))/,/^(?:([\'\"]))/,/^(?:(\t|\\t)(?=[\'\"]))/,/^(?:(\n|\\n)(?=[\'\"]))/,/^(?:([a-zA-Z0-9_ ]+|.))/,/^(?:(\n\t|\\n\\t))/,/^(?:(\n\n|\\n\\n))/,/^(?:(\n|\\n))/,/^(?:(\t|\\t))/,/^(?:([a-zA-Z0-9_ ]+|.))/,/^(?:)/,/^(?:(\n\t|\\n\\t)(?=.))/,/^(?:(\n\n|\\n\\n))/,/^(?:(\t\n))/,/^(?:(\t))/,/^(?:(\n))/,/^(?:([a-zA-Z0-9_ ]+|.))/,/^(?:$)/],conditions:{BOF:{rules:[4,6,7,14,15,16,17,18,19,20,21],inclusive:true},PRE_QUOTE:{rules:[5,6,7,15,16,17,18,19,20,21],inclusive:true},QUOTE:{rules:[0,1,2,3,6,7,8,15,16,17,18,19,20,21],inclusive:true},STRING:{rules:[6,7,9,10,11,12,13,15,16,17,18,19,20,21],inclusive:true},INITIAL:{rules:[6,7,15,16,17,18,19,20,21],inclusive:true}}});return v})();k.lexer=b;function d(){this.yy={}}d.prototype=k;k.Parser=d;return new d})();if(typeof require!=="undefined"&&typeof exports!=="undefined"){exports.parser=parser;exports.Parser=parser.Parser;exports.parse=function(){return parser.parse.apply(parser,arguments)};exports.main=function commonjsMain(a){if(!a[1]){console.log("Usage: "+a[0]+" FILE");process.exit(1)}var b=require("fs").readFileSync(require("path").normalize(a[1]),"utf8");return exports.parser.parse(b)};if(typeof module!=="undefined"&&require.main===module){exports.main(process.argv.slice(1))}};